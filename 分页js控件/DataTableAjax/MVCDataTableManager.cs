using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.IO;
using System.Linq;
using System.Text;
using System.Web.Script.Serialization;

namespace CSCM.DataTableAjax
{
    /// <summary>
    /// 分页控件统一处理函数
    /// </summary>
    public class MVCDataTableManager
    {
        /// <summary>
        /// 分页控件加载数据的事件
        /// </summary>
        public event _GetDataTableDB GetDataTableDB;
        /// <summary>
        /// 删除的事件
        /// </summary>
        public event _DeleteItem DeleteItem;
        /// <summary>
        /// 如果是内存分页，将会触发
        /// </summary>
        public event _GetDataTableMes GetDataTableMes;
        /// <summary>
        /// 显示的样式(注意：必须在引用的js路径上带有显示的DIV的id时才有效！例如xxx.ashx?divid=xxx)
        /// </summary>
        public DataTableStyle ShowTableStyle { get; set; }


        private System.Web.HttpContextBase _Context { get; set; }
        private PageDataTableType _PageType { get; set; }
        /// <summary>
        /// 是否缓存
        /// </summary>
        private PageDataTableCache _IsCache { get; set; }
        /// <summary>
        /// 缓存名称
        /// </summary>
        private string _CacheKeyName { get; set; }

        /// <summary>
        /// 创建对象
        /// </summary>
        /// <param name="Context">请求的HttpContext</param>
        /// <param name="PageType">分页类型内存还是数据库分页</param>
        public MVCDataTableManager(System.Web.HttpContextBase Context, PageDataTableType PageType)
        {
            _Context = Context;
            _PageType = PageType;
            _IsCache = PageDataTableCache.No;
        }
        /// <summary>
        /// 创建对象 指定可以缓存(只能用来创建内存分页)
        /// </summary>
        /// <param name="Context">请求的HttpContext</param>
        /// <param name="CacheKeyName">缓存的key必须是常量并且系统唯一</param>
        public MVCDataTableManager(System.Web.HttpContextBase Context, string CacheKeyName)
        {
            _Context = Context;
            _PageType = PageDataTableType.MesPage;
            _CacheKeyName = CacheKeyName;
            _IsCache = PageDataTableCache.Yes;
        }
        /// <summary>
        /// 初始化的函数，该函数必须在事件绑定之后。否则无法触发绑定的事件！当分页方式选择为内存分页(PageType==MesPage)时，使用的Handler页面的Session必须是可读写状态（继承System.Web.SessionState.IRequiresSessionState）
        /// </summary>
        public string Init()
        {
            string returnMag = string.Empty;
            System.Web.HttpContextBase Context = _Context;
            PageDataTableType PageType = _PageType;
            if (Context.Request.RequestType.Trim().ToLower() == "get")
            {
                //如果是get请求
                returnMag= GetJsFile(Context);
                
            }

            StreamReader Str = new StreamReader(Context.Request.InputStream);
            string txtJson = Context.Server.UrlDecode(Str.ReadToEnd());
            PostForm pf = null;
            try
            {
                pf = JavaScriptDeserialize<PostForm>(txtJson);
            }
            catch (Exception)
            { }
            if (pf != null)
            {
                if (pf.PostTypeFun == PostType.GetData || pf.PostTypeFun == PostType.Refresh)
                {
                    if (PageType == PageDataTableType.DBPage)
                    {
                        DataTable Dt = null;
                        Dictionary<string, UserEval> Dic = new Dictionary<string, UserEval>();
                        string WhereKey = null;
                        int DataCount = 0;
                        int PageSize = 12;
                        string StateMagTxt = "";
                        GetDataState GetDataState = GetDataState.Yes;
                        if (GetDataTableDB != null)
                        {
                            GetDataTableDB(ref pf, out Dt, out Dic, out WhereKey, out DataCount, ref PageSize, ref GetDataState, ref StateMagTxt);
                            //返回数据
                            if (Dt != null && Dic != null && GetDataState == GetDataState.Yes)
                            {
                                //处理dic和数据
                                Dictionary<string, string> DicCop = new Dictionary<string, string>();
                                //显示还是影藏的列
                                string[] ShowHid = new string[0];
                                Dt = DataTableToHidDataTable(Dt, Dic, out DicCop, out ShowHid);
                                string json = DataTableToJson(Dt);
                                //列头
                                string JsonKey = JavaScriptSerializable(DicCop);
                                //显示状态
                                string ShowState = JavaScriptSerializable(ShowHid);
                                string JsonModel = "{\"State\": \"222\",\"Mag\": \"" + StateMagTxt + "\",\"dataCount\":\"" + DataCount + "\",\"PageSize\":\"" + PageSize + "\",\"PageIndex\":\"" + pf.PageIndex + "\",\"WhereKey\":\"" + WhereKey + "\",\"title\":" + JsonKey + ",\"ShowState\":" + ShowState + ",\"data\":" + json + "}";
                                returnMag=JsonModel;
                            }
                            else
                            {
                                //表示没有取到数据表
                                returnMag="{\"State\": \"404\",\"Mag\": \"" + StateMagTxt + "\"}";
                            }
                        }
                    }
                    else
                    {
                        //内存分页
                        DataTable Dt = null;
                        Dictionary<string, UserEval> Dic = new Dictionary<string, UserEval>();
                        string WhereKey = null;
                        int PageSize = 12;
                        string StateMagTxt = "";
                        GetDataState GetDataState = GetDataState.Yes;
                        if (GetDataTableMes != null)
                        {
                            if ((Dt == null || Dic == null) || (pf.WhereTxt != null && pf.WhereTxt != ""))
                            {
                                if (_IsCache == PageDataTableCache.Yes && pf.PostTypeFun != PostType.Refresh && pf.PageIndex != 0)
                                {
                                    //如果允许缓存并且不是刷新数据并且不是第一页则不响应函数
                                    //获取缓存数据
                                    if (!string.IsNullOrEmpty(_CacheKeyName))
                                    {
                                        Dt = Context.Cache[_CacheKeyName] as DataTable;
                                        Dic = Context.Cache[_CacheKeyName + "_Dic"] as Dictionary<string, UserEval>;
                                        WhereKey = Context.Cache[_CacheKeyName + "_WhereKey"] as string;
                                        StateMagTxt = Context.Cache[_CacheKeyName + "_StateMagTxt"] as string;
                                        if (Context.Cache[_CacheKeyName + "_PageSize"] != null)
                                        {
                                            int.TryParse(Context.Cache[_CacheKeyName + "_PageSize"].ToString(), out PageSize);
                                        }
                                        else
                                        {
                                            PageSize = 0;
                                        }
                                        if (Context.Cache[_CacheKeyName + "_GetDataState"] != null)
                                        {
                                            try
                                            {
                                                GetDataState = (GetDataState)Enum.Parse(typeof(GetDataState), Context.Cache[_CacheKeyName + "_GetDataState"].ToString());
                                                //可以
                                            }
                                            catch (Exception)
                                            {

                                                GetDataTableMes(ref pf, out Dt, out Dic, out WhereKey, ref PageSize, ref GetDataState, ref StateMagTxt);
                                            }
                                        }
                                        else
                                        {
                                            //不行
                                            GetDataTableMes(ref pf, out Dt, out Dic, out WhereKey, ref PageSize, ref GetDataState, ref StateMagTxt);
                                        }
                                    }
                                }
                                else
                                {
                                    GetDataTableMes(ref pf, out Dt, out Dic, out WhereKey, ref PageSize, ref GetDataState, ref StateMagTxt);
                                    //保存缓存数据
                                    if (!string.IsNullOrEmpty(_CacheKeyName))
                                    {
                                        Context.Cache[_CacheKeyName] = Dt;
                                        Context.Cache[_CacheKeyName + "_Dic"] = Dic;
                                        Context.Cache[_CacheKeyName + "_WhereKey"] = WhereKey;
                                        Context.Cache[_CacheKeyName + "_PageSize"] = PageSize;
                                        Context.Cache[_CacheKeyName + "_GetDataState"] = GetDataState;
                                        Context.Cache[_CacheKeyName + "_StateMagTxt"] = StateMagTxt;
                                    }
                                }
                            }
                            //返回数据
                            if (Dt != null && Dic != null && GetDataState == GetDataState.Yes)
                            {
                                DataTable ScoDataTable = new DataTable();
                                ScoDataTable = Dt.Copy();
                                ScoDataTable.Rows.Clear();
                                for (int i = (pf.PageIndex * PageSize); i < ((pf.PageIndex * PageSize) + PageSize); i++)
                                {
                                    if (i < Dt.Rows.Count)
                                    {
                                        ScoDataTable.ImportRow(Dt.Rows[i]);
                                    }
                                }
                                //处理dic和数据
                                Dictionary<string, string> DicCop = new Dictionary<string, string>();
                                //显示还是影藏的列
                                string[] ShowHid = new string[0];
                                ScoDataTable = DataTableToHidDataTable(ScoDataTable, Dic, out DicCop, out ShowHid);
                                string json = DataTableToJson(ScoDataTable);
                                //列头
                                string JsonKey = JavaScriptSerializable(DicCop);
                                //显示状态
                                string ShowState = JavaScriptSerializable(ShowHid);
                                string JsonModel = "{\"State\": \"222\",\"Mag\": \"" + StateMagTxt + "\",\"dataCount\":\"" + Dt.Rows.Count + "\",\"PageSize\":\"" + PageSize + "\",\"PageIndex\":\"" + pf.PageIndex + "\",\"WhereKey\":\"" + WhereKey + "\",\"title\":" + JsonKey + ",\"ShowState\":" + ShowState + ",\"data\":" + json + "}";
                                returnMag=JsonModel;
                            }
                            else
                            {
                                //表示没有取到数据表
                                returnMag="{\"State\": \"404\",\"Mag\": \"" + StateMagTxt + "\"}";
                            }
                        }
                    }
                }
                else if (pf.PostTypeFun == PostType.Delete)
                {
                    if (DeleteItem != null)
                    {
                        string StateMagTxt = "";
                        DeleteItemState DelState = DeleteItemState.No;
                        DeleteItem(ref pf, out DelState, ref StateMagTxt);
                        if (DelState == DeleteItemState.Yes)
                        {
                            //删除成功
                            returnMag="{\"State\": \"211\",\"Mag\": \"" + StateMagTxt + "\"}";
                        }
                        else
                        {
                            //删除失败
                            returnMag="{\"State\": \"112\",\"Mag\": \"" + StateMagTxt + "\"}";
                        }
                    }
                }
            }
            return returnMag;
        }

        private string DataTableToJson(DataTable dt)
        {
            JavaScriptSerializer javaScriptSerializer = new JavaScriptSerializer();
            javaScriptSerializer.MaxJsonLength = Int32.MaxValue; //取得最大数值
            ArrayList arrayList = new ArrayList();
            foreach (DataRow dataRow in dt.Rows)
            {
                Dictionary<string, object> dictionary = new Dictionary<string, object>();  //实例化一个参数集合
                foreach (DataColumn dataColumn in dt.Columns)
                {
                    dictionary.Add(dataColumn.ColumnName, dataRow[dataColumn.ColumnName].ToString());
                }
                arrayList.Add(dictionary); //ArrayList集合中添加键值
            }
            return javaScriptSerializer.Serialize(arrayList);  //返回一个json字符串
        }

        private static string JavaScriptSerializable(object Value)
        {
            JavaScriptSerializer js = new JavaScriptSerializer();
            return js.Serialize(Value);
        }
        private static T JavaScriptDeserialize<T>(string Json)
        {
            JavaScriptSerializer js = new JavaScriptSerializer();
            return js.Deserialize<T>(Json);
        }

        private DataTable DataTableToHidDataTable(DataTable Dt, Dictionary<string, UserEval> Dic, out Dictionary<string, string> DicTxt, out string[] DicShowHid)
        {
            Dictionary<string, string> SDicToKey = new Dictionary<string, string>();
            //存储列的显示状态
            DicShowHid = new string[Dic.Keys.Count];
            if (Dic.Count != 0)
            {
                int keyIndex = 0;
                foreach (string key in Dic.Keys)
                {
                    //存储列是显示还是影藏
                    if (Dic[key].KeyColumnShow == null || Dic[key].KeyColumnShow == ColumnShowType.Show)
                    {
                        DicShowHid[keyIndex] = "Show";
                    }
                    else
                    {
                        DicShowHid[keyIndex] = "Hide";
                    }
                    keyIndex++;

                    if (Dic[key].ValueToUserInfoHandle != null)
                    {
                        //自定义
                        //添加一列
                        string NameKey = Dic[key].KeyName + Guid.NewGuid().ToString("N");
                        //string yuanguidKey = NameKey.Substring(0, NameKey.Length - 32);
                        Dt.Columns.Add(NameKey);
                        //复制数据
                        foreach (DataRow Dr in Dt.Rows)
                        {
                            Dr[NameKey] = Dr[Dic[key].KeyName];
                        }
                        SDicToKey.Add(key, NameKey);
                        Dictionary<string, ValueToUserInfo> DicToUserValue = new Dictionary<string, ValueToUserInfo>();
                        DicToUserValue.Add(NameKey, Dic[key].ValueToUserInfoHandle);
                        Dt = DataTableToDataTable(Dt, DicToUserValue);

                    }
                    else if (Dic[key].KeyValueToUser != null)
                    {
                        //自定义
                        //添加一列
                        string NameKey = Dic[key].KeyName + Guid.NewGuid().ToString("N");
                        //string yuanguidKey = NameKey.Substring(0, NameKey.Length - 32);
                        Dt.Columns.Add(NameKey);
                        //复制数据
                        foreach (DataRow Dr in Dt.Rows)
                        {
                            Dr[NameKey] = Dr[Dic[key].KeyName];
                        }
                        SDicToKey.Add(key, NameKey);
                        Dictionary<string, string> DicToUserValue = new Dictionary<string, string>();
                        DicToUserValue.Add(NameKey, Dic[key].KeyValueToUser);
                        Dt = DataTableToDataTable(Dt, DicToUserValue);
                    }
                    else
                    {
                        SDicToKey.Add(key, Dic[key].KeyName);
                        Dt = Dt;
                    }
                }

            }
            DicTxt = SDicToKey;


            return Dt;
        }

        private static DataTable DataTableToDataTable(DataTable Dt, Dictionary<string, string> Dic)
        {
            DataTable DtK = new DataTable();
            DtK = Dt.Clone();
            //修改表结构
            if (Dic != null && Dic.Count > 0)
            {
                foreach (DataColumn Col in DtK.Columns)
                {
                    foreach (string KeyStr in Dic.Keys)
                    {
                        if (Col.ColumnName == KeyStr)
                        {
                            //修改列类型
                            Col.DataType = typeof(String);
                        }
                    }
                }
            }
            foreach (DataRow Dr in Dt.Rows)
            {
                DataRow DrK = DtK.NewRow();
                foreach (DataColumn DtCol in Dt.Columns)
                {
                    if (Dic.Keys.Contains(DtCol.ColumnName))
                    {
                        DrK[DtCol.ColumnName] = Dic[DtCol.ColumnName].Replace("[value]", Dr[DtCol.ColumnName].ToString()); ;
                    }
                    else
                    {
                        DrK[DtCol.ColumnName] = Dr[DtCol.ColumnName];
                    }
                }
                DtK.Rows.Add(DrK);
            }
            //[value]
            return DtK;
        }

        private static DataTable DataTableToDataTable(DataTable Dt, Dictionary<string, ValueToUserInfo> Dic)
        {
            DataTable DtK = new DataTable();
            DtK = Dt.Clone();
            //修改表结构
            if (Dic != null && Dic.Count > 0)
            {
                foreach (DataColumn Col in DtK.Columns)
                {
                    foreach (string KeyStr in Dic.Keys)
                    {
                        if (Col.ColumnName == KeyStr)
                        {
                            //修改列类型
                            Col.DataType = typeof(String);
                        }
                    }
                }
            }
            foreach (DataRow Dr in Dt.Rows)
            {
                DataRow DrK = DtK.NewRow();
                foreach (DataColumn DtCol in Dt.Columns)
                {
                    if (Dic.Keys.Contains(DtCol.ColumnName))
                    {
                        if (Dic[DtCol.ColumnName] != null)
                        {
                            string Value = Dr[DtCol.ColumnName].ToString();
                            ValueToUserInfo VUI = Dic[DtCol.ColumnName];
                            VUI(ref Value, Dr);
                            string ValOut = Value;
                            DrK[DtCol.ColumnName] = ValOut;
                        }
                        //DrK[DtCol.ColumnName] = Dic[DtCol.ColumnName].Replace("[value]", Dr[DtCol.ColumnName].ToString()); ;
                    }
                    else
                    {
                        DrK[DtCol.ColumnName] = Dr[DtCol.ColumnName];
                    }
                }
                DtK.Rows.Add(DrK);
            }
            //[value]
            return DtK;
        }
        /// <summary>
        /// 读取js文件
        /// </summary>
        /// <param name="Context"></param>
        public string GetJsFile(System.Web.HttpContextBase Context)
        {
            string returnMag = string.Empty;
            if (Context.Request.QueryString["help"] != null && !string.IsNullOrEmpty(Context.Request.QueryString["help"]))
            {
                if (Context.Request.QueryString["help"].Trim().ToLower() == "true")
                {
                    returnMag = helpStr;
                }
            }
            string DivId = Context.Request.QueryString["divid"];
            if (string.IsNullOrEmpty(DivId) && Context.Request.QueryString.Count > 0)
            {
                DivId = Context.Request.QueryString[0];
            }
            //获取当前请求的地址
            string ReUrl = Context.Request.Url.AbsoluteUri;
            byte[] StrByte = Convert.FromBase64String(JavaScriptBase64UTF8);
            string javascriptStr = System.Text.Encoding.UTF8.GetString(StrByte);
            //更改的时候使用
            //FileStream fs = File.Open(HttpContext.Current.Server.MapPath("1.txt"), FileMode.Open);
            //StreamReader sr = new StreamReader(fs, Encoding.UTF8);
            //string a = sr.ReadToEnd();
            //sr.Close();
            //fs.Close();//"".
            //byte[] aaaa = Encoding.UTF8.GetBytes(a);
            //string bbb = Convert.ToBase64String(aaaa);
            if (!string.IsNullOrEmpty(DivId))
            {
                returnMag="document.write('" + GetDataTableStyle(DivId) + "');" + javascriptStr.Replace("【DataTableDivId】", DivId).Replace("【PosrUrlTxt】", ReUrl) + "window.onload = function () {new DataTableObj().SelectDataTable({});}";
            }
            else
            {
                //把javascript打印到页面
                returnMag="document.write('" + GetDataTableStyle(DivId) + "');" + javascriptStr.Replace("【DataTableDivId】", DivId).Replace("【PosrUrlTxt】", ReUrl);
            }
            return returnMag;
        }
        private string GetDataTableStyle(string DivId)
        {
            string StyleTxt = "";
            switch (ShowTableStyle)
            {
                case DataTableStyle.Null:
                    StyleTxt = "";
                    break;
                case DataTableStyle.Default:
                    StyleTxt = DataTableStyleTXT.Default;
                    break;
            }
            StyleTxt = StyleTxt.Replace("{divid_Lan}", DivId);
            return StyleTxt;
        }
        //private string JavaScriptBase64UTF8 = "LyoNCuWPguaVsOivtOaYjg0K5L2/55So5YmN5Yib5bu6RGF0YVRhYmxlT2JqKCnlr7nosaENCuiwg+eUqOWIneWni+WMluWHveaVsFNlbGVjdERhdGFUYWJsZSgi5bGe5oCn5Y+C5pWw55qEanNvbuWtl+espiIsDQoi5Yig6Zmk5ZCO5omA5Zue6LCD55qE5Ye95pWw77yIc3RhdGXvvInov5Tlm57liKDpmaTnmoTnirbmgIF0cnVl5oiQ5YqfZmFsc2XlpLHotKUiICDmnInmraTlh73mlbDliJnmmL7npLrliKDpmaTmjInpkq7msqHmnInliJnlvbHol48NCiwi5L+u5pS55oyJ6ZKu55qE5Zue6LCD5Ye95pWw77yIa2V577yJ6L+U5Zue57uR5a6a55qEa2V5Iikg5pyJ5q2k5Ye95pWw5YiZ5pi+56S65L+u5pS55oyJ6ZKu5rKh5pyJ5YiZ5b2x6JePDQosIuWFqOmAieWkmumAieinpuWPkeS6i+S7tu+8iGtleUxpc3TvvInlpoLmnpzlhajpgInliJnov5Tlm57pgInkuK3nmoRrZXnliJfooagiIOacieatpOWHveaVsOWImeaYvuekuuWkmumAieaMiemSruayoeacieWImeW9seiXjw0KLCLmr4/kuIDpobnmlbDmja7nmoTlpJrpgInmjInpkq7op6blj5HnmoTkuovku7YoY2hlY2tvYmop6L+U5Zue54K55Lit55qEY2hlY2vmoIfnrb4iDQoqLw0KDQoNCg0KLy/liJvlu7rnsbsNCmZ1bmN0aW9uIERhdGFUYWJsZU9iaigpIHsNCiAgICB0aGlzLlBvc3JVcmxUeHQgPSAiIjsNCiAgICB0aGlzLkdldERhdGFUYWJsZUJ5V2hlcmUgPSAiIjsNCiAgICB0aGlzLkRhdGFUYWJsZURpdklkID0gIiI7DQogICAgdGhpcy5QYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMgPSAwOw0KICAgIHZhciBEYXRhUGFnZUNvdW50ID0gMDsNCiAgICB0aGlzLlBhZ2VTaG93QnV0Q291bnQgPSA3Ow0KICAgIC8v5a6a5LmJ55qE5bGe5oCnDQogICAgdGhpcy5EZWxldGVCdXROYW1lID0gIuWIoOmZpCI7DQogICAgdGhpcy5VcGRhdGVCdXROYW1lID0gIuS/ruaUuSI7DQogICAgdGhpcy5DaGVja0lzVHJ1ZVR4dCA9ICLlj43pgIkiOw0KICAgIHRoaXMuQ2hlY2tJc0ZhbHNlVHh0ID0gIuWFqOmAiSI7DQogICAgdGhpcy5DaGVja0l0ZW1UeHQgPSAiIjsNCiAgICB0aGlzLkRlbGV0ZU9yVXBkYXRlVGl0bGUgPSAi5pON5L2cIjsNCiAgICB0aGlzLkxvZ2luRGl2Q2xhc3NOYW1lID0gIiI7DQogICAgdGhpcy5Mb2dpbkRpdlR4dCA9ICLmraPlnKjor7fmsYIuLi4iOyAvL+aPkOekuuihjOaWh+Wtlw0KICAgIHRoaXMuRGVsZXRlU2hvd1R4dCA9ICLkvaDnoa7lrpropoHliKDpmaTor6XpobnmlbDmja7lkJfvvJ8iOw0KICAgIHRoaXMuUGFnZUluZGV4VG9vbCA9IGZhbHNlOw0KICAgIC8v5a6a5LmJ55qE5Ye95pWwDQogICAgdGhpcy5VcGRhdGVCdXRDbGljazsNCiAgICB0aGlzLkRlbGV0ZUl0ZW1TdGF0ZTsNCiAgICB0aGlzLlBvc3RTdGFydDsNCiAgICB0aGlzLlBvc3RTdG9wOw0KICAgIHRoaXMuQ2hlY2tBbGxDaGFuZ2U7DQogICAgdGhpcy5DaGVja0l0ZW1DaGFuZ2U7DQogICAgLy/lm57osIMNCiAgICB0aGlzLkNhbGxiYWNrOw0KICAgIHZhciBQb3N0UmVxdWVzdCA9IGZ1bmN0aW9uIChQb3N0VXJsLCBGb3JtU3RyaW5nKSB7DQogICAgICAgIC8v5byA5aeL6K+35rGCDQogICAgICAgIFBvc3RTdGFydCgpOw0KICAgICAgICB2YXIgeG1sSHR0cDsNCiAgICAgICAgaWYgKHdpbmRvdy5BY3RpdmVYT2JqZWN0KSB7DQogICAgICAgICAgICB4bWxIdHRwID0gbmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIik7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSBpZiAod2luZG93LlhNTEh0dHBSZXF1ZXN0KSB7DQogICAgICAgICAgICB4bWxIdHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7DQogICAgICAgIH0NCiAgICAgICAgeG1sSHR0cC5vcGVuKCJQb3N0IiwgUG9zdFVybCwgdHJ1ZSk7DQogICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgaWYgKHhtbEh0dHAucmVhZHlTdGF0ZSA9PSA0ICYmIHhtbEh0dHAuc3RhdHVzID09IDIwMCkgew0KICAgICAgICAgICAgICAgIFBvc3RTdG9wKCk7DQogICAgICAgICAgICAgICAgLy/ov5Tlm57lgLznmoTliKTmlq0NCiAgICAgICAgICAgICAgICB2YXIgSnNvbk1vZGVsRGF0YVRhYmxlID0gZXZhbCgiKCIgKyB4bWxIdHRwLnJlc3BvbnNlVGV4dCArICIpIik7DQogICAgICAgICAgICAgICAgLy/lj5blvpfov5Tlm57lgLznmoTlsZ7mgKcNCiAgICAgICAgICAgICAgICBpZiAoSnNvbk1vZGVsRGF0YVRhYmxlICE9IG51bGwgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlICE9IHVuZGVmaW5lZCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgIT0gbnVsbCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgPT0gIjQwNCIpIHsNCiAgICAgICAgICAgICAgICAgICAgQ1pTaG93VHh0RGl2KCLor7fmsYLlpLHotKXvvIEiKTsNCiAgICAgICAgICAgICAgICAgICAgLy/miafooYzlm57osIPlh73mlbAo6K+35rGC5aSx6LSl77yBKQ0KICAgICAgICAgICAgICAgICAgICBpZiAoQ2FsbGJhY2sgIT0gdW5kZWZpbmVkICYmIENhbGxiYWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIENhbGxiYWNrKCIxIiwgZmFsc2UsIEpzb25Nb2RlbERhdGFUYWJsZS5NYWcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEpzb25Nb2RlbERhdGFUYWJsZSAhPSBudWxsICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSAhPSB1bmRlZmluZWQgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlICE9IG51bGwgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlID09ICIyMTEiKSB7DQogICAgICAgICAgICAgICAgICAgIC8v5omn6KGM5Zue6LCD5Ye95pWwKOWIoOmZpOaIkOWKn++8gSkNCiAgICAgICAgICAgICAgICAgICAgaWYgKENhbGxiYWNrICE9IHVuZGVmaW5lZCAmJiBDYWxsYmFjayAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBDYWxsYmFjaygiMiIsIHRydWUsIEpzb25Nb2RlbERhdGFUYWJsZS5NYWcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8v5Yig6Zmk5oiQ5Yqf5Yi35pawDQogICAgICAgICAgICAgICAgICAgIGlmIChEZWxldGVJdGVtU3RhdGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgRGVsZXRlSXRlbVN0YXRlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8vL0NaU2hvd1R4dERpdigi5q2j5Zyo5Yi35pawLi4uIik7DQogICAgICAgICAgICAgICAgICAgIC8v5Yik5pat5pWw5o2u5pyJ5aSa5bCR5p2hDQogICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChEYXRhVGFibGVEaXZJZCkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRyIikubGVuZ3RoID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v6KGo56S65rKh5pyJ5pWw5o2u5LqGDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHBhcnNlSW50KFBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcykgLSAxKSA+IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/liLfmlrDlh73mlbDmr5TovoPnibnmrooNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3N0UmVxdWVzdChQb3NyVXJsVHh0LCBHZXRQb3N0UGFyYW1ldGVyc1RvUmVmcmVzaChwYXJzZUludChQYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMpIC0gMSwgR2V0RGF0YVRhYmxlQnlXaGVyZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy/liLfmlrDmlbDmja4NCiAgICAgICAgICAgICAgICAgICAgICAgIFBvc3RSZXF1ZXN0KFBvc3JVcmxUeHQsIEdldFBvc3RQYXJhbWV0ZXJzVG9SZWZyZXNoKFBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcywgR2V0RGF0YVRhYmxlQnlXaGVyZSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEpzb25Nb2RlbERhdGFUYWJsZSAhPSBudWxsICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSAhPSB1bmRlZmluZWQgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlICE9IG51bGwgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlID09ICIxMTIiKSB7DQogICAgICAgICAgICAgICAgICAgIC8v5omn6KGM5Zue6LCD5Ye95pWwKOWIoOmZpOWksei0pe+8gSkNCiAgICAgICAgICAgICAgICAgICAgaWYgKENhbGxiYWNrICE9IHVuZGVmaW5lZCAmJiBDYWxsYmFjayAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBDYWxsYmFjaygiMiIsIGZhbHNlLCBKc29uTW9kZWxEYXRhVGFibGUuTWFnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvL+WIoOmZpOWksei0pe+8gQ0KICAgICAgICAgICAgICAgICAgICBpZiAoRGVsZXRlSXRlbVN0YXRlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIERlbGV0ZUl0ZW1TdGF0ZShmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgU2hvd1R4dERpdihMb2dpbkRpdlR4dCk7DQogICAgICAgICAgICAgICAgICAgIC8v5Yi35paw5pWw5o2uDQogICAgICAgICAgICAgICAgICAgIFBvc3RSZXF1ZXN0KFBvc3JVcmxUeHQsIEdldFBvc3RQYXJhbWV0ZXJzVG9SZWZyZXNoKFBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcywgR2V0RGF0YVRhYmxlQnlXaGVyZSkpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChKc29uTW9kZWxEYXRhVGFibGUgIT0gbnVsbCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgIT0gdW5kZWZpbmVkICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSAhPSBudWxsICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSA9PSAiMjIyIikgew0KICAgICAgICAgICAgICAgICAgICAvL+ivu+WPluaVsOaNruaIkOWKn++8gQ0KICAgICAgICAgICAgICAgICAgICAvL+aJp+ihjOWbnuiwg+WHveaVsCjor7vlj5bmiJDlip/vvIEpDQogICAgICAgICAgICAgICAgICAgIGlmIChDYWxsYmFjayAhPSB1bmRlZmluZWQgJiYgQ2FsbGJhY2sgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgQ2FsbGJhY2soIjEiLCB0cnVlLCBKc29uTW9kZWxEYXRhVGFibGUuTWFnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvL+aAu+mhteaVsA0KICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YUNvdW50ID0gSnNvbk1vZGVsRGF0YVRhYmxlLmRhdGFDb3VudDsNCiAgICAgICAgICAgICAgICAgICAgLy/mr4/pobXmmL7npLrnmoTmnaHmlbANCiAgICAgICAgICAgICAgICAgICAgdmFyIFBhZ2VTaXplID0gSnNvbk1vZGVsRGF0YVRhYmxlLlBhZ2VTaXplOw0KICAgICAgICAgICAgICAgICAgICAvL+W9k+WJjemhteeahOe0ouW8lQ0KICAgICAgICAgICAgICAgICAgICB2YXIgUGFnZUluZGV4ID0gSnNvbk1vZGVsRGF0YVRhYmxlLlBhZ2VJbmRleDsNCiAgICAgICAgICAgICAgICAgICAgUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzID0gUGFnZUluZGV4Ow0KICAgICAgICAgICAgICAgICAgICAvL+iOt+WPluWIoOmZpOeahGtleeaWueW8jw0KICAgICAgICAgICAgICAgICAgICB2YXIgV2hlcmVLZXkgPSBKc29uTW9kZWxEYXRhVGFibGUuV2hlcmVLZXk7DQogICAgICAgICAgICAgICAgICAgIC8v5YiX5aS06ZSu55qE6ZuG5ZCIDQogICAgICAgICAgICAgICAgICAgIHZhciBUYWJsZVRpdGxlID0gbmV3IEFycmF5KCk7DQogICAgICAgICAgICAgICAgICAgIC8v5a2Y5pS+5YiX55qE5pi+56S654q25oCBDQogICAgICAgICAgICAgICAgICAgIHZhciBTaG93SGlkTGlzdCA9IG5ldyBBcnJheSgpOw0KICAgICAgICAgICAgICAgICAgICAvL+ihqOaVsOaNrumbhuWQiA0KICAgICAgICAgICAgICAgICAgICB2YXIgRGF0YVRhYmxlT2JqID0gbmV3IEFycmF5KCk7DQogICAgICAgICAgICAgICAgICAgIC8v5Yib5bu656ys5LiA6KGM5a2Y5pS+6KGo5aS0DQogICAgICAgICAgICAgICAgICAgIERhdGFUYWJsZU9ialswXSA9IG5ldyBBcnJheSgpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpdGVtIGluIEpzb25Nb2RlbERhdGFUYWJsZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBKc29uTW9kZWxEYXRhVGFibGVbaXRlbV0gPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/ov5Tlm57lgLznmoTlsZ7mgKfljIXlkKvmlbDmja7mnInlpJrlsJENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KCLplK4iICsgaXRlbSArICLnmoTlgLw9IiArIEpzb25Nb2RlbERhdGFUYWJsZVtpdGVtXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBKc29uTW9kZWxEYXRhVGFibGVbaXRlbV0gPT09ICdvYmplY3QnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIERhdGFMaXN0ID0gSnNvbk1vZGVsRGF0YVRhYmxlW2l0ZW1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICJ0aXRsZSIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lsIbllK/kuIDplK7mlL7liLAw5YiXDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRhYmxlVGl0bGVbMF0gPSBXaGVyZUtleTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/liJvlu7rooajlpLQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIFRpdGxlS2V5SW5kZXggPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBUaXRsZU9iaiBpbiBEYXRhTGlzdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBEYXRhTGlzdFtUaXRsZU9ial0gPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lsIbliJflpLTmiYDnu5HlrprnmoTlgLzmlL7liLDmlbDnu4TvvIzmlrnkvr/lj5bmlbDmja4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWJsZVRpdGxlW1RpdGxlS2V5SW5kZXhdID0gRGF0YUxpc3RbVGl0bGVPYmpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Yid5aeL5YyW5pW05Liq6KGo57uT5p6E77yI5YiX77yJDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YVRhYmxlT2JqWzBdW1RpdGxlS2V5SW5kZXhdID0gVGl0bGVPYmo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGl0bGVLZXlJbmRleCA9IFRpdGxlS2V5SW5kZXggKyAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtID09ICJTaG93U3RhdGUiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5a2Y5pS+5pi+56S654q25oCB55qE5pWw57uEDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dIaWRMaXN0ID0gRGF0YUxpc3Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtID09ICJkYXRhIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IERhdGFMaXN0Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgSXRlbURhdGEgPSBEYXRhTGlzdFtpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Yib5bu66KGMaeS4uuihjOeahOe0ouW8lee0ouW8leS7jjHlvIDlp4vlm6DkuLow5Li66KGo5aS0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhVGFibGVPYmpbaSArIDFdID0gbmV3IEFycmF5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBJdGVtRGF0YU9iaiBpbiBJdGVtRGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5YiXDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBJdGVtRGF0YVtJdGVtRGF0YU9ial0gPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChUYWJsZVRpdGxlWzBdICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChJdGVtRGF0YU9iaiA9PSBUYWJsZVRpdGxlWzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YVRhYmxlT2JqW2kgKyAxXVswXSA9IEl0ZW1EYXRhW0l0ZW1EYXRhT2JqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB0ID0gMTsgdCA8IFRhYmxlVGl0bGUubGVuZ3RoOyB0KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChJdGVtRGF0YU9iaiA9PSBUYWJsZVRpdGxlW3RdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChJdGVtRGF0YVtJdGVtRGF0YU9ial0gKyAiID09IiArIFRhYmxlVGl0bGVbdF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5ZCR6KGo5Lit5re75Yqg5pWw5o2uW+ihjF1b5YiXXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGFUYWJsZU9ialtpICsgMV1bdF0gPSBJdGVtRGF0YVtJdGVtRGF0YU9ial07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WIm+W7uuihqOe7k+aehA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcmVhdGVUYWJsZUh0bWwoRGF0YVRhYmxlT2JqLCBXaGVyZUtleSwgU2hvd0hpZExpc3QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WIm+W7uuWIhumhteiPnOWNlQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcmVhdGVUYWJsZVBhZ2VIdG1sKFBhZ2VTaXplLCBkYXRhQ291bnQsIFBhZ2VJbmRleCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgLy/liKTmlq3nmoTnu5PlsL4NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH07DQogICAgICAgIHhtbEh0dHAuc2VuZChGb3JtU3RyaW5nKTsNCiAgICB9DQogICAgLy/liJvlu7rooajnu5PmnoQgIOWPluWAvOS4ulvooYxdW+WIl10gICAgIOivpemhueaVsOaNrueahOWUr+S4gOagh+ivhg0KICAgIHZhciBDcmVhdGVUYWJsZUh0bWwgPSBmdW5jdGlvbiAoRGF0YUxpc3QsIGtleSwgU2hvd0hpZExpc3QpIHsNCiAgICAgICAgdmFyIFRhYmxlSHRtbCA9ICI8dGFibGUgY2xhc3M9J1RhYmxlUGFnaW5nQm9keScgYm9yZGVyPScwJyBjZWxsc3BhY2luZz0nMCcgY2VsbHBhZGRpbmc9JzAnPiI7DQogICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgRGF0YUxpc3QubGVuZ3RoOyB5KyspIHsNCiAgICAgICAgICAgIC8v6KGM5byA5aeL5Yib5bu6DQogICAgICAgICAgICBpZiAoeSA9PSAxKSB7DQogICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGJvZHk+PHRyIGNsYXNzPSdUYWJsZVBhZ2luZ1RSIFRSXyIgKyB5ICsgIic+IjsNCg0KICAgICAgICAgICAgfSBlbHNlIGlmICh5ID09IDApIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0aGVhZD48dHIgY2xhc3M9J1RhYmxlUGFnaW5nVFIgVFJfIiArIHkgKyAiJz4iOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0ciBjbGFzcz0nVGFibGVQYWdpbmdUUiBUUl8iICsgeSArICInPiI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgS2V5Ow0KICAgICAgICAgICAgZm9yICh2YXIgeCA9IDE7IHggPCBEYXRhTGlzdFt5XS5sZW5ndGg7IHgrKykgew0KICAgICAgICAgICAgICAgIC8v5Y+W5b6XS2V555qE5a6e6ZmF5YC8DQogICAgICAgICAgICAgICAgS2V5ID0gRGF0YUxpc3RbeV1bMF07DQogICAgICAgICAgICAgICAgLy/liJcNCiAgICAgICAgICAgICAgICAvL+W8gOWni+WIm+W7uuWIlw0KICAgICAgICAgICAgICAgIGlmICh5ID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKENoZWNrQWxsQ2hhbmdlICE9IG51bGwgJiYgeCA9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0aCBjbGFzcz0nVGFibGVQYWdpbmdDaGVjaycgPjxpbnB1dCBvbmNoYW5nZT0nbmV3IERhdGFUYWJsZU9iaigpLkNoZWNrQWxsQ2hhbmdlT2JqVG9EYXRhVGFibGUodGhpcyknIHR5cGU9XCJjaGVja2JveFwiIC8+PHNwYW4+IiArIENoZWNrSXNGYWxzZVR4dCArICI8L3NwYW4+PC90aD48dGggY2xhc3M9J1RhYmxlUGFnaW5nVEggVEhfIiArIHggKyAiJz4iICsgRGF0YUxpc3RbeV1beF0gKyAiPC90aD4iOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4KyJ8IitTaG93SGlkTGlzdFt4LTFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v5YiX5aS0DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoU2hvd0hpZExpc3RbeCAtIDFdID09ICJTaG93Iikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRhYmxlSHRtbCArPSAiPHRoIGNsYXNzPSdUYWJsZVBhZ2luZ1RIIFRIXyIgKyB4ICsgIic+IiArIERhdGFMaXN0W3ldW3hdICsgIjwvdGg+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGggY2xhc3M9J1RhYmxlUGFnaW5nVEggVEhfIiArIHggKyAiJyBzdHlsZT0nZGlzcGxheTpub25lOyc+IiArIERhdGFMaXN0W3ldW3hdICsgIjwvdGg+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChDaGVja0FsbENoYW5nZSAhPSBudWxsICYmIHggPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKENoZWNrSXRlbUNoYW5nZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGQgY2xhc3M9J1RhYmxlUGFnaW5nQ2hlY2snPjxpbnB1dCBuYW1lPSdEYXRhVGFibGVJdGVtQ2hlY2snIHZhbHVlPSciICsgS2V5ICsgIicgb25jaGFuZ2U9XCJuZXcgRGF0YVRhYmxlT2JqKCkuQ2hlY2tJdGVtQ2hhbmdlT2JqVG9EYXRhVGFibGUodGhpcylcIiB0eXBlPVwiY2hlY2tib3hcIiAvPiIgKyBDaGVja0l0ZW1UeHQgKyAiPC90ZD48dGQgY2xhc3M9J1RhYmxlUGFnaW5nVEQgVERfIiArIHggKyAiJz4iICsgRGF0YUxpc3RbeV1beF0gKyAiPC90ZD4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0ZCBjbGFzcz0nVGFibGVQYWdpbmdDaGVjayc+PGlucHV0IG5hbWU9J0RhdGFUYWJsZUl0ZW1DaGVjaycgdmFsdWU9JyIgKyBLZXkgKyAiJyB0eXBlPVwiY2hlY2tib3hcIiAvPjwvdGQ+PHRkIGNsYXNzPSdUYWJsZVBhZ2luZ1REIFREXyIgKyB4ICsgIic+IiArIERhdGFMaXN0W3ldW3hdICsgIjwvdGQ+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTaG93SGlkTGlzdFt4IC0gMV0gPT0gIlNob3ciKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGQgY2xhc3M9J1RhYmxlUGFnaW5nVEQgVERfIiArIHggKyAiJz4iICsgRGF0YUxpc3RbeV1beF0gKyAiPC90ZD4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0ZCBjbGFzcz0nVGFibGVQYWdpbmdURCBURF8iICsgeCArICInIHN0eWxlPSdkaXNwbGF5Om5vbmU7Jz4iICsgRGF0YUxpc3RbeV1beF0gKyAiPC90ZD4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8v57uT5p2f5Yib5bu6DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoeSAhPSAwKSB7DQoNCiAgICAgICAgICAgICAgICAvL+S7juaVsOaNruW8gOWni+iOt+WPlmtleQ0KICAgICAgICAgICAgICAgIC8v5Y+W5b6XS2V555qE5a6e6ZmF5YC8DQogICAgICAgICAgICAgICAgS2V5ID0gRGF0YUxpc3RbeV1bMF07DQogICAgICAgICAgICAgICAgaWYgKERlbGV0ZUl0ZW1TdGF0ZSAhPSBudWxsIHx8IFVwZGF0ZUJ1dENsaWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGQgY2xhc3M9J1RhYmxlUGFnaW5nVEQgVG9vbCcgaWQ9J0RhdGFUYWJsZVBhZ2VfVXNlcl9MYW5TUV8iICsgS2V5ICsgIicgPiI7DQogICAgICAgICAgICAgICAgICAgIGlmIChEZWxldGVJdGVtU3RhdGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8YSBjbGFzcz0nVGFibGVQYWdpbmdURCBUb29sIERlbGV0ZScgaHJlZj1cImphdmFzY3JpcHQ6bmV3IERhdGFUYWJsZU9iaigpLkRhdGFUYWJsZURlbGV0ZUJ5S2V5KCciICsgS2V5ICsgIicpXCI+IiArIERlbGV0ZUJ1dE5hbWUgKyAiPC9hPiI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKFVwZGF0ZUJ1dENsaWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIFRhYmxlSHRtbCArPSAiPGEgY2xhc3M9J1RhYmxlUGFnaW5nVEQgVG9vbCBVcGRhdGUnIGhyZWY9XCJqYXZhc2NyaXB0OlVwZGF0ZUJ1dENsaWNrKCciICsgS2V5ICsgIicsQ2h1TGlUck9iakFycnREYXRhVGFibGVQYWdlKCdEYXRhVGFibGVQYWdlX1VzZXJfTGFuU1FfIiArIEtleSArICInKSlcIj4iICsgVXBkYXRlQnV0TmFtZSArICI8L2E+IjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjwvdGQ+IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8v5Yib5bu65Yig6Zmk5YiX5aS05oiW5L+u5pS55YiX5aS0DQogICAgICAgICAgICAgICAgaWYgKERlbGV0ZUl0ZW1TdGF0ZSAhPSBudWxsIHx8IFVwZGF0ZUJ1dENsaWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGggY2xhc3M9J1RhYmxlUGFnaW5nVEggVG9vbCc+IiArIERlbGV0ZU9yVXBkYXRlVGl0bGUgKyAiPC90aD4iOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8v6KGM5byA5aeL5Yib5bu657uT5p2fDQoNCiAgICAgICAgICAgIGlmICh5ID09IDApIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjwvdHI+PC90aGVhZD4iOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjwvdHI+IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIFRhYmxlSHRtbCArPSAiPC90Ym9keT48L3RhYmxlPiI7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5pbm5lckhUTUwgPSBUYWJsZUh0bWw7DQogICAgfQ0KICAgIC8v5Yib5bu65YiG6aG16I+c5Y2VDQogICAgdmFyIENyZWF0ZVRhYmxlUGFnZUh0bWwgPSBmdW5jdGlvbiAoUGFnZVNpemUsIGRhdGFDb3VudCwgUGFnZUluZGV4KSB7DQogICAgICAgIC8v5pi+56S65YiG6aG15oyJ6ZKu55qE5Liq5pWwDQogICAgICAgIHZhciBQYWdlSW5kZXhCdXRDb3VudCA9IFBhZ2VTaG93QnV0Q291bnQ7DQogICAgICAgIC8v5oC76aG15pWwDQogICAgICAgIHZhciBQYWdlQ291bnQgPSAwOw0KICAgICAgICBpZiAoKGRhdGFDb3VudCAlIFBhZ2VTaXplKSA9PSAwKSB7DQogICAgICAgICAgICBQYWdlQ291bnQgPSBwYXJzZUludChkYXRhQ291bnQgLyBQYWdlU2l6ZSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBQYWdlQ291bnQgPSBwYXJzZUludChkYXRhQ291bnQgLyBQYWdlU2l6ZSkgKyAxOw0KICAgICAgICB9DQogICAgICAgIC8v5a2Y5YKo5YWo5bGA5Y+Y6YeP5oC76aG15pWwDQogICAgICAgIERhdGFQYWdlQ291bnQgPSBQYWdlQ291bnQ7DQogICAgICAgIHZhciBTaG93TWFuYWdlclR4dCA9IFBhZ2VDb3VudDsNCiAgICAgICAgaWYgKFBhZ2VDb3VudCA9PSAwKSB7DQogICAgICAgICAgICBTaG93TWFuYWdlclR4dCA9ICLml6DmlbDmja4iOw0KICAgICAgICB9DQogICAgICAgIHZhciBQYWdlVHh0SHRtbCA9ICI8ZGl2IGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgU2hvd01hbmFnZXInPjxzcGFuIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgIFBhZ2VUeHQnPuW9k+WJje+8miIgKyAocGFyc2VJbnQoUGFnZUluZGV4KSArIDEpICsgIi8iICsgU2hvd01hbmFnZXJUeHQgKyAiPC9zcGFuPiI7DQogICAgICAgIHZhciBVcEluZGV4ID0gIjxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBQYWdlSG9tZScgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KDAsMCwiICsgUGFnZUNvdW50ICsgIiknID7pppbpobU8L2E+IjsNCiAgICAgICAgdmFyIERvd0luZGV4ID0gIjxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBQYWdlRW5kJyBocmVmPSdqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoIiArIChwYXJzZUludChQYWdlQ291bnQpIC0gMSkgKyAiLDAsIiArIFBhZ2VDb3VudCArICIpJyA+5bC+6aG1PC9hPiI7DQogICAgICAgIHZhciBOZXh0UGFnZUluZGV4ID0gIjxsYWJlbCBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2wgUGFnZUp1bXBUeHQnPui3s+i9rDxzZWxlY3QgY2xhc3M9J1RhYmxlUGFnaW5nUGFnZURpdiBUb29sIFBhZ2VKdW1wJyBvbmNoYW5nZT1cIm5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQodGhpcy52YWx1ZSwwLCIgKyBQYWdlQ291bnQgKyAiKVwiPiI7DQogICAgICAgIC8v5Yik5pat5piv5ZCm5byA5ZCvDQogICAgICAgIGlmICghUGFnZUluZGV4VG9vbCkgew0KICAgICAgICAgICAgVXBJbmRleCA9ICIiOw0KICAgICAgICAgICAgRG93SW5kZXggPSAiIjsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgUGFnZUJ1dEh0bWwgPSAiPGRpdiBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2xEaXYnPiIgKyBVcEluZGV4ICsgIjxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBVcCcgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KCIgKyBwYXJzZUludChQYWdlSW5kZXgpICsgIiwxLCIgKyBQYWdlQ291bnQgKyAiKScgPuS4iuS4gOmhtTwvYT4iOw0KICAgICAgICB2YXIgQ291bnRQYWdlQnV0ID0gMDsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBQYWdlQ291bnQ7IGkrKykgew0KICAgICAgICAgICAgLy/ot7PovazpobUNCiAgICAgICAgICAgIGlmIChwYXJzZUludChQYWdlSW5kZXgpID09IGkpIHsNCiAgICAgICAgICAgICAgICBOZXh0UGFnZUluZGV4ICs9ICI8b3B0aW9uIHNlbGVjdGVkPSdzZWxlY3RlZCcgdmFsdWU9XCIiICsgaSArICJcIj4iICsgKGkgKyAxKSArICI8L29wdGlvbj4iOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBOZXh0UGFnZUluZGV4ICs9ICI8b3B0aW9uIHZhbHVlPVwiIiArIGkgKyAiXCI+IiArIChpICsgMSkgKyAiPC9vcHRpb24+IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IFBhZ2VDb3VudDsgaSsrKSB7DQogICAgICAgICAgICAvL+WIhumhtee8qei/m+eul+azlemhteaVsOWwj+S6jjcNCiAgICAgICAgICAgIGlmIChQYWdlQ291bnQgPD0gUGFnZUluZGV4QnV0Q291bnQpIHsNCiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQoUGFnZUluZGV4KSA9PSBpKSB7DQogICAgICAgICAgICAgICAgICAgIFBhZ2VCdXRIdG1sICs9ICIgPGVtIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbFR4dCc+IiArIChpICsgMSkgKyAiPC9lbT4iOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIFBhZ2VCdXRIdG1sICs9ICIgPGEgY2xhc3M9J1RhYmxlUGFnaW5nUGFnZURpdiBUb29sIFRvb2xCdXR0b24nIGhyZWY9J2phdmFzY3JpcHQ6bmV3IERhdGFUYWJsZU9iaigpLlBhZ2VJbmRleEJ1dCgiICsgaSArICIsMCwiICsgUGFnZUNvdW50ICsgIiknID4iICsgKGkgKyAxKSArICI8L2E+IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8v5b2T6aG15pWw5aSn5LqONw0KICAgICAgICAgICAgICAgIC8vaWYgKGkgPCBQYWdlSW5kZXhCdXRDb3VudCkgew0KICAgICAgICAgICAgICAgIHZhciBpdCA9IHBhcnNlSW50KHBhcnNlSW50KFBhZ2VJbmRleCkgLyBQYWdlSW5kZXhCdXRDb3VudCk7DQogICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KFBhZ2VJbmRleCkgPiBwYXJzZUludChQYWdlSW5kZXhCdXRDb3VudCAvIDIpKSB7DQogICAgICAgICAgICAgICAgICAgIC8v5b2T6YCJ5oup55qE6aG15pWw6LaF6L+H5LiA5Y2K55qE5pe25YCZDQogICAgICAgICAgICAgICAgICAgIGlmIChpID49IHBhcnNlSW50KFBhZ2VJbmRleCAtIChwYXJzZUludChQYWdlSW5kZXhCdXRDb3VudCAvIDIpKSkgJiYgKFBhZ2VDb3VudCAtIHBhcnNlSW50KFBhZ2VJbmRleCkpID4gcGFyc2VJbnQoUGFnZUluZGV4QnV0Q291bnQgLyAyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKENvdW50UGFnZUJ1dCA8IFBhZ2VJbmRleEJ1dENvdW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ291bnRQYWdlQnV0Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KFBhZ2VJbmRleCkgPT0gaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxlbSBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2xUeHQnPiIgKyAoaSArIDEpICsgIjwvZW0+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBUb29sQnV0dG9uJyBocmVmPSdqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoIiArIGkgKyAiLDAsIiArIFBhZ2VDb3VudCArICIpJyA+IiArIChpICsgMSkgKyAiPC9hPiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzmmK/liLDmnIDlkI7kuIDnu4QNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoUGFnZUNvdW50IC0gaSkgPCBQYWdlSW5kZXhCdXRDb3VudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAoUGFnZUNvdW50IC0gUGFnZUluZGV4QnV0Q291bnQpOyBpIDwgUGFnZUNvdW50OyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KFBhZ2VJbmRleCkgPT0gaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIiA8ZW0gY2xhc3M9J1RhYmxlUGFnaW5nUGFnZURpdiBUb29sVHh0Jz4iICsgKGkgKyAxKSArICI8L2VtPiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBUb29sQnV0dG9uJyBocmVmPSdqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoIiArIGkgKyAiLDAsIiArIFBhZ2VDb3VudCArICIpJyAgPiIgKyAoaSArIDEpICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA+PSAocGFyc2VJbnQoUGFnZUluZGV4IC0gKHBhcnNlSW50KFBhZ2VJbmRleEJ1dENvdW50IC8gMikpKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKENvdW50UGFnZUJ1dCA8IFBhZ2VJbmRleEJ1dENvdW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb3VudFBhZ2VCdXQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChQYWdlSW5kZXgpID09IGkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxlbSBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2xUeHQnPiIgKyAoaSArIDEpICsgIjwvZW0+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIiA8YSBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2wgVG9vbEJ1dHRvbicgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KCIgKyBpICsgIiwwLCIgKyBQYWdlQ291bnQgKyAiKScgPiIgKyAoaSArIDEpICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKENvdW50UGFnZUJ1dCA8IFBhZ2VJbmRleEJ1dENvdW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBDb3VudFBhZ2VCdXQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChQYWdlSW5kZXgpID09IGkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxlbSBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2xUeHQnPiIgKyAoaSArIDEpICsgIjwvZW0+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIiA8YSBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2wgVG9vbEJ1dHRvbicgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KCIgKyBpICsgIiwwLCIgKyBQYWdlQ291bnQgKyAiKScgPiIgKyAoaSArIDEpICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8v6Lez6L2s6aG157uT5p2fDQogICAgICAgIE5leHRQYWdlSW5kZXggKz0gIjwvc2VsZWN0PumhtTwvbGFiZWw+IjsNCiAgICAgICAgLy/liKTmlq3mmK/lkKblvIDlkK8NCiAgICAgICAgaWYgKCFQYWdlSW5kZXhUb29sKSB7DQogICAgICAgICAgICBOZXh0UGFnZUluZGV4ID0gIiI7DQogICAgICAgIH0NCiAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIjxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBEb3cnICBocmVmPSdqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoIiArIHBhcnNlSW50KFBhZ2VJbmRleCkgKyAiLDIsIiArIFBhZ2VDb3VudCArICIpJyA+5LiL5LiA6aG1PC9hPiIgKyBEb3dJbmRleCArICIiICsgTmV4dFBhZ2VJbmRleCArICI8L2Rpdj4iOw0KICAgICAgICBQYWdlVHh0SHRtbCArPSBQYWdlQnV0SHRtbCArICIiOw0KICAgICAgICAvL2FsZXJ0KERhdGFUYWJsZURpdklkKTsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmlubmVySFRNTCArPSBQYWdlVHh0SHRtbDsNCiAgICB9DQogICAgdGhpcy5QYWdlSW5kZXhCdXQgPSBmdW5jdGlvbiAoUGFnZUluZGV4LCBQYWdlSW5kZXhUeXBlLCBQYWdlQ291bnQpIHsNCiAgICAgICAgdmFyIGluZGV4ID0gMDsNCiAgICAgICAgaWYgKFBhZ2VJbmRleFR5cGUgPT0gMCkgew0KICAgICAgICAgICAgaW5kZXggPSBwYXJzZUludChQYWdlSW5kZXgpOw0KICAgICAgICB9IGVsc2UgaWYgKFBhZ2VJbmRleFR5cGUgPT0gMSkgew0KICAgICAgICAgICAgLy/kuIrkuIDpobUNCiAgICAgICAgICAgIGlmICgoUGFnZUluZGV4IC0gMSkgPj0gMCkgew0KICAgICAgICAgICAgICAgIGluZGV4ID0gKHBhcnNlSW50KFBhZ2VJbmRleCkgLSAxKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaW5kZXggPSBwYXJzZUludChQYWdlSW5kZXgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKFBhZ2VJbmRleFR5cGUgPT0gMikgew0KICAgICAgICAgICAgLy/kuIvkuIDpobUNCiAgICAgICAgICAgIGlmICgocGFyc2VJbnQoUGFnZUluZGV4KSArIDEpIDwgUGFnZUNvdW50KSB7DQogICAgICAgICAgICAgICAgaW5kZXggPSAocGFyc2VJbnQoUGFnZUluZGV4KSArIDEpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpbmRleCA9IHBhcnNlSW50KFBhZ2VJbmRleCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLy/kv53lrZjlvZPliY3kuZ/nmoTntKLlvJUNCiAgICAgICAgUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzID0gaW5kZXg7DQogICAgICAgIFBvc3RSZXF1ZXN0KFBvc3JVcmxUeHQsIEdldFBvc3RQYXJhbWV0ZXJzVG9HZXREYXRhKGluZGV4LCBHZXREYXRhVGFibGVCeVdoZXJlKSk7DQogICAgfQ0KICAgIC8v5p+l6K+i5Y+C5pWw55Sf5oiQDQogICAgdmFyIEdldFBvc3RQYXJhbWV0ZXJzVG9HZXREYXRhID0gZnVuY3Rpb24gKFBhZ2VJbmRleCwgV2hlcmVUeHQpIHsNCiAgICAgICAgcmV0dXJuICJ7XCJQYWdlSW5kZXhcIjoiICsgUGFnZUluZGV4ICsgIixcIldoZXJlVHh0XCI6XCIiICsgV2hlcmVUeHQgKyAiXCIsXCJXaGVyZUtleVwiOlwiXCIsXCJQb3N0VHlwZUZ1blwiOjF9IjsgLy/or7vlj5bmlbDmja4NCiAgICB9DQogICAgLy/liKDpmaTlj4LmlbDnlJ/miJANCiAgICB2YXIgR2V0UG9zdFBhcmFtZXRlcnNUb0RlbGV0ZUl0ZW0gPSBmdW5jdGlvbiAoV2hlcmVLZXkpIHsNCiAgICAgICAgcmV0dXJuICJ7XCJQYWdlSW5kZXhcIjowLFwiV2hlcmVUeHRcIjpcIlwiLFwiV2hlcmVLZXlcIjpcIiIgKyBXaGVyZUtleSArICJcIixcIlBvc3RUeXBlRnVuXCI6MH0iOyAvL+WIoOmZpA0KICAgIH0NCiAgICAvL+WIt+aWsOW9k+WJjemhteWPguaVsOeUn+aIkA0KICAgIHZhciBHZXRQb3N0UGFyYW1ldGVyc1RvUmVmcmVzaCA9IGZ1bmN0aW9uIChQYWdlSW5kZXgsIFdoZXJlVHh0KSB7DQogICAgICAgIHJldHVybiAie1wiUGFnZUluZGV4XCI6IiArIFBhZ2VJbmRleCArICIsXCJXaGVyZVR4dFwiOlwiIiArIFdoZXJlVHh0ICsgIlwiLFwiV2hlcmVLZXlcIjpcIlwiLFwiUG9zdFR5cGVGdW5cIjoyfSI7IC8v5Yi35paw5b2T5YmN6aG1DQogICAgfQ0KICAgIC8v5Yig6Zmk5Ye95pWwDQogICAgdGhpcy5EYXRhVGFibGVEZWxldGVCeUtleSA9IGZ1bmN0aW9uIChLZXkpIHsNCiAgICAgICAgaWYgKEtleSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGFsZXJ0KCLmirHmrYnkvaDmsqHmnInnu5Hlrpror6XpobnmlbDmja7nmoTllK/kuIDplK7vvIzns7vnu5/msqHmnInmnaHku7bov5vooYzliKDpmaQiKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoY29uZmlybShEZWxldGVTaG93VHh0KSkgew0KICAgICAgICAgICAgUG9zdFJlcXVlc3QoUG9zclVybFR4dCwgR2V0UG9zdFBhcmFtZXRlcnNUb0RlbGV0ZUl0ZW0oS2V5KSk7DQogICAgICAgIH0NCiAgICB9DQogICAgLy/plK7nm5jkuovku7YNCiAgICBkb2N1bWVudC5vbmtleXVwID0gZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIga2V5Y29kZSA9IGV2ZW50LndoaWNoIHx8IGV2ZW50LmtleUNvZGU7DQogICAgICAgIGlmIChrZXljb2RlID09IDM3KSB7DQogICAgICAgICAgICAvL+S4iuS4gOmhtQ0KICAgICAgICAgICAgbmV3IERhdGFUYWJsZU9iaigpLlBhZ2VJbmRleEJ1dChQYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMsIDEsIERhdGFQYWdlQ291bnQpOw0KICAgICAgICB9IGVsc2UgaWYgKGtleWNvZGUgPT0gMzkpIHsNCiAgICAgICAgICAgIC8v5LiL5LiA6aG1DQogICAgICAgICAgICBuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KFBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcywgMiwgRGF0YVBhZ2VDb3VudCk7DQogICAgICAgIH0NCiAgICB9DQoNCg0KICAgIHRoaXMuQ2hlY2tBbGxDaGFuZ2VPYmpUb0RhdGFUYWJsZSA9IGZ1bmN0aW9uIChvYmpDaGVjaykgew0KICAgICAgICB2YXIgVmFsTGlzdEtleSA9ICIiOw0KICAgICAgICBpZiAob2JqQ2hlY2suY2hlY2tlZCkgew0KICAgICAgICAgICAgLy/pgInmi6kNCiAgICAgICAgICAgIG9iakNoZWNrLnBhcmVudE5vZGUuY2hpbGRyZW5bMV0uaW5uZXJUZXh0ID0gQ2hlY2tJc1RydWVUeHQ7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJEYXRhVGFibGVJdGVtQ2hlY2siKS5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJEYXRhVGFibGVJdGVtQ2hlY2siKVtpXS5jaGVja2VkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICE9IG51bGwgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICE9ICIiICYmIGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJEYXRhVGFibGVJdGVtQ2hlY2siKVtpXS52YWx1ZSAhPSAib24iKSB7DQogICAgICAgICAgICAgICAgICAgIFZhbExpc3RLZXkgKz0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICsgIiwiOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLmNoZWNrZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICE9IG51bGwgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICE9ICIiICYmIGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJEYXRhVGFibGVJdGVtQ2hlY2siKVtpXS52YWx1ZSAhPSAib24iKSB7DQogICAgICAgICAgICAgICAgICAgIFZhbExpc3RLZXkgKz0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICsgIiwiOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG9iakNoZWNrLnBhcmVudE5vZGUuY2hpbGRyZW5bMV0uaW5uZXJUZXh0ID0gQ2hlY2tJc0ZhbHNlVHh0Ow0KICAgICAgICB9DQogICAgICAgIGlmIChWYWxMaXN0S2V5Lmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIFZhbExpc3RLZXkgPSBWYWxMaXN0S2V5LnN1YnN0cmluZygwLCBWYWxMaXN0S2V5Lmxlbmd0aCAtIDEpOw0KICAgICAgICB9DQogICAgICAgIG9iakNoZWNrLnNldEF0dHJpYnV0ZSgidGFnIiwgIntcImNoZWNrZWRcIjpcIiIgKyBvYmpDaGVjay5jaGVja2VkICsgIlwiLFwibGlzdFwiOlwiIiArIFZhbExpc3RLZXkgKyAiXCJ9Iik7DQogICAgICAgIENoZWNrQWxsQ2hhbmdlKCJ7XCJjaGVja2VkXCI6XCIiICsgb2JqQ2hlY2suY2hlY2tlZCArICJcIixcImxpc3RcIjpcIiIgKyBWYWxMaXN0S2V5ICsgIlwifSIpOw0KICAgIH0NCiAgICB0aGlzLkNoZWNrSXRlbUNoYW5nZU9ialRvRGF0YVRhYmxlID0gZnVuY3Rpb24gKG9iaktleSkgew0KICAgICAgICBpZiAoIW9iaktleS5jaGVja2VkKSB7DQogICAgICAgICAgICBvYmpLZXkucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2hpbGRyZW5bMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0IilbMF0uY2hlY2tlZCA9IGZhbHNlOw0KICAgICAgICAgICAgb2JqS2V5LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNoaWxkcmVuWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzcGFuIilbMF0uaW5uZXJUZXh0ID0gIuWFqOmAiSI7DQogICAgICAgIH0NCiAgICAgICAgQ2hlY2tJdGVtQ2hhbmdlKG9iaktleSk7DQogICAgfQ0KICAgIC8vL+iOt+WPluWFqOmAieWQjuaJgOmAieaLqeaVsOaNrueahOWUr+S4gOmUruWAvOeahOWIl+ihqA0KICAgIHRoaXMuR2V0Q2hlY2tBbGxWYWx1ZUxpc3QgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBMaXN0S2V5ID0gIiI7DQogICAgICAgIHZhciBMaXN0Q2hlY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgiRGF0YVRhYmxlSXRlbUNoZWNrIik7IC8vRGF0YVRhYmxlSXRlbUNoZWNrIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGFibGUiKVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaW5wdXQiKTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBMaXN0Q2hlY2subGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGlmIChMaXN0Q2hlY2tbaV0uY2hlY2tlZCkgew0KICAgICAgICAgICAgICAgIExpc3RLZXkgKz0gTGlzdENoZWNrW2ldLnZhbHVlICsgIiwiOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChMaXN0S2V5Lmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIExpc3RLZXkgPSBMaXN0S2V5LnN1YnN0cmluZygwLCBMaXN0S2V5Lmxlbmd0aCAtIDEpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBMaXN0S2V5OyAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChEYXRhVGFibGVEaXZJZCkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRkIilbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0IilbMF0uZ2V0QXR0cmlidXRlKCJ0YWciKTsNCiAgICB9DQoNCiAgICB2YXIgUG9zdFN0YXJ0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAvL2FsZXJ0KCLlvIDlp4vor7fmsYIiKTsNCiAgICAgICAgU2hvd1R4dERpdihMb2dpbkRpdlR4dCk7DQogICAgfQ0KICAgIHZhciBTaG93VHh0RGl2ID0gZnVuY3Rpb24gKHR4dCkgew0KICAgICAgICB2YXIgbG9kaW5nZGl2b2JqID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIjk1ZTYzOGZhMjQzM2U2ODAyYjZkMjgyMDFlMjhiNzNkIik7DQogICAgICAgIGlmIChsb2RpbmdkaXZvYmogIT0gdW5kZWZpbmVkICYmIGxvZGluZ2Rpdm9iaiAhPSBudWxsKSB7DQogICAgICAgICAgICBsb2RpbmdkaXZvYmoucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsb2RpbmdkaXZvYmopOw0KICAgICAgICB9DQogICAgICAgIGlmIChMb2dpbkRpdkNsYXNzTmFtZSAhPSAiIikgew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmlubmVySFRNTCA9ICI8ZGl2IGlkPSc5NWU2MzhmYTI0MzNlNjgwMmI2ZDI4MjAxZTI4YjczZCcgY2xhc3M9JyIgKyBMb2dpbkRpdkNsYXNzTmFtZSArICInPiIgKyB0eHQgKyAiPC9kaXY+IiArIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5pbm5lckhUTUw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChEYXRhVGFibGVEaXZJZCkuaW5uZXJIVE1MID0gIjxkaXYgaWQ9Jzk1ZTYzOGZhMjQzM2U2ODAyYjZkMjgyMDFlMjhiNzNkJyBzdHlsZT0nd2lkdGg6OTBweDtoZWlnaHQ6MzBweDtvcGFjaXR5OjEuMDtiYWNrZ3JvdW5kLWNvbG9yOiM5OTk5OTk7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDo5MDA7Ym9yZGVyOnNvbGlkIDFweCAjRjBDMzZEO2JhY2tncm91bmQtY29sb3I6I0Y5RURCRTtmb250LXNpemU6MTNweDtjb2xvcjojNjY2O3RleHQtYWxpZ246Y2VudGVyO2xpbmUtaGVpZ2h0OjMwcHg7bWFyZ2luLWxlZnQ6MjUlOyc+IiArIHR4dCArICI8L2Rpdj4iICsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmlubmVySFRNTDsNCiAgICAgICAgfQ0KICAgIH0NCiAgICB2YXIgQ1pTaG93VHh0RGl2ID0gZnVuY3Rpb24gKHR4dCkgew0KICAgICAgICB2YXIgbG9kaW5nZGl2b2JqID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIjk1ZTYzOGZhMjQzM2U2ODAyYjZkMjgyMDFlMjhiNzNkIik7DQogICAgICAgIGlmIChsb2RpbmdkaXZvYmogIT0gdW5kZWZpbmVkICYmIGxvZGluZ2Rpdm9iaiAhPSBudWxsKSB7DQogICAgICAgICAgICBsb2RpbmdkaXZvYmoucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsb2RpbmdkaXZvYmopOw0KICAgICAgICB9DQogICAgICAgIGlmIChMb2dpbkRpdkNsYXNzTmFtZSAhPSAiIikgew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmlubmVySFRNTCA9ICI8ZGl2IGlkPSc5NWU2MzhmYTI0MzNlNjgwMmI2ZDI4MjAxZTI4YjczZCcgY2xhc3M9JyIgKyBMb2dpbkRpdkNsYXNzTmFtZSArICInPiIgKyB0eHQgKyAiPC9kaXY+IjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5pbm5lckhUTUwgPSAiPGRpdiBpZD0nOTVlNjM4ZmEyNDMzZTY4MDJiNmQyODIwMWUyOGI3M2QnIHN0eWxlPSd3aWR0aDo5MHB4O2hlaWdodDozMHB4O29wYWNpdHk6MS4wO2JhY2tncm91bmQtY29sb3I6Izk5OTk5OTtwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjkwMDtib3JkZXI6c29saWQgMXB4ICNGMEMzNkQ7YmFja2dyb3VuZC1jb2xvcjojRjlFREJFO2ZvbnQtc2l6ZToxM3B4O2NvbG9yOiM2NjY7dGV4dC1hbGlnbjpjZW50ZXI7bGluZS1oZWlnaHQ6MzBweDttYXJnaW4tbGVmdDoyNSU7Jz4iICsgdHh0ICsgIjwvZGl2PiI7DQogICAgICAgIH0NCiAgICB9DQogICAgdmFyIFBvc3RTdG9wID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAvL2FsZXJ0KCLor7fmsYLlrozmr5UiKTsNCiAgICB9DQogICAgdGhpcy5VcFN0YXRlUmVmcmVzaCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgUG9zdFJlcXVlc3QoUG9zclVybFR4dCwgR2V0UG9zdFBhcmFtZXRlcnNUb1JlZnJlc2goUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzLCBHZXREYXRhVGFibGVCeVdoZXJlKSk7DQogICAgfQ0KICAgIHRoaXMuU2VsZWN0RGF0YVRhYmxlID0gZnVuY3Rpb24gKGpzb25Nb2RlbCwgX0RlbGV0ZUl0ZW1TdGF0ZSwgX1VwZGF0ZUJ1dENsaWNrLCBfQ2hlY2tBbGxDaGFuZ2UsIF9DaGVja0l0ZW1DaGFuZ2UsIF9DYWxsYmFjaykgew0KICAgICAgICAvL1Nob3dEYXRhVGFibGVEaXZJZCwgR2V0RGF0YVRhYmxlVXJsLCBHZXREYXRhVGFibGVCeVdoZXJlVHh0LCBfVXBkYXRlQnV0Q2xpY2ssIF9EZWxldGVJdGVtU3RhdGUsIF9DaGVja0FsbENoYW5nZSwgX0NoZWNrSXRlbUNoYW5nZQ0KDQogICAgICAgIERhdGFUYWJsZURpdklkID0ganNvbk1vZGVsLlNob3dEYXRhVGFibGVEaXZJZDsNCiAgICAgICAgUG9zclVybFR4dCA9IGpzb25Nb2RlbC5HZXREYXRhVGFibGVVcmw7DQogICAgICAgIEdldERhdGFUYWJsZUJ5V2hlcmUgPSBqc29uTW9kZWwuR2V0RGF0YVRhYmxlQnlXaGVyZVR4dDsNCiAgICAgICAgUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzID0gMDsNCiAgICAgICAgLy9EYXRhUGFnZUNvdW50ID0gMDsNCiAgICAgICAgUGFnZVNob3dCdXRDb3VudCA9IDc7DQogICAgICAgIC8v5Yid5aeL5YyW5Y+C5pWwDQogICAgICAgIERlbGV0ZUJ1dE5hbWUgPSAi5Yig6ZmkIjsNCiAgICAgICAgVXBkYXRlQnV0TmFtZSA9ICLkv67mlLkiOw0KICAgICAgICBDaGVja0lzVHJ1ZVR4dCA9ICLlj43pgIkiOw0KICAgICAgICBDaGVja0lzRmFsc2VUeHQgPSAi5YWo6YCJIjsNCiAgICAgICAgQ2hlY2tJdGVtVHh0ID0gIiI7DQogICAgICAgIERlbGV0ZU9yVXBkYXRlVGl0bGUgPSAi5pON5L2cIjsNCiAgICAgICAgLy/liqDovb3ml7ZkaXbnmoTmoLflvI8NCiAgICAgICAgTG9naW5EaXZDbGFzc05hbWUgPSAiIjsNCiAgICAgICAgLy/liqDovb3ml7ZkaXbnmoTmloflrZcNCiAgICAgICAgTG9naW5EaXZUeHQgPSAi5q2j5Zyo6K+35rGCLi4uIjsgLy/mj5DnpLrooYzmloflrZcNCiAgICAgICAgRGVsZXRlU2hvd1R4dCA9ICLkvaDnoa7lrpropoHliKDpmaTor6XpobnmlbDmja7lkJfvvJ8iOw0KICAgICAgICBQYWdlSW5kZXhUb29sID0gZmFsc2U7DQogICAgICAgIGlmIChqc29uTW9kZWwuUGFnZUluZGV4VG9vbFN0YXRlICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgUGFnZUluZGV4VG9vbCA9IGpzb25Nb2RlbC5QYWdlSW5kZXhUb29sU3RhdGU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5EZWxldGVTaG93VHh0ICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgRGVsZXRlU2hvd1R4dCA9IGpzb25Nb2RlbC5EZWxldGVTaG93VHh0Ow0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuU2hvd0RhdGFUYWJsZURpdklkID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgLy/ojrflj5bmmL7npLrnmoRkaXZpZA0KICAgICAgICAgICAgRGF0YVRhYmxlRGl2SWQgPSAi44CQRGF0YVRhYmxlRGl2SWTjgJEiOw0KICAgICAgICAgICAgaWYgKERhdGFUYWJsZURpdklkID09IHVuZGVmaW5lZCB8fCBEYXRhVGFibGVEaXZJZCA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgYWxlcnQoIuS9oOW/hemhu+aPkOS+m+aYvuekuuaVsOaNrueahGRpdueahElEIik7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuR2V0RGF0YVRhYmxlVXJsID09IHVuZGVmaW5lZCkgey8vZ2V0UG9zdFVybEJ5RGF0YVRhYmxlDQogICAgICAgICAgICAvL+ivt+axgueahOWcsOWdgA0KICAgICAgICAgICAgUG9zclVybFR4dCA9ICLjgJBQb3NyVXJsVHh044CRIjsNCiAgICAgICAgICAgIGlmIChQb3NyVXJsVHh0ID09IHVuZGVmaW5lZCB8fCBQb3NyVXJsVHh0ID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICBhbGVydCgi5L2g6YeH55So55qE5piv6Ieq6YCJ5Zyw5Z2A5L2c5Li66K+35rGC5Zyw5Z2A77yM5L2G5piv5Y+v6IO95Zug5Li65YW85a655oCn6Zeu6aKY5peg5rOV6I635Y+W6K+35rGC5Zyw5Z2A77yM6K+35bCGanPlvJXnlKjku6PnoIHmlL7lhaXpobXpnaLmnIDliY3mlrnjgIIiKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5HZXREYXRhVGFibGVCeVdoZXJlVHh0ID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgR2V0RGF0YVRhYmxlQnlXaGVyZSA9ICIiOw0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzID0gcGFyc2VJbnQoanNvbk1vZGVsLlBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcyk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5QYWdlU2hvd0J1dENvdW50ICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgUGFnZVNob3dCdXRDb3VudCA9IHBhcnNlSW50KGpzb25Nb2RlbC5QYWdlU2hvd0J1dENvdW50KTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoanNvbk1vZGVsLkRlbGV0ZUJ1dEh0bWwgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBEZWxldGVCdXROYW1lID0ganNvbk1vZGVsLkRlbGV0ZUJ1dEh0bWw7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5VcGRhdGVCdXRIdG1sICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgVXBkYXRlQnV0TmFtZSA9IGpzb25Nb2RlbC5VcGRhdGVCdXRIdG1sOw0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuQ2hlY2tJc1RydWVUeHQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBDaGVja0lzVHJ1ZVR4dCA9IGpzb25Nb2RlbC5DaGVja0lzVHJ1ZVR4dDsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoanNvbk1vZGVsLkNoZWNrSXNGYWxzZVR4dCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIENoZWNrSXNGYWxzZVR4dCA9IGpzb25Nb2RlbC5DaGVja0lzRmFsc2VUeHQ7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5DaGVja0l0ZW1UeHQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBDaGVja0l0ZW1UeHQgPSBqc29uTW9kZWwuQ2hlY2tJdGVtVHh0Ow0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuRGVsZXRlT3JVcGRhdGVUaXRsZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIERlbGV0ZU9yVXBkYXRlVGl0bGUgPSBqc29uTW9kZWwuRGVsZXRlT3JVcGRhdGVUaXRsZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoanNvbk1vZGVsLkxvZ2luRGl2Q2xhc3NOYW1lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgTG9naW5EaXZDbGFzc05hbWUgPSBqc29uTW9kZWwuTG9naW5EaXZDbGFzc05hbWU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5Mb2dpbkRpdkh0bWwgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBMb2dpbkRpdlR4dCA9IGpzb25Nb2RlbC5Mb2dpbkRpdkh0bWw7DQogICAgICAgIH0NCiAgICAgICAgLy/liJ3lp4vljJblj4LmlbAgIOaWueazlQ0KICAgICAgICBVcGRhdGVCdXRDbGljayA9IG51bGw7DQogICAgICAgIERlbGV0ZUl0ZW1TdGF0ZSA9IG51bGw7DQogICAgICAgIENoZWNrQWxsQ2hhbmdlID0gbnVsbDsNCiAgICAgICAgQ2hlY2tJdGVtQ2hhbmdlID0gbnVsbDsNCiAgICAgICAgQ2FsbGJhY2sgPSBudWxsOw0KICAgICAgICAvL+S9v+eUqGpzb27mnaXliJ3lp4vljJYNCiAgICAgICAgaWYgKGpzb25Nb2RlbC5VcGRhdGVCdXRDbGljayAhPSB1bmRlZmluZWQgJiYganNvbk1vZGVsLlVwZGF0ZUJ1dENsaWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgIFVwZGF0ZUJ1dENsaWNrID0ganNvbk1vZGVsLlVwZGF0ZUJ1dENsaWNrOw0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuRGVsZXRlSXRlbVN0YXRlICE9IHVuZGVmaW5lZCAmJiBqc29uTW9kZWwuRGVsZXRlSXRlbVN0YXRlICE9IG51bGwpIHsNCiAgICAgICAgICAgIERlbGV0ZUl0ZW1TdGF0ZSA9IGpzb25Nb2RlbC5EZWxldGVJdGVtU3RhdGU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5DaGVja0FsbENoYW5nZSAhPSB1bmRlZmluZWQgJiYganNvbk1vZGVsLkNoZWNrQWxsQ2hhbmdlICE9IG51bGwpIHsNCiAgICAgICAgICAgIENoZWNrQWxsQ2hhbmdlID0ganNvbk1vZGVsLkNoZWNrQWxsQ2hhbmdlOw0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuQ2hlY2tJdGVtQ2hhbmdlICE9IHVuZGVmaW5lZCAmJiBqc29uTW9kZWwuQ2hlY2tJdGVtQ2hhbmdlICE9IG51bGwpIHsNCiAgICAgICAgICAgIENoZWNrSXRlbUNoYW5nZSA9IGpzb25Nb2RlbC5DaGVja0l0ZW1DaGFuZ2U7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5DYWxsYmFjayAhPSB1bmRlZmluZWQgJiYganNvbk1vZGVsLkNhbGxiYWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgIENhbGxiYWNrID0ganNvbk1vZGVsLkNhbGxiYWNrOw0KICAgICAgICB9DQogICAgICAgIC8v5Yik5pat5Yid5aeL5YyW5Y+C5pWwDQogICAgICAgIGlmIChfVXBkYXRlQnV0Q2xpY2sgIT0gdW5kZWZpbmVkICYmIF9VcGRhdGVCdXRDbGljayAhPSBudWxsKSB7DQogICAgICAgICAgICBVcGRhdGVCdXRDbGljayA9IF9VcGRhdGVCdXRDbGljazsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoX0RlbGV0ZUl0ZW1TdGF0ZSAhPSB1bmRlZmluZWQgJiYgX0RlbGV0ZUl0ZW1TdGF0ZSAhPSBudWxsKSB7DQogICAgICAgICAgICBEZWxldGVJdGVtU3RhdGUgPSBfRGVsZXRlSXRlbVN0YXRlOw0KICAgICAgICB9DQogICAgICAgIGlmIChfQ2hlY2tBbGxDaGFuZ2UgIT0gdW5kZWZpbmVkICYmIF9DaGVja0FsbENoYW5nZSAhPSBudWxsKSB7DQogICAgICAgICAgICBDaGVja0FsbENoYW5nZSA9IF9DaGVja0FsbENoYW5nZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoX0NoZWNrSXRlbUNoYW5nZSAhPSB1bmRlZmluZWQgJiYgX0NoZWNrSXRlbUNoYW5nZSAhPSBudWxsKSB7DQogICAgICAgICAgICBDaGVja0l0ZW1DaGFuZ2UgPSBfQ2hlY2tJdGVtQ2hhbmdlOw0KICAgICAgICB9DQogICAgICAgIGlmIChfQ2FsbGJhY2sgIT0gdW5kZWZpbmVkICYmIF9DYWxsYmFjayAhPSBudWxsKSB7DQogICAgICAgICAgICBDYWxsYmFjayA9IF9DYWxsYmFjazsNCiAgICAgICAgfQ0KICAgICAgICAvL2FsZXJ0KENoZWNrQWxsQ2hhbmdlKTsNCiAgICAgICAgUG9zdFJlcXVlc3QoUG9zclVybFR4dCwgR2V0UG9zdFBhcmFtZXRlcnNUb0dldERhdGEoMCwgR2V0RGF0YVRhYmxlQnlXaGVyZSkpOw0KICAgIH0NCn0NCi8v6I635Y+WdXJs55qE5Y+C5pWwDQpmdW5jdGlvbiBnZXRRdWVyeVN0cmluZ0J5RGF0YVRhYmxlKHVybCwgbmFtZSkgew0KICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKCIoXnwmKSIgKyBuYW1lICsgIj0oW14mXSopKCZ8JCkiLCAiaSIpOw0KICAgIGlmICh1cmwuaW5kZXhPZignPycpID09IC0xKSB7DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHVybCA9IHVybC5zdWJzdHIodXJsLmluZGV4T2YoJz8nKSwgdXJsLmxlbmd0aCk7DQogICAgICAgIHZhciByID0gdXJsLnN1YnN0cigxKS5tYXRjaChyZWcpOw0KICAgICAgICBpZiAociAhPSBudWxsKSByZXR1cm4gdW5lc2NhcGUoclsyXSk7IHJldHVybiBudWxsOw0KICAgIH0NCn0NCi8v6I635Y+W6K+35rGCdXJsDQpmdW5jdGlvbiBnZXRQb3N0VXJsQnlEYXRhVGFibGUodXJsKSB7DQogICAgaWYgKHVybC5pbmRleE9mKCc/JykgPT0gLTEpIHsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfSBlbHNlIHsNCiAgICAgICAgdXJsID0gdXJsLnN1YnN0cigwLCB1cmwuaW5kZXhPZignPycpKTsNCiAgICAgICAgcmV0dXJuIHVybDsNCiAgICB9DQp9DQovL+WkhOeQhnRy5a+56LGhDQpmdW5jdGlvbiBDaHVMaVRyT2JqQXJydERhdGFUYWJsZVBhZ2UoaWQpIHsNCiAgICB2YXIgdHJPYmogPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkucGFyZW50Tm9kZTsNCiAgICB2YXIgaW5kZXhRWiA9IDA7DQogICAgdmFyIGluZGV4UVpKID0gdHJPYmouZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRkIikubGVuZ3RoOw0KICAgIGlmIChDaGVja0FsbENoYW5nZSA9PSBudWxsKSB7DQogICAgICAgIC8v5LuOMOW8gOWni+WPlg0KICAgICAgICBpbmRleFFaID0gMDsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvL+S7jjHlvIDlp4vlj5YNCiAgICAgICAgaW5kZXhRWiA9IDE7DQogICAgfQ0KICAgIGlmICgoVXBkYXRlQnV0Q2xpY2sgPT0gbnVsbCB8fCBVcGRhdGVCdXRDbGljayA9PSB1bmRlZmluZWQpICYmIChEZWxldGVJdGVtU3RhdGUgPT0gbnVsbCB8fCBEZWxldGVJdGVtU3RhdGUgPT0gdW5kZWZpbmVkKSkgew0KICAgICAgICAvL+WPluWAvOWIsOacgOWQjg0KICAgIH0gZWxzZSB7DQogICAgICAgIC8v5pyA5ZCO5LiA5YiX5LiN5Y+WDQogICAgICAgIGluZGV4UVpKID0gaW5kZXhRWkogLSAxOw0KICAgIH0NCiAgICB2YXIgT2JqVHh0ID0gbmV3IEFycmF5KCk7DQogICAgZm9yICh2YXIgaSA9IGluZGV4UVo7IGkgPCBpbmRleFFaSjsgaSsrKSB7DQogICAgICAgIE9ialR4dC5wdXNoKHRyT2JqLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ZCIpW2ldLmlubmVySFRNTCk7DQogICAgfQ0KICAgIHJldHVybiBPYmpUeHQ7DQp9";
        private string JavaScriptBase64UTF8 = "LyoNCuWPguaVsOivtOaYjg0K5L2/55So5YmN5Yib5bu6RGF0YVRhYmxlT2JqKCnlr7nosaENCuiwg+eUqOWIneWni+WMluWHveaVsFNlbGVjdERhdGFUYWJsZSgi5bGe5oCn5Y+C5pWw55qEanNvbuWtl+espiIsDQoi5Yig6Zmk5ZCO5omA5Zue6LCD55qE5Ye95pWw77yIc3RhdGXvvInov5Tlm57liKDpmaTnmoTnirbmgIF0cnVl5oiQ5YqfZmFsc2XlpLHotKUiICDmnInmraTlh73mlbDliJnmmL7npLrliKDpmaTmjInpkq7msqHmnInliJnlvbHol48NCiwi5L+u5pS55oyJ6ZKu55qE5Zue6LCD5Ye95pWw77yIa2V577yJ6L+U5Zue57uR5a6a55qEa2V5Iikg5pyJ5q2k5Ye95pWw5YiZ5pi+56S65L+u5pS55oyJ6ZKu5rKh5pyJ5YiZ5b2x6JePDQosIuWFqOmAieWkmumAieinpuWPkeS6i+S7tu+8iGtleUxpc3TvvInlpoLmnpzlhajpgInliJnov5Tlm57pgInkuK3nmoRrZXnliJfooagiIOacieatpOWHveaVsOWImeaYvuekuuWkmumAieaMiemSruayoeacieWImeW9seiXjw0KLCLmr4/kuIDpobnmlbDmja7nmoTlpJrpgInmjInpkq7op6blj5HnmoTkuovku7YoY2hlY2tvYmop6L+U5Zue54K55Lit55qEY2hlY2vmoIfnrb4iDQoqLw0KDQoNCg0KLy/liJvlu7rnsbsNCmZ1bmN0aW9uIERhdGFUYWJsZU9iaigpIHsNCiAgICB0aGlzLlBvc3JVcmxUeHQgPSAiIjsNCiAgICB0aGlzLkdldERhdGFUYWJsZUJ5V2hlcmUgPSAiIjsNCiAgICB0aGlzLkRhdGFUYWJsZURpdklkID0gIiI7DQogICAgdGhpcy5QYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMgPSAwOw0KICAgIHZhciBEYXRhUGFnZUNvdW50ID0gMDsNCiAgICB0aGlzLlBhZ2VTaG93QnV0Q291bnQgPSA3Ow0KICAgIC8v5a6a5LmJ55qE5bGe5oCnDQogICAgdGhpcy5EZWxldGVCdXROYW1lID0gIuWIoOmZpCI7DQogICAgdGhpcy5VcGRhdGVCdXROYW1lID0gIuS/ruaUuSI7DQogICAgdGhpcy5DaGVja0lzVHJ1ZVR4dCA9ICLlj43pgIkiOw0KICAgIHRoaXMuQ2hlY2tJc0ZhbHNlVHh0ID0gIuWFqOmAiSI7DQogICAgdGhpcy5DaGVja0l0ZW1UeHQgPSAiIjsNCiAgICB0aGlzLkRlbGV0ZU9yVXBkYXRlVGl0bGUgPSAi5pON5L2cIjsNCiAgICB0aGlzLkxvZ2luRGl2Q2xhc3NOYW1lID0gIiI7DQogICAgdGhpcy5Mb2dpbkRpdlR4dCA9ICLmraPlnKjor7fmsYIuLi4iOyAvL+aPkOekuuihjOaWh+Wtlw0KICAgIHRoaXMuRGVsZXRlU2hvd1R4dCA9ICLkvaDnoa7lrpropoHliKDpmaTor6XpobnmlbDmja7lkJfvvJ8iOw0KICAgIHRoaXMuUGFnZUluZGV4VG9vbCA9IGZhbHNlOw0KICAgIC8v5a6a5LmJ55qE5Ye95pWwDQogICAgdGhpcy5VcGRhdGVCdXRDbGljazsNCiAgICB0aGlzLkRlbGV0ZUl0ZW1TdGF0ZTsNCiAgICB0aGlzLlBvc3RTdGFydDsNCiAgICB0aGlzLlBvc3RTdG9wOw0KICAgIHRoaXMuQ2hlY2tBbGxDaGFuZ2U7DQogICAgdGhpcy5DaGVja0l0ZW1DaGFuZ2U7DQogICAgLy/lm57osIMNCiAgICB0aGlzLkNhbGxiYWNrOw0KICAgIHZhciBQb3N0UmVxdWVzdCA9IGZ1bmN0aW9uIChQb3N0VXJsLCBGb3JtU3RyaW5nKSB7DQogICAgICAgIC8v5byA5aeL6K+35rGCDQogICAgICAgIFBvc3RTdGFydCgpOw0KICAgICAgICB2YXIgeG1sSHR0cDsNCiAgICAgICAgaWYgKHdpbmRvdy5BY3RpdmVYT2JqZWN0KSB7DQogICAgICAgICAgICB4bWxIdHRwID0gbmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIik7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSBpZiAod2luZG93LlhNTEh0dHBSZXF1ZXN0KSB7DQogICAgICAgICAgICB4bWxIdHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7DQogICAgICAgIH0NCiAgICAgICAgeG1sSHR0cC5vcGVuKCJQb3N0IiwgUG9zdFVybCwgdHJ1ZSk7DQogICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgaWYgKHhtbEh0dHAucmVhZHlTdGF0ZSA9PSA0ICYmIHhtbEh0dHAuc3RhdHVzID09IDIwMCkgew0KICAgICAgICAgICAgICAgIFBvc3RTdG9wKCk7DQogICAgICAgICAgICAgICAgLy/ov5Tlm57lgLznmoTliKTmlq0NCiAgICAgICAgICAgICAgICB2YXIgSnNvbk1vZGVsRGF0YVRhYmxlID0gZXZhbCgiKCIgKyB4bWxIdHRwLnJlc3BvbnNlVGV4dCArICIpIik7DQogICAgICAgICAgICAgICAgLy/lj5blvpfov5Tlm57lgLznmoTlsZ7mgKcNCiAgICAgICAgICAgICAgICBpZiAoSnNvbk1vZGVsRGF0YVRhYmxlICE9IG51bGwgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlICE9IHVuZGVmaW5lZCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgIT0gbnVsbCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgPT0gIjQwNCIpIHsNCiAgICAgICAgICAgICAgICAgICAgQ1pTaG93VHh0RGl2KCLor7fmsYLlpLHotKXvvIEiKTsNCiAgICAgICAgICAgICAgICAgICAgLy/miafooYzlm57osIPlh73mlbAo6K+35rGC5aSx6LSl77yBKQ0KICAgICAgICAgICAgICAgICAgICBpZiAoQ2FsbGJhY2sgIT0gdW5kZWZpbmVkICYmIENhbGxiYWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIENhbGxiYWNrKCIxIiwgZmFsc2UsIEpzb25Nb2RlbERhdGFUYWJsZS5NYWcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEpzb25Nb2RlbERhdGFUYWJsZSAhPSBudWxsICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSAhPSB1bmRlZmluZWQgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlICE9IG51bGwgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlID09ICIyMTEiKSB7DQogICAgICAgICAgICAgICAgICAgIC8v5omn6KGM5Zue6LCD5Ye95pWwKOWIoOmZpOaIkOWKn++8gSkNCiAgICAgICAgICAgICAgICAgICAgaWYgKENhbGxiYWNrICE9IHVuZGVmaW5lZCAmJiBDYWxsYmFjayAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBDYWxsYmFjaygiMiIsIHRydWUsIEpzb25Nb2RlbERhdGFUYWJsZS5NYWcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8v5Yig6Zmk5oiQ5Yqf5Yi35pawDQogICAgICAgICAgICAgICAgICAgIGlmIChEZWxldGVJdGVtU3RhdGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgRGVsZXRlSXRlbVN0YXRlKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8vL0NaU2hvd1R4dERpdigi5q2j5Zyo5Yi35pawLi4uIik7DQogICAgICAgICAgICAgICAgICAgIC8v5Yik5pat5pWw5o2u5pyJ5aSa5bCR5p2hDQogICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChEYXRhVGFibGVEaXZJZCkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRyIikubGVuZ3RoID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v6KGo56S65rKh5pyJ5pWw5o2u5LqGDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHBhcnNlSW50KFBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcykgLSAxKSA+IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/liLfmlrDlh73mlbDmr5TovoPnibnmrooNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3N0UmVxdWVzdChQb3NyVXJsVHh0LCBHZXRQb3N0UGFyYW1ldGVyc1RvUmVmcmVzaChwYXJzZUludChQYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMpIC0gMSwgR2V0RGF0YVRhYmxlQnlXaGVyZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy/liLfmlrDmlbDmja4NCiAgICAgICAgICAgICAgICAgICAgICAgIFBvc3RSZXF1ZXN0KFBvc3JVcmxUeHQsIEdldFBvc3RQYXJhbWV0ZXJzVG9SZWZyZXNoKFBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcywgR2V0RGF0YVRhYmxlQnlXaGVyZSkpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEpzb25Nb2RlbERhdGFUYWJsZSAhPSBudWxsICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSAhPSB1bmRlZmluZWQgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlICE9IG51bGwgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlID09ICIxMTIiKSB7DQogICAgICAgICAgICAgICAgICAgIC8v5omn6KGM5Zue6LCD5Ye95pWwKOWIoOmZpOWksei0pe+8gSkNCiAgICAgICAgICAgICAgICAgICAgaWYgKENhbGxiYWNrICE9IHVuZGVmaW5lZCAmJiBDYWxsYmFjayAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBDYWxsYmFjaygiMiIsIGZhbHNlLCBKc29uTW9kZWxEYXRhVGFibGUuTWFnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvL+WIoOmZpOWksei0pe+8gQ0KICAgICAgICAgICAgICAgICAgICBpZiAoRGVsZXRlSXRlbVN0YXRlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIERlbGV0ZUl0ZW1TdGF0ZShmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgU2hvd1R4dERpdihMb2dpbkRpdlR4dCk7DQogICAgICAgICAgICAgICAgICAgIC8v5Yi35paw5pWw5o2uDQogICAgICAgICAgICAgICAgICAgIFBvc3RSZXF1ZXN0KFBvc3JVcmxUeHQsIEdldFBvc3RQYXJhbWV0ZXJzVG9SZWZyZXNoKFBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcywgR2V0RGF0YVRhYmxlQnlXaGVyZSkpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChKc29uTW9kZWxEYXRhVGFibGUgIT0gbnVsbCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgIT0gdW5kZWZpbmVkICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSAhPSBudWxsICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSA9PSAiMjIyIikgew0KICAgICAgICAgICAgICAgICAgICAvL+ivu+WPluaVsOaNruaIkOWKn++8gQ0KICAgICAgICAgICAgICAgICAgICAvL+aJp+ihjOWbnuiwg+WHveaVsCjor7vlj5bmiJDlip/vvIEpDQogICAgICAgICAgICAgICAgICAgIGlmIChDYWxsYmFjayAhPSB1bmRlZmluZWQgJiYgQ2FsbGJhY2sgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgQ2FsbGJhY2soIjEiLCB0cnVlLCBKc29uTW9kZWxEYXRhVGFibGUuTWFnKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvL+aAu+mhteaVsA0KICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YUNvdW50ID0gSnNvbk1vZGVsRGF0YVRhYmxlLmRhdGFDb3VudDsNCiAgICAgICAgICAgICAgICAgICAgLy/mr4/pobXmmL7npLrnmoTmnaHmlbANCiAgICAgICAgICAgICAgICAgICAgdmFyIFBhZ2VTaXplID0gSnNvbk1vZGVsRGF0YVRhYmxlLlBhZ2VTaXplOw0KICAgICAgICAgICAgICAgICAgICAvL+W9k+WJjemhteeahOe0ouW8lQ0KICAgICAgICAgICAgICAgICAgICB2YXIgUGFnZUluZGV4ID0gSnNvbk1vZGVsRGF0YVRhYmxlLlBhZ2VJbmRleDsNCiAgICAgICAgICAgICAgICAgICAgUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzID0gUGFnZUluZGV4Ow0KICAgICAgICAgICAgICAgICAgICAvL+iOt+WPluWIoOmZpOeahGtleeaWueW8jw0KICAgICAgICAgICAgICAgICAgICB2YXIgV2hlcmVLZXkgPSBKc29uTW9kZWxEYXRhVGFibGUuV2hlcmVLZXk7DQogICAgICAgICAgICAgICAgICAgIC8v5YiX5aS06ZSu55qE6ZuG5ZCIDQogICAgICAgICAgICAgICAgICAgIHZhciBUYWJsZVRpdGxlID0gbmV3IEFycmF5KCk7DQogICAgICAgICAgICAgICAgICAgIC8v5a2Y5pS+5YiX55qE5pi+56S654q25oCBDQogICAgICAgICAgICAgICAgICAgIHZhciBTaG93SGlkTGlzdCA9IG5ldyBBcnJheSgpOw0KICAgICAgICAgICAgICAgICAgICAvL+ihqOaVsOaNrumbhuWQiA0KICAgICAgICAgICAgICAgICAgICB2YXIgRGF0YVRhYmxlT2JqID0gbmV3IEFycmF5KCk7DQogICAgICAgICAgICAgICAgICAgIC8v5Yib5bu656ys5LiA6KGM5a2Y5pS+6KGo5aS0DQogICAgICAgICAgICAgICAgICAgIERhdGFUYWJsZU9ialswXSA9IG5ldyBBcnJheSgpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpdGVtIGluIEpzb25Nb2RlbERhdGFUYWJsZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBKc29uTW9kZWxEYXRhVGFibGVbaXRlbV0gPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/ov5Tlm57lgLznmoTlsZ7mgKfljIXlkKvmlbDmja7mnInlpJrlsJENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KCLplK4iICsgaXRlbSArICLnmoTlgLw9IiArIEpzb25Nb2RlbERhdGFUYWJsZVtpdGVtXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBKc29uTW9kZWxEYXRhVGFibGVbaXRlbV0gPT09ICdvYmplY3QnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIERhdGFMaXN0ID0gSnNvbk1vZGVsRGF0YVRhYmxlW2l0ZW1dOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09ICJ0aXRsZSIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lsIbllK/kuIDplK7mlL7liLAw5YiXDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRhYmxlVGl0bGVbMF0gPSBXaGVyZUtleTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/liJvlu7rooajlpLQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIFRpdGxlS2V5SW5kZXggPSAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBUaXRsZU9iaiBpbiBEYXRhTGlzdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBEYXRhTGlzdFtUaXRsZU9ial0gPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lsIbliJflpLTmiYDnu5HlrprnmoTlgLzmlL7liLDmlbDnu4TvvIzmlrnkvr/lj5bmlbDmja4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWJsZVRpdGxlW1RpdGxlS2V5SW5kZXhdID0gRGF0YUxpc3RbVGl0bGVPYmpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Yid5aeL5YyW5pW05Liq6KGo57uT5p6E77yI5YiX77yJDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YVRhYmxlT2JqWzBdW1RpdGxlS2V5SW5kZXhdID0gVGl0bGVPYmo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGl0bGVLZXlJbmRleCA9IFRpdGxlS2V5SW5kZXggKyAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtID09ICJTaG93U3RhdGUiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5a2Y5pS+5pi+56S654q25oCB55qE5pWw57uEDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dIaWRMaXN0ID0gRGF0YUxpc3Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtID09ICJkYXRhIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IERhdGFMaXN0Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgSXRlbURhdGEgPSBEYXRhTGlzdFtpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Yib5bu66KGMaeS4uuihjOeahOe0ouW8lee0ouW8leS7jjHlvIDlp4vlm6DkuLow5Li66KGo5aS0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhVGFibGVPYmpbaSArIDFdID0gbmV3IEFycmF5KCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBJdGVtRGF0YU9iaiBpbiBJdGVtRGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5YiXDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBJdGVtRGF0YVtJdGVtRGF0YU9ial0gPT09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChUYWJsZVRpdGxlWzBdICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChJdGVtRGF0YU9iaiA9PSBUYWJsZVRpdGxlWzBdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YVRhYmxlT2JqW2kgKyAxXVswXSA9IEl0ZW1EYXRhW0l0ZW1EYXRhT2JqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB0ID0gMTsgdCA8IFRhYmxlVGl0bGUubGVuZ3RoOyB0KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChJdGVtRGF0YU9iaiA9PSBUYWJsZVRpdGxlW3RdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChJdGVtRGF0YVtJdGVtRGF0YU9ial0gKyAiID09IiArIFRhYmxlVGl0bGVbdF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5ZCR6KGo5Lit5re75Yqg5pWw5o2uW+ihjF1b5YiXXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGFUYWJsZU9ialtpICsgMV1bdF0gPSBJdGVtRGF0YVtJdGVtRGF0YU9ial07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WIm+W7uuihqOe7k+aehA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcmVhdGVUYWJsZUh0bWwoRGF0YVRhYmxlT2JqLCBXaGVyZUtleSwgU2hvd0hpZExpc3QpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WIm+W7uuWIhumhteiPnOWNlQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcmVhdGVUYWJsZVBhZ2VIdG1sKFBhZ2VTaXplLCBkYXRhQ291bnQsIFBhZ2VJbmRleCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgLy/liKTmlq3nmoTnu5PlsL4NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH07DQogICAgICAgIHhtbEh0dHAuc2VuZChGb3JtU3RyaW5nKTsNCiAgICB9DQogICAgLy/liJvlu7rooajnu5PmnoQgIOWPluWAvOS4ulvooYxdW+WIl10gICAgIOivpemhueaVsOaNrueahOWUr+S4gOagh+ivhg0KICAgIHZhciBDcmVhdGVUYWJsZUh0bWwgPSBmdW5jdGlvbiAoRGF0YUxpc3QsIGtleSwgU2hvd0hpZExpc3QpIHsNCiAgICAgICAgdmFyIFRhYmxlSHRtbCA9ICI8dGFibGUgY2xhc3M9J1RhYmxlUGFnaW5nQm9keScgYm9yZGVyPScwJyBjZWxsc3BhY2luZz0nMCcgY2VsbHBhZGRpbmc9JzAnPiI7DQogICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgRGF0YUxpc3QubGVuZ3RoOyB5KyspIHsNCiAgICAgICAgICAgIC8v6KGM5byA5aeL5Yib5bu6DQogICAgICAgICAgICBpZiAoeSA9PSAxKSB7DQogICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGJvZHk+PHRyIGNsYXNzPSdUYWJsZVBhZ2luZ1RSIFRSXyIgKyB5ICsgIic+IjsNCg0KICAgICAgICAgICAgfSBlbHNlIGlmICh5ID09IDApIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0aGVhZD48dHIgY2xhc3M9J1RhYmxlUGFnaW5nVFIgVFJfIiArIHkgKyAiJz4iOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0ciBjbGFzcz0nVGFibGVQYWdpbmdUUiBUUl8iICsgeSArICInPiI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgS2V5Ow0KICAgICAgICAgICAgZm9yICh2YXIgeCA9IDE7IHggPCBEYXRhTGlzdFt5XS5sZW5ndGg7IHgrKykgew0KICAgICAgICAgICAgICAgIC8v5Y+W5b6XS2V555qE5a6e6ZmF5YC8DQogICAgICAgICAgICAgICAgS2V5ID0gRGF0YUxpc3RbeV1bMF07DQogICAgICAgICAgICAgICAgLy/liJcNCiAgICAgICAgICAgICAgICAvL+W8gOWni+WIm+W7uuWIlw0KICAgICAgICAgICAgICAgIGlmICh5ID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKENoZWNrQWxsQ2hhbmdlICE9IG51bGwgJiYgeCA9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0aCBjbGFzcz0nVGFibGVQYWdpbmdDaGVjaycgPjxpbnB1dCBvbmNoYW5nZT0nbmV3IERhdGFUYWJsZU9iaigpLkNoZWNrQWxsQ2hhbmdlT2JqVG9EYXRhVGFibGUodGhpcyknIHR5cGU9XCJjaGVja2JveFwiIC8+PHNwYW4+IiArIENoZWNrSXNGYWxzZVR4dCArICI8L3NwYW4+PC90aD48dGggY2xhc3M9J1RhYmxlUGFnaW5nVEggVEhfIiArIHggKyAiJz4iICsgRGF0YUxpc3RbeV1beF0gKyAiPC90aD4iOw0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4KyJ8IitTaG93SGlkTGlzdFt4LTFdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v5YiX5aS0DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoU2hvd0hpZExpc3RbeCAtIDFdID09ICJTaG93Iikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRhYmxlSHRtbCArPSAiPHRoIGNsYXNzPSdUYWJsZVBhZ2luZ1RIIFRIXyIgKyB4ICsgIic+IiArIERhdGFMaXN0W3ldW3hdICsgIjwvdGg+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGggY2xhc3M9J1RhYmxlUGFnaW5nVEggVEhfIiArIHggKyAiJyBzdHlsZT0nZGlzcGxheTpub25lOyc+IiArIERhdGFMaXN0W3ldW3hdICsgIjwvdGg+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChDaGVja0FsbENoYW5nZSAhPSBudWxsICYmIHggPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKENoZWNrSXRlbUNoYW5nZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGQgY2xhc3M9J1RhYmxlUGFnaW5nQ2hlY2snPjxpbnB1dCBuYW1lPSdEYXRhVGFibGVJdGVtQ2hlY2snIHZhbHVlPSciICsgS2V5ICsgIicgb25jaGFuZ2U9XCJuZXcgRGF0YVRhYmxlT2JqKCkuQ2hlY2tJdGVtQ2hhbmdlT2JqVG9EYXRhVGFibGUodGhpcylcIiB0eXBlPVwiY2hlY2tib3hcIiAvPiIgKyBDaGVja0l0ZW1UeHQgKyAiPC90ZD48dGQgY2xhc3M9J1RhYmxlUGFnaW5nVEQgVERfIiArIHggKyAiJz4iICsgRGF0YUxpc3RbeV1beF0gKyAiPC90ZD4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0ZCBjbGFzcz0nVGFibGVQYWdpbmdDaGVjayc+PGlucHV0IG5hbWU9J0RhdGFUYWJsZUl0ZW1DaGVjaycgdmFsdWU9JyIgKyBLZXkgKyAiJyB0eXBlPVwiY2hlY2tib3hcIiAvPjwvdGQ+PHRkIGNsYXNzPSdUYWJsZVBhZ2luZ1REIFREXyIgKyB4ICsgIic+IiArIERhdGFMaXN0W3ldW3hdICsgIjwvdGQ+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTaG93SGlkTGlzdFt4IC0gMV0gPT0gIlNob3ciKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGQgY2xhc3M9J1RhYmxlUGFnaW5nVEQgVERfIiArIHggKyAiJz4iICsgRGF0YUxpc3RbeV1beF0gKyAiPC90ZD4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0ZCBjbGFzcz0nVGFibGVQYWdpbmdURCBURF8iICsgeCArICInIHN0eWxlPSdkaXNwbGF5Om5vbmU7Jz4iICsgRGF0YUxpc3RbeV1beF0gKyAiPC90ZD4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8v57uT5p2f5Yib5bu6DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoeSAhPSAwKSB7DQoNCiAgICAgICAgICAgICAgICAvL+S7juaVsOaNruW8gOWni+iOt+WPlmtleQ0KICAgICAgICAgICAgICAgIC8v5Y+W5b6XS2V555qE5a6e6ZmF5YC8DQogICAgICAgICAgICAgICAgS2V5ID0gRGF0YUxpc3RbeV1bMF07DQogICAgICAgICAgICAgICAgaWYgKERlbGV0ZUl0ZW1TdGF0ZSAhPSBudWxsIHx8IFVwZGF0ZUJ1dENsaWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGQgY2xhc3M9J1RhYmxlUGFnaW5nVEQgVG9vbCcgaWQ9J0RhdGFUYWJsZVBhZ2VfVXNlcl9MYW5TUV8iICsgS2V5ICsgIicgPiI7DQogICAgICAgICAgICAgICAgICAgIGlmIChEZWxldGVJdGVtU3RhdGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8YSBjbGFzcz0nVGFibGVQYWdpbmdURCBUb29sIERlbGV0ZScgaHJlZj1cImphdmFzY3JpcHQ6bmV3IERhdGFUYWJsZU9iaigpLkRhdGFUYWJsZURlbGV0ZUJ5S2V5KCciICsgS2V5ICsgIicpXCI+IiArIERlbGV0ZUJ1dE5hbWUgKyAiPC9hPiI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKFVwZGF0ZUJ1dENsaWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIFRhYmxlSHRtbCArPSAiPGEgY2xhc3M9J1RhYmxlUGFnaW5nVEQgVG9vbCBVcGRhdGUnIGhyZWY9XCJqYXZhc2NyaXB0OlVwZGF0ZUJ1dENsaWNrKCciICsgS2V5ICsgIicsQ2h1TGlUck9iakFycnREYXRhVGFibGVQYWdlKCdEYXRhVGFibGVQYWdlX1VzZXJfTGFuU1FfIiArIEtleSArICInKSlcIj4iICsgVXBkYXRlQnV0TmFtZSArICI8L2E+IjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjwvdGQ+IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8v5Yib5bu65Yig6Zmk5YiX5aS05oiW5L+u5pS55YiX5aS0DQogICAgICAgICAgICAgICAgaWYgKERlbGV0ZUl0ZW1TdGF0ZSAhPSBudWxsIHx8IFVwZGF0ZUJ1dENsaWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGggY2xhc3M9J1RhYmxlUGFnaW5nVEggVG9vbCc+IiArIERlbGV0ZU9yVXBkYXRlVGl0bGUgKyAiPC90aD4iOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8v6KGM5byA5aeL5Yib5bu657uT5p2fDQoNCiAgICAgICAgICAgIGlmICh5ID09IDApIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjwvdHI+PC90aGVhZD4iOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjwvdHI+IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIFRhYmxlSHRtbCArPSAiPC90Ym9keT48L3RhYmxlPiI7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5pbm5lckhUTUwgPSBUYWJsZUh0bWw7DQogICAgfQ0KICAgIC8v5Yib5bu65YiG6aG16I+c5Y2VDQogICAgdmFyIENyZWF0ZVRhYmxlUGFnZUh0bWwgPSBmdW5jdGlvbiAoUGFnZVNpemUsIGRhdGFDb3VudCwgUGFnZUluZGV4KSB7DQogICAgICAgIC8v5pi+56S65YiG6aG15oyJ6ZKu55qE5Liq5pWwDQogICAgICAgIHZhciBQYWdlSW5kZXhCdXRDb3VudCA9IFBhZ2VTaG93QnV0Q291bnQ7DQogICAgICAgIC8v5oC76aG15pWwDQogICAgICAgIHZhciBQYWdlQ291bnQgPSAwOw0KICAgICAgICBpZiAoKGRhdGFDb3VudCAlIFBhZ2VTaXplKSA9PSAwKSB7DQogICAgICAgICAgICBQYWdlQ291bnQgPSBwYXJzZUludChkYXRhQ291bnQgLyBQYWdlU2l6ZSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBQYWdlQ291bnQgPSBwYXJzZUludChkYXRhQ291bnQgLyBQYWdlU2l6ZSkgKyAxOw0KICAgICAgICB9DQogICAgICAgIC8v5a2Y5YKo5YWo5bGA5Y+Y6YeP5oC76aG15pWwDQogICAgICAgIERhdGFQYWdlQ291bnQgPSBQYWdlQ291bnQ7DQogICAgICAgIHZhciBTaG93TWFuYWdlclR4dCA9IFBhZ2VDb3VudDsNCiAgICAgICAgaWYgKFBhZ2VDb3VudCA9PSAwKSB7DQogICAgICAgICAgICBTaG93TWFuYWdlclR4dCA9ICLml6DmlbDmja4iOw0KICAgICAgICB9DQogICAgICAgIHZhciBQYWdlVHh0SHRtbCA9ICI8ZGl2IGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgU2hvd01hbmFnZXInPjxzcGFuIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgIFBhZ2VUeHQnPuW9k+WJje+8miIgKyAocGFyc2VJbnQoUGFnZUluZGV4KSArIDEpICsgIi8iICsgU2hvd01hbmFnZXJUeHQgKyAiPC9zcGFuPiI7DQogICAgICAgIHZhciBVcEluZGV4ID0gIjxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBQYWdlSG9tZScgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KDAsMCwiICsgUGFnZUNvdW50ICsgIiknID7pppbpobU8L2E+IjsNCiAgICAgICAgdmFyIERvd0luZGV4ID0gIjxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBQYWdlRW5kJyBocmVmPSdqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoIiArIChwYXJzZUludChQYWdlQ291bnQpIC0gMSkgKyAiLDAsIiArIFBhZ2VDb3VudCArICIpJyA+5bC+6aG1PC9hPiI7DQogICAgICAgIHZhciBOZXh0UGFnZUluZGV4ID0gIjxsYWJlbCBjbGFzcz0nUGFnZUp1bXBUeHQnPui3s+i9rDxzZWxlY3QgY2xhc3M9J1BhZ2VKdW1wJyBvbmNoYW5nZT1cIm5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQodGhpcy52YWx1ZSwwLCIgKyBQYWdlQ291bnQgKyAiKVwiPiI7DQogICAgICAgIC8v5Yik5pat5piv5ZCm5byA5ZCvDQogICAgICAgIGlmICghUGFnZUluZGV4VG9vbCkgew0KICAgICAgICAgICAgVXBJbmRleCA9ICIiOw0KICAgICAgICAgICAgRG93SW5kZXggPSAiIjsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgUGFnZUJ1dEh0bWwgPSAiPGRpdiBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2xEaXYnPiIgKyBVcEluZGV4ICsgIjxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBVcCcgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KCIgKyBwYXJzZUludChQYWdlSW5kZXgpICsgIiwxLCIgKyBQYWdlQ291bnQgKyAiKScgPuS4iuS4gOmhtTwvYT4iOw0KICAgICAgICB2YXIgQ291bnRQYWdlQnV0ID0gMDsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBQYWdlQ291bnQ7IGkrKykgew0KICAgICAgICAgICAgLy/ot7PovazpobUNCiAgICAgICAgICAgIGlmIChwYXJzZUludChQYWdlSW5kZXgpID09IGkpIHsNCiAgICAgICAgICAgICAgICBOZXh0UGFnZUluZGV4ICs9ICI8b3B0aW9uIHNlbGVjdGVkPSdzZWxlY3RlZCcgdmFsdWU9XCIiICsgaSArICJcIj4iICsgKGkgKyAxKSArICI8L29wdGlvbj4iOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBOZXh0UGFnZUluZGV4ICs9ICI8b3B0aW9uIHZhbHVlPVwiIiArIGkgKyAiXCI+IiArIChpICsgMSkgKyAiPC9vcHRpb24+IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IFBhZ2VDb3VudDsgaSsrKSB7DQogICAgICAgICAgICAvL+WIhumhtee8qei/m+eul+azlemhteaVsOWwj+S6jjcNCiAgICAgICAgICAgIGlmIChQYWdlQ291bnQgPD0gUGFnZUluZGV4QnV0Q291bnQpIHsNCiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQoUGFnZUluZGV4KSA9PSBpKSB7DQogICAgICAgICAgICAgICAgICAgIFBhZ2VCdXRIdG1sICs9ICIgPGVtIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbFR4dCc+IiArIChpICsgMSkgKyAiPC9lbT4iOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIFBhZ2VCdXRIdG1sICs9ICIgPGEgY2xhc3M9J1RhYmxlUGFnaW5nUGFnZURpdiBUb29sIFRvb2xCdXR0b24nIGhyZWY9J2phdmFzY3JpcHQ6bmV3IERhdGFUYWJsZU9iaigpLlBhZ2VJbmRleEJ1dCgiICsgaSArICIsMCwiICsgUGFnZUNvdW50ICsgIiknID4iICsgKGkgKyAxKSArICI8L2E+IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8v5b2T6aG15pWw5aSn5LqONw0KICAgICAgICAgICAgICAgIC8vaWYgKGkgPCBQYWdlSW5kZXhCdXRDb3VudCkgew0KICAgICAgICAgICAgICAgIHZhciBpdCA9IHBhcnNlSW50KHBhcnNlSW50KFBhZ2VJbmRleCkgLyBQYWdlSW5kZXhCdXRDb3VudCk7DQogICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KFBhZ2VJbmRleCkgPiBwYXJzZUludChQYWdlSW5kZXhCdXRDb3VudCAvIDIpKSB7DQogICAgICAgICAgICAgICAgICAgIC8v5b2T6YCJ5oup55qE6aG15pWw6LaF6L+H5LiA5Y2K55qE5pe25YCZDQogICAgICAgICAgICAgICAgICAgIGlmIChpID49IHBhcnNlSW50KFBhZ2VJbmRleCAtIChwYXJzZUludChQYWdlSW5kZXhCdXRDb3VudCAvIDIpKSkgJiYgKFBhZ2VDb3VudCAtIHBhcnNlSW50KFBhZ2VJbmRleCkpID4gcGFyc2VJbnQoUGFnZUluZGV4QnV0Q291bnQgLyAyKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKENvdW50UGFnZUJ1dCA8IFBhZ2VJbmRleEJ1dENvdW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ291bnRQYWdlQnV0Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KFBhZ2VJbmRleCkgPT0gaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxlbSBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2xUeHQnPiIgKyAoaSArIDEpICsgIjwvZW0+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBUb29sQnV0dG9uJyBocmVmPSdqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoIiArIGkgKyAiLDAsIiArIFBhZ2VDb3VudCArICIpJyA+IiArIChpICsgMSkgKyAiPC9hPiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzmmK/liLDmnIDlkI7kuIDnu4QNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoUGFnZUNvdW50IC0gaSkgPCBQYWdlSW5kZXhCdXRDb3VudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAoUGFnZUNvdW50IC0gUGFnZUluZGV4QnV0Q291bnQpOyBpIDwgUGFnZUNvdW50OyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KFBhZ2VJbmRleCkgPT0gaSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIiA8ZW0gY2xhc3M9J1RhYmxlUGFnaW5nUGFnZURpdiBUb29sVHh0Jz4iICsgKGkgKyAxKSArICI8L2VtPiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBUb29sQnV0dG9uJyBocmVmPSdqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoIiArIGkgKyAiLDAsIiArIFBhZ2VDb3VudCArICIpJyAgPiIgKyAoaSArIDEpICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA+PSAocGFyc2VJbnQoUGFnZUluZGV4IC0gKHBhcnNlSW50KFBhZ2VJbmRleEJ1dENvdW50IC8gMikpKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKENvdW50UGFnZUJ1dCA8IFBhZ2VJbmRleEJ1dENvdW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb3VudFBhZ2VCdXQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChQYWdlSW5kZXgpID09IGkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxlbSBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2xUeHQnPiIgKyAoaSArIDEpICsgIjwvZW0+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIiA8YSBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2wgVG9vbEJ1dHRvbicgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KCIgKyBpICsgIiwwLCIgKyBQYWdlQ291bnQgKyAiKScgPiIgKyAoaSArIDEpICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKENvdW50UGFnZUJ1dCA8IFBhZ2VJbmRleEJ1dENvdW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBDb3VudFBhZ2VCdXQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChQYWdlSW5kZXgpID09IGkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxlbSBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2xUeHQnPiIgKyAoaSArIDEpICsgIjwvZW0+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIiA8YSBjbGFzcz0nVGFibGVQYWdpbmdQYWdlRGl2IFRvb2wgVG9vbEJ1dHRvbicgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KCIgKyBpICsgIiwwLCIgKyBQYWdlQ291bnQgKyAiKScgPiIgKyAoaSArIDEpICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8v6Lez6L2s6aG157uT5p2fDQogICAgICAgIE5leHRQYWdlSW5kZXggKz0gIjwvc2VsZWN0PumhtTwvbGFiZWw+IjsNCiAgICAgICAgLy/liKTmlq3mmK/lkKblvIDlkK8NCiAgICAgICAgaWYgKCFQYWdlSW5kZXhUb29sKSB7DQogICAgICAgICAgICBOZXh0UGFnZUluZGV4ID0gIiI7DQogICAgICAgIH0NCiAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIjxhIGNsYXNzPSdUYWJsZVBhZ2luZ1BhZ2VEaXYgVG9vbCBEb3cnICBocmVmPSdqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoIiArIHBhcnNlSW50KFBhZ2VJbmRleCkgKyAiLDIsIiArIFBhZ2VDb3VudCArICIpJyA+5LiL5LiA6aG1PC9hPiIgKyBEb3dJbmRleCArICIiICsgTmV4dFBhZ2VJbmRleCArICI8L2Rpdj4iOw0KICAgICAgICBQYWdlVHh0SHRtbCArPSBQYWdlQnV0SHRtbCArICIiOw0KICAgICAgICAvL2FsZXJ0KERhdGFUYWJsZURpdklkKTsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmlubmVySFRNTCArPSBQYWdlVHh0SHRtbDsNCiAgICB9DQogICAgdGhpcy5QYWdlSW5kZXhCdXQgPSBmdW5jdGlvbiAoUGFnZUluZGV4LCBQYWdlSW5kZXhUeXBlLCBQYWdlQ291bnQpIHsNCiAgICAgICAgdmFyIGluZGV4ID0gMDsNCiAgICAgICAgaWYgKFBhZ2VJbmRleFR5cGUgPT0gMCkgew0KICAgICAgICAgICAgaW5kZXggPSBwYXJzZUludChQYWdlSW5kZXgpOw0KICAgICAgICB9IGVsc2UgaWYgKFBhZ2VJbmRleFR5cGUgPT0gMSkgew0KICAgICAgICAgICAgLy/kuIrkuIDpobUNCiAgICAgICAgICAgIGlmICgoUGFnZUluZGV4IC0gMSkgPj0gMCkgew0KICAgICAgICAgICAgICAgIGluZGV4ID0gKHBhcnNlSW50KFBhZ2VJbmRleCkgLSAxKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaW5kZXggPSBwYXJzZUludChQYWdlSW5kZXgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKFBhZ2VJbmRleFR5cGUgPT0gMikgew0KICAgICAgICAgICAgLy/kuIvkuIDpobUNCiAgICAgICAgICAgIGlmICgocGFyc2VJbnQoUGFnZUluZGV4KSArIDEpIDwgUGFnZUNvdW50KSB7DQogICAgICAgICAgICAgICAgaW5kZXggPSAocGFyc2VJbnQoUGFnZUluZGV4KSArIDEpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpbmRleCA9IHBhcnNlSW50KFBhZ2VJbmRleCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLy/kv53lrZjlvZPliY3kuZ/nmoTntKLlvJUNCiAgICAgICAgUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzID0gaW5kZXg7DQogICAgICAgIFBvc3RSZXF1ZXN0KFBvc3JVcmxUeHQsIEdldFBvc3RQYXJhbWV0ZXJzVG9HZXREYXRhKGluZGV4LCBHZXREYXRhVGFibGVCeVdoZXJlKSk7DQogICAgfQ0KICAgIC8v5p+l6K+i5Y+C5pWw55Sf5oiQDQogICAgdmFyIEdldFBvc3RQYXJhbWV0ZXJzVG9HZXREYXRhID0gZnVuY3Rpb24gKFBhZ2VJbmRleCwgV2hlcmVUeHQpIHsNCiAgICAgICAgcmV0dXJuICJ7XCJQYWdlSW5kZXhcIjoiICsgUGFnZUluZGV4ICsgIixcIldoZXJlVHh0XCI6XCIiICsgV2hlcmVUeHQgKyAiXCIsXCJXaGVyZUtleVwiOlwiXCIsXCJQb3N0VHlwZUZ1blwiOjF9IjsgLy/or7vlj5bmlbDmja4NCiAgICB9DQogICAgLy/liKDpmaTlj4LmlbDnlJ/miJANCiAgICB2YXIgR2V0UG9zdFBhcmFtZXRlcnNUb0RlbGV0ZUl0ZW0gPSBmdW5jdGlvbiAoV2hlcmVLZXkpIHsNCiAgICAgICAgcmV0dXJuICJ7XCJQYWdlSW5kZXhcIjowLFwiV2hlcmVUeHRcIjpcIlwiLFwiV2hlcmVLZXlcIjpcIiIgKyBXaGVyZUtleSArICJcIixcIlBvc3RUeXBlRnVuXCI6MH0iOyAvL+WIoOmZpA0KICAgIH0NCiAgICAvL+WIt+aWsOW9k+WJjemhteWPguaVsOeUn+aIkA0KICAgIHZhciBHZXRQb3N0UGFyYW1ldGVyc1RvUmVmcmVzaCA9IGZ1bmN0aW9uIChQYWdlSW5kZXgsIFdoZXJlVHh0KSB7DQogICAgICAgIHJldHVybiAie1wiUGFnZUluZGV4XCI6IiArIFBhZ2VJbmRleCArICIsXCJXaGVyZVR4dFwiOlwiIiArIFdoZXJlVHh0ICsgIlwiLFwiV2hlcmVLZXlcIjpcIlwiLFwiUG9zdFR5cGVGdW5cIjoyfSI7IC8v5Yi35paw5b2T5YmN6aG1DQogICAgfQ0KICAgIC8v5Yig6Zmk5Ye95pWwDQogICAgdGhpcy5EYXRhVGFibGVEZWxldGVCeUtleSA9IGZ1bmN0aW9uIChLZXkpIHsNCiAgICAgICAgaWYgKEtleSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGFsZXJ0KCLmirHmrYnkvaDmsqHmnInnu5Hlrpror6XpobnmlbDmja7nmoTllK/kuIDplK7vvIzns7vnu5/msqHmnInmnaHku7bov5vooYzliKDpmaQiKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoY29uZmlybShEZWxldGVTaG93VHh0KSkgew0KICAgICAgICAgICAgUG9zdFJlcXVlc3QoUG9zclVybFR4dCwgR2V0UG9zdFBhcmFtZXRlcnNUb0RlbGV0ZUl0ZW0oS2V5KSk7DQogICAgICAgIH0NCiAgICB9DQogICAgLy/plK7nm5jkuovku7YNCiAgICBkb2N1bWVudC5vbmtleXVwID0gZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIga2V5Y29kZSA9IGV2ZW50LndoaWNoIHx8IGV2ZW50LmtleUNvZGU7DQogICAgICAgIGlmIChrZXljb2RlID09IDM3KSB7DQogICAgICAgICAgICAvL+S4iuS4gOmhtQ0KICAgICAgICAgICAgbmV3IERhdGFUYWJsZU9iaigpLlBhZ2VJbmRleEJ1dChQYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMsIDEsIERhdGFQYWdlQ291bnQpOw0KICAgICAgICB9IGVsc2UgaWYgKGtleWNvZGUgPT0gMzkpIHsNCiAgICAgICAgICAgIC8v5LiL5LiA6aG1DQogICAgICAgICAgICBuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KFBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcywgMiwgRGF0YVBhZ2VDb3VudCk7DQogICAgICAgIH0NCiAgICB9DQoNCg0KICAgIHRoaXMuQ2hlY2tBbGxDaGFuZ2VPYmpUb0RhdGFUYWJsZSA9IGZ1bmN0aW9uIChvYmpDaGVjaykgew0KICAgICAgICB2YXIgVmFsTGlzdEtleSA9ICIiOw0KICAgICAgICBpZiAob2JqQ2hlY2suY2hlY2tlZCkgew0KICAgICAgICAgICAgLy/pgInmi6kNCiAgICAgICAgICAgIG9iakNoZWNrLnBhcmVudE5vZGUuY2hpbGRyZW5bMV0uaW5uZXJUZXh0ID0gQ2hlY2tJc1RydWVUeHQ7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJEYXRhVGFibGVJdGVtQ2hlY2siKS5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJEYXRhVGFibGVJdGVtQ2hlY2siKVtpXS5jaGVja2VkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICE9IG51bGwgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICE9ICIiICYmIGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJEYXRhVGFibGVJdGVtQ2hlY2siKVtpXS52YWx1ZSAhPSAib24iKSB7DQogICAgICAgICAgICAgICAgICAgIFZhbExpc3RLZXkgKz0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICsgIiwiOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLmNoZWNrZWQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICE9IG51bGwgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICE9ICIiICYmIGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJEYXRhVGFibGVJdGVtQ2hlY2siKVtpXS52YWx1ZSAhPSAib24iKSB7DQogICAgICAgICAgICAgICAgICAgIFZhbExpc3RLZXkgKz0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICsgIiwiOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG9iakNoZWNrLnBhcmVudE5vZGUuY2hpbGRyZW5bMV0uaW5uZXJUZXh0ID0gQ2hlY2tJc0ZhbHNlVHh0Ow0KICAgICAgICB9DQogICAgICAgIGlmIChWYWxMaXN0S2V5Lmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIFZhbExpc3RLZXkgPSBWYWxMaXN0S2V5LnN1YnN0cmluZygwLCBWYWxMaXN0S2V5Lmxlbmd0aCAtIDEpOw0KICAgICAgICB9DQogICAgICAgIG9iakNoZWNrLnNldEF0dHJpYnV0ZSgidGFnIiwgIntcImNoZWNrZWRcIjpcIiIgKyBvYmpDaGVjay5jaGVja2VkICsgIlwiLFwibGlzdFwiOlwiIiArIFZhbExpc3RLZXkgKyAiXCJ9Iik7DQogICAgICAgIENoZWNrQWxsQ2hhbmdlKCJ7XCJjaGVja2VkXCI6XCIiICsgb2JqQ2hlY2suY2hlY2tlZCArICJcIixcImxpc3RcIjpcIiIgKyBWYWxMaXN0S2V5ICsgIlwifSIpOw0KICAgIH0NCiAgICB0aGlzLkNoZWNrSXRlbUNoYW5nZU9ialRvRGF0YVRhYmxlID0gZnVuY3Rpb24gKG9iaktleSkgew0KICAgICAgICBpZiAoIW9iaktleS5jaGVja2VkKSB7DQogICAgICAgICAgICBvYmpLZXkucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2hpbGRyZW5bMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0IilbMF0uY2hlY2tlZCA9IGZhbHNlOw0KICAgICAgICAgICAgb2JqS2V5LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNoaWxkcmVuWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzcGFuIilbMF0uaW5uZXJUZXh0ID0gIuWFqOmAiSI7DQogICAgICAgIH0NCiAgICAgICAgQ2hlY2tJdGVtQ2hhbmdlKG9iaktleSk7DQogICAgfQ0KICAgIC8vL+iOt+WPluWFqOmAieWQjuaJgOmAieaLqeaVsOaNrueahOWUr+S4gOmUruWAvOeahOWIl+ihqA0KICAgIHRoaXMuR2V0Q2hlY2tBbGxWYWx1ZUxpc3QgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBMaXN0S2V5ID0gIiI7DQogICAgICAgIHZhciBMaXN0Q2hlY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgiRGF0YVRhYmxlSXRlbUNoZWNrIik7IC8vRGF0YVRhYmxlSXRlbUNoZWNrIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGFibGUiKVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaW5wdXQiKTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBMaXN0Q2hlY2subGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGlmIChMaXN0Q2hlY2tbaV0uY2hlY2tlZCkgew0KICAgICAgICAgICAgICAgIExpc3RLZXkgKz0gTGlzdENoZWNrW2ldLnZhbHVlICsgIiwiOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChMaXN0S2V5Lmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIExpc3RLZXkgPSBMaXN0S2V5LnN1YnN0cmluZygwLCBMaXN0S2V5Lmxlbmd0aCAtIDEpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBMaXN0S2V5OyAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChEYXRhVGFibGVEaXZJZCkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRkIilbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0IilbMF0uZ2V0QXR0cmlidXRlKCJ0YWciKTsNCiAgICB9DQoNCiAgICB2YXIgUG9zdFN0YXJ0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAvL2FsZXJ0KCLlvIDlp4vor7fmsYIiKTsNCiAgICAgICAgU2hvd1R4dERpdihMb2dpbkRpdlR4dCk7DQogICAgfQ0KICAgIHZhciBTaG93VHh0RGl2ID0gZnVuY3Rpb24gKHR4dCkgew0KICAgICAgICB2YXIgbG9kaW5nZGl2b2JqID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIjk1ZTYzOGZhMjQzM2U2ODAyYjZkMjgyMDFlMjhiNzNkIik7DQogICAgICAgIGlmIChsb2RpbmdkaXZvYmogIT0gdW5kZWZpbmVkICYmIGxvZGluZ2Rpdm9iaiAhPSBudWxsKSB7DQogICAgICAgICAgICBsb2RpbmdkaXZvYmoucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsb2RpbmdkaXZvYmopOw0KICAgICAgICB9DQogICAgICAgIGlmIChMb2dpbkRpdkNsYXNzTmFtZSAhPSAiIikgew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmlubmVySFRNTCA9ICI8ZGl2IGlkPSc5NWU2MzhmYTI0MzNlNjgwMmI2ZDI4MjAxZTI4YjczZCcgY2xhc3M9JyIgKyBMb2dpbkRpdkNsYXNzTmFtZSArICInPiIgKyB0eHQgKyAiPC9kaXY+IiArIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5pbm5lckhUTUw7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChEYXRhVGFibGVEaXZJZCkuaW5uZXJIVE1MID0gIjxkaXYgaWQ9Jzk1ZTYzOGZhMjQzM2U2ODAyYjZkMjgyMDFlMjhiNzNkJyBzdHlsZT0nd2lkdGg6OTBweDtoZWlnaHQ6MzBweDtvcGFjaXR5OjEuMDtiYWNrZ3JvdW5kLWNvbG9yOiM5OTk5OTk7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDo5MDA7Ym9yZGVyOnNvbGlkIDFweCAjRjBDMzZEO2JhY2tncm91bmQtY29sb3I6I0Y5RURCRTtmb250LXNpemU6MTNweDtjb2xvcjojNjY2O3RleHQtYWxpZ246Y2VudGVyO2xpbmUtaGVpZ2h0OjMwcHg7bWFyZ2luLWxlZnQ6MjUlOyc+IiArIHR4dCArICI8L2Rpdj4iICsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmlubmVySFRNTDsNCiAgICAgICAgfQ0KICAgIH0NCiAgICB2YXIgQ1pTaG93VHh0RGl2ID0gZnVuY3Rpb24gKHR4dCkgew0KICAgICAgICB2YXIgbG9kaW5nZGl2b2JqID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIjk1ZTYzOGZhMjQzM2U2ODAyYjZkMjgyMDFlMjhiNzNkIik7DQogICAgICAgIGlmIChsb2RpbmdkaXZvYmogIT0gdW5kZWZpbmVkICYmIGxvZGluZ2Rpdm9iaiAhPSBudWxsKSB7DQogICAgICAgICAgICBsb2RpbmdkaXZvYmoucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsb2RpbmdkaXZvYmopOw0KICAgICAgICB9DQogICAgICAgIGlmIChMb2dpbkRpdkNsYXNzTmFtZSAhPSAiIikgew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmlubmVySFRNTCA9ICI8ZGl2IGlkPSc5NWU2MzhmYTI0MzNlNjgwMmI2ZDI4MjAxZTI4YjczZCcgY2xhc3M9JyIgKyBMb2dpbkRpdkNsYXNzTmFtZSArICInPiIgKyB0eHQgKyAiPC9kaXY+IjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5pbm5lckhUTUwgPSAiPGRpdiBpZD0nOTVlNjM4ZmEyNDMzZTY4MDJiNmQyODIwMWUyOGI3M2QnIHN0eWxlPSd3aWR0aDo5MHB4O2hlaWdodDozMHB4O29wYWNpdHk6MS4wO2JhY2tncm91bmQtY29sb3I6Izk5OTk5OTtwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjkwMDtib3JkZXI6c29saWQgMXB4ICNGMEMzNkQ7YmFja2dyb3VuZC1jb2xvcjojRjlFREJFO2ZvbnQtc2l6ZToxM3B4O2NvbG9yOiM2NjY7dGV4dC1hbGlnbjpjZW50ZXI7bGluZS1oZWlnaHQ6MzBweDttYXJnaW4tbGVmdDoyNSU7Jz4iICsgdHh0ICsgIjwvZGl2PiI7DQogICAgICAgIH0NCiAgICB9DQogICAgdmFyIFBvc3RTdG9wID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAvL2FsZXJ0KCLor7fmsYLlrozmr5UiKTsNCiAgICB9DQogICAgdGhpcy5VcFN0YXRlUmVmcmVzaCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgUG9zdFJlcXVlc3QoUG9zclVybFR4dCwgR2V0UG9zdFBhcmFtZXRlcnNUb1JlZnJlc2goUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzLCBHZXREYXRhVGFibGVCeVdoZXJlKSk7DQogICAgfQ0KICAgIHRoaXMuU2VsZWN0RGF0YVRhYmxlID0gZnVuY3Rpb24gKGpzb25Nb2RlbCwgX0RlbGV0ZUl0ZW1TdGF0ZSwgX1VwZGF0ZUJ1dENsaWNrLCBfQ2hlY2tBbGxDaGFuZ2UsIF9DaGVja0l0ZW1DaGFuZ2UsIF9DYWxsYmFjaykgew0KICAgICAgICAvL1Nob3dEYXRhVGFibGVEaXZJZCwgR2V0RGF0YVRhYmxlVXJsLCBHZXREYXRhVGFibGVCeVdoZXJlVHh0LCBfVXBkYXRlQnV0Q2xpY2ssIF9EZWxldGVJdGVtU3RhdGUsIF9DaGVja0FsbENoYW5nZSwgX0NoZWNrSXRlbUNoYW5nZQ0KDQogICAgICAgIERhdGFUYWJsZURpdklkID0ganNvbk1vZGVsLlNob3dEYXRhVGFibGVEaXZJZDsNCiAgICAgICAgUG9zclVybFR4dCA9IGpzb25Nb2RlbC5HZXREYXRhVGFibGVVcmw7DQogICAgICAgIEdldERhdGFUYWJsZUJ5V2hlcmUgPSBqc29uTW9kZWwuR2V0RGF0YVRhYmxlQnlXaGVyZVR4dDsNCiAgICAgICAgUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzID0gMDsNCiAgICAgICAgLy9EYXRhUGFnZUNvdW50ID0gMDsNCiAgICAgICAgUGFnZVNob3dCdXRDb3VudCA9IDc7DQogICAgICAgIC8v5Yid5aeL5YyW5Y+C5pWwDQogICAgICAgIERlbGV0ZUJ1dE5hbWUgPSAi5Yig6ZmkIjsNCiAgICAgICAgVXBkYXRlQnV0TmFtZSA9ICLkv67mlLkiOw0KICAgICAgICBDaGVja0lzVHJ1ZVR4dCA9ICLlj43pgIkiOw0KICAgICAgICBDaGVja0lzRmFsc2VUeHQgPSAi5YWo6YCJIjsNCiAgICAgICAgQ2hlY2tJdGVtVHh0ID0gIiI7DQogICAgICAgIERlbGV0ZU9yVXBkYXRlVGl0bGUgPSAi5pON5L2cIjsNCiAgICAgICAgLy/liqDovb3ml7ZkaXbnmoTmoLflvI8NCiAgICAgICAgTG9naW5EaXZDbGFzc05hbWUgPSAiIjsNCiAgICAgICAgLy/liqDovb3ml7ZkaXbnmoTmloflrZcNCiAgICAgICAgTG9naW5EaXZUeHQgPSAi5q2j5Zyo6K+35rGCLi4uIjsgLy/mj5DnpLrooYzmloflrZcNCiAgICAgICAgRGVsZXRlU2hvd1R4dCA9ICLkvaDnoa7lrpropoHliKDpmaTor6XpobnmlbDmja7lkJfvvJ8iOw0KICAgICAgICBQYWdlSW5kZXhUb29sID0gZmFsc2U7DQogICAgICAgIGlmIChqc29uTW9kZWwuUGFnZUluZGV4VG9vbFN0YXRlICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgUGFnZUluZGV4VG9vbCA9IGpzb25Nb2RlbC5QYWdlSW5kZXhUb29sU3RhdGU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5EZWxldGVTaG93VHh0ICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgRGVsZXRlU2hvd1R4dCA9IGpzb25Nb2RlbC5EZWxldGVTaG93VHh0Ow0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuU2hvd0RhdGFUYWJsZURpdklkID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgLy/ojrflj5bmmL7npLrnmoRkaXZpZA0KICAgICAgICAgICAgRGF0YVRhYmxlRGl2SWQgPSAi44CQRGF0YVRhYmxlRGl2SWTjgJEiOw0KICAgICAgICAgICAgaWYgKERhdGFUYWJsZURpdklkID09IHVuZGVmaW5lZCB8fCBEYXRhVGFibGVEaXZJZCA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgYWxlcnQoIuS9oOW/hemhu+aPkOS+m+aYvuekuuaVsOaNrueahGRpdueahElEIik7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuR2V0RGF0YVRhYmxlVXJsID09IHVuZGVmaW5lZCkgey8vZ2V0UG9zdFVybEJ5RGF0YVRhYmxlDQogICAgICAgICAgICAvL+ivt+axgueahOWcsOWdgA0KICAgICAgICAgICAgUG9zclVybFR4dCA9ICLjgJBQb3NyVXJsVHh044CRIjsNCiAgICAgICAgICAgIGlmIChQb3NyVXJsVHh0ID09IHVuZGVmaW5lZCB8fCBQb3NyVXJsVHh0ID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICBhbGVydCgi5L2g6YeH55So55qE5piv6Ieq6YCJ5Zyw5Z2A5L2c5Li66K+35rGC5Zyw5Z2A77yM5L2G5piv5Y+v6IO95Zug5Li65YW85a655oCn6Zeu6aKY5peg5rOV6I635Y+W6K+35rGC5Zyw5Z2A77yM6K+35bCGanPlvJXnlKjku6PnoIHmlL7lhaXpobXpnaLmnIDliY3mlrnjgIIiKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5HZXREYXRhVGFibGVCeVdoZXJlVHh0ID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgR2V0RGF0YVRhYmxlQnlXaGVyZSA9ICIiOw0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzID0gcGFyc2VJbnQoanNvbk1vZGVsLlBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcyk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5QYWdlU2hvd0J1dENvdW50ICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgUGFnZVNob3dCdXRDb3VudCA9IHBhcnNlSW50KGpzb25Nb2RlbC5QYWdlU2hvd0J1dENvdW50KTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoanNvbk1vZGVsLkRlbGV0ZUJ1dEh0bWwgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBEZWxldGVCdXROYW1lID0ganNvbk1vZGVsLkRlbGV0ZUJ1dEh0bWw7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5VcGRhdGVCdXRIdG1sICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgVXBkYXRlQnV0TmFtZSA9IGpzb25Nb2RlbC5VcGRhdGVCdXRIdG1sOw0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuQ2hlY2tJc1RydWVUeHQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBDaGVja0lzVHJ1ZVR4dCA9IGpzb25Nb2RlbC5DaGVja0lzVHJ1ZVR4dDsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoanNvbk1vZGVsLkNoZWNrSXNGYWxzZVR4dCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIENoZWNrSXNGYWxzZVR4dCA9IGpzb25Nb2RlbC5DaGVja0lzRmFsc2VUeHQ7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5DaGVja0l0ZW1UeHQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBDaGVja0l0ZW1UeHQgPSBqc29uTW9kZWwuQ2hlY2tJdGVtVHh0Ow0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuRGVsZXRlT3JVcGRhdGVUaXRsZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIERlbGV0ZU9yVXBkYXRlVGl0bGUgPSBqc29uTW9kZWwuRGVsZXRlT3JVcGRhdGVUaXRsZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoanNvbk1vZGVsLkxvZ2luRGl2Q2xhc3NOYW1lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgTG9naW5EaXZDbGFzc05hbWUgPSBqc29uTW9kZWwuTG9naW5EaXZDbGFzc05hbWU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5Mb2dpbkRpdkh0bWwgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBMb2dpbkRpdlR4dCA9IGpzb25Nb2RlbC5Mb2dpbkRpdkh0bWw7DQogICAgICAgIH0NCiAgICAgICAgLy/liJ3lp4vljJblj4LmlbAgIOaWueazlQ0KICAgICAgICBVcGRhdGVCdXRDbGljayA9IG51bGw7DQogICAgICAgIERlbGV0ZUl0ZW1TdGF0ZSA9IG51bGw7DQogICAgICAgIENoZWNrQWxsQ2hhbmdlID0gbnVsbDsNCiAgICAgICAgQ2hlY2tJdGVtQ2hhbmdlID0gbnVsbDsNCiAgICAgICAgQ2FsbGJhY2sgPSBudWxsOw0KICAgICAgICAvL+S9v+eUqGpzb27mnaXliJ3lp4vljJYNCiAgICAgICAgaWYgKGpzb25Nb2RlbC5VcGRhdGVCdXRDbGljayAhPSB1bmRlZmluZWQgJiYganNvbk1vZGVsLlVwZGF0ZUJ1dENsaWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgIFVwZGF0ZUJ1dENsaWNrID0ganNvbk1vZGVsLlVwZGF0ZUJ1dENsaWNrOw0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuRGVsZXRlSXRlbVN0YXRlICE9IHVuZGVmaW5lZCAmJiBqc29uTW9kZWwuRGVsZXRlSXRlbVN0YXRlICE9IG51bGwpIHsNCiAgICAgICAgICAgIERlbGV0ZUl0ZW1TdGF0ZSA9IGpzb25Nb2RlbC5EZWxldGVJdGVtU3RhdGU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5DaGVja0FsbENoYW5nZSAhPSB1bmRlZmluZWQgJiYganNvbk1vZGVsLkNoZWNrQWxsQ2hhbmdlICE9IG51bGwpIHsNCiAgICAgICAgICAgIENoZWNrQWxsQ2hhbmdlID0ganNvbk1vZGVsLkNoZWNrQWxsQ2hhbmdlOw0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuQ2hlY2tJdGVtQ2hhbmdlICE9IHVuZGVmaW5lZCAmJiBqc29uTW9kZWwuQ2hlY2tJdGVtQ2hhbmdlICE9IG51bGwpIHsNCiAgICAgICAgICAgIENoZWNrSXRlbUNoYW5nZSA9IGpzb25Nb2RlbC5DaGVja0l0ZW1DaGFuZ2U7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5DYWxsYmFjayAhPSB1bmRlZmluZWQgJiYganNvbk1vZGVsLkNhbGxiYWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgIENhbGxiYWNrID0ganNvbk1vZGVsLkNhbGxiYWNrOw0KICAgICAgICB9DQogICAgICAgIC8v5Yik5pat5Yid5aeL5YyW5Y+C5pWwDQogICAgICAgIGlmIChfVXBkYXRlQnV0Q2xpY2sgIT0gdW5kZWZpbmVkICYmIF9VcGRhdGVCdXRDbGljayAhPSBudWxsKSB7DQogICAgICAgICAgICBVcGRhdGVCdXRDbGljayA9IF9VcGRhdGVCdXRDbGljazsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoX0RlbGV0ZUl0ZW1TdGF0ZSAhPSB1bmRlZmluZWQgJiYgX0RlbGV0ZUl0ZW1TdGF0ZSAhPSBudWxsKSB7DQogICAgICAgICAgICBEZWxldGVJdGVtU3RhdGUgPSBfRGVsZXRlSXRlbVN0YXRlOw0KICAgICAgICB9DQogICAgICAgIGlmIChfQ2hlY2tBbGxDaGFuZ2UgIT0gdW5kZWZpbmVkICYmIF9DaGVja0FsbENoYW5nZSAhPSBudWxsKSB7DQogICAgICAgICAgICBDaGVja0FsbENoYW5nZSA9IF9DaGVja0FsbENoYW5nZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoX0NoZWNrSXRlbUNoYW5nZSAhPSB1bmRlZmluZWQgJiYgX0NoZWNrSXRlbUNoYW5nZSAhPSBudWxsKSB7DQogICAgICAgICAgICBDaGVja0l0ZW1DaGFuZ2UgPSBfQ2hlY2tJdGVtQ2hhbmdlOw0KICAgICAgICB9DQogICAgICAgIGlmIChfQ2FsbGJhY2sgIT0gdW5kZWZpbmVkICYmIF9DYWxsYmFjayAhPSBudWxsKSB7DQogICAgICAgICAgICBDYWxsYmFjayA9IF9DYWxsYmFjazsNCiAgICAgICAgfQ0KICAgICAgICAvL2FsZXJ0KENoZWNrQWxsQ2hhbmdlKTsNCiAgICAgICAgUG9zdFJlcXVlc3QoUG9zclVybFR4dCwgR2V0UG9zdFBhcmFtZXRlcnNUb0dldERhdGEoMCwgR2V0RGF0YVRhYmxlQnlXaGVyZSkpOw0KICAgIH0NCn0NCi8v6I635Y+WdXJs55qE5Y+C5pWwDQpmdW5jdGlvbiBnZXRRdWVyeVN0cmluZ0J5RGF0YVRhYmxlKHVybCwgbmFtZSkgew0KICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKCIoXnwmKSIgKyBuYW1lICsgIj0oW14mXSopKCZ8JCkiLCAiaSIpOw0KICAgIGlmICh1cmwuaW5kZXhPZignPycpID09IC0xKSB7DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHVybCA9IHVybC5zdWJzdHIodXJsLmluZGV4T2YoJz8nKSwgdXJsLmxlbmd0aCk7DQogICAgICAgIHZhciByID0gdXJsLnN1YnN0cigxKS5tYXRjaChyZWcpOw0KICAgICAgICBpZiAociAhPSBudWxsKSByZXR1cm4gdW5lc2NhcGUoclsyXSk7IHJldHVybiBudWxsOw0KICAgIH0NCn0NCi8v6I635Y+W6K+35rGCdXJsDQpmdW5jdGlvbiBnZXRQb3N0VXJsQnlEYXRhVGFibGUodXJsKSB7DQogICAgaWYgKHVybC5pbmRleE9mKCc/JykgPT0gLTEpIHsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfSBlbHNlIHsNCiAgICAgICAgdXJsID0gdXJsLnN1YnN0cigwLCB1cmwuaW5kZXhPZignPycpKTsNCiAgICAgICAgcmV0dXJuIHVybDsNCiAgICB9DQp9DQovL+WkhOeQhnRy5a+56LGhDQpmdW5jdGlvbiBDaHVMaVRyT2JqQXJydERhdGFUYWJsZVBhZ2UoaWQpIHsNCiAgICB2YXIgdHJPYmogPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkucGFyZW50Tm9kZTsNCiAgICB2YXIgaW5kZXhRWiA9IDA7DQogICAgdmFyIGluZGV4UVpKID0gdHJPYmouZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRkIikubGVuZ3RoOw0KICAgIGlmIChDaGVja0FsbENoYW5nZSA9PSBudWxsKSB7DQogICAgICAgIC8v5LuOMOW8gOWni+WPlg0KICAgICAgICBpbmRleFFaID0gMDsNCiAgICB9IGVsc2Ugew0KICAgICAgICAvL+S7jjHlvIDlp4vlj5YNCiAgICAgICAgaW5kZXhRWiA9IDE7DQogICAgfQ0KICAgIGlmICgoVXBkYXRlQnV0Q2xpY2sgPT0gbnVsbCB8fCBVcGRhdGVCdXRDbGljayA9PSB1bmRlZmluZWQpICYmIChEZWxldGVJdGVtU3RhdGUgPT0gbnVsbCB8fCBEZWxldGVJdGVtU3RhdGUgPT0gdW5kZWZpbmVkKSkgew0KICAgICAgICAvL+WPluWAvOWIsOacgOWQjg0KICAgIH0gZWxzZSB7DQogICAgICAgIC8v5pyA5ZCO5LiA5YiX5LiN5Y+WDQogICAgICAgIGluZGV4UVpKID0gaW5kZXhRWkogLSAxOw0KICAgIH0NCiAgICB2YXIgT2JqVHh0ID0gbmV3IEFycmF5KCk7DQogICAgZm9yICh2YXIgaSA9IGluZGV4UVo7IGkgPCBpbmRleFFaSjsgaSsrKSB7DQogICAgICAgIE9ialR4dC5wdXNoKHRyT2JqLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ZCIpW2ldLmlubmVySFRNTCk7DQogICAgfQ0KICAgIHJldHVybiBPYmpUeHQ7DQp9";
        //备份4.0.1版本的js代码
        //private string JavaScriptBase64UTF8 = "LyoNCuWPguaVsOivtOaYjg0K5L2/55So5YmN5Yib5bu6RGF0YVRhYmxlT2JqKCnlr7nosaENCuiwg+eUqOWIneWni+WMluWHveaVsFNlbGVjdERhdGFUYWJsZSgi5bGe5oCn5Y+C5pWw55qEanNvbuWtl+espiIsDQoi5Yig6Zmk5ZCO5omA5Zue6LCD55qE5Ye95pWw77yIc3RhdGXvvInov5Tlm57liKDpmaTnmoTnirbmgIF0cnVl5oiQ5YqfZmFsc2XlpLHotKUiICDmnInmraTlh73mlbDliJnmmL7npLrliKDpmaTmjInpkq7msqHmnInliJnlvbHol48NCiwi5L+u5pS55oyJ6ZKu55qE5Zue6LCD5Ye95pWw77yIa2V577yJ6L+U5Zue57uR5a6a55qEa2V5Iikg5pyJ5q2k5Ye95pWw5YiZ5pi+56S65L+u5pS55oyJ6ZKu5rKh5pyJ5YiZ5b2x6JePDQosIuWFqOmAieWkmumAieinpuWPkeS6i+S7tu+8iGtleUxpc3TvvInlpoLmnpzlhajpgInliJnov5Tlm57pgInkuK3nmoRrZXnliJfooagiIOacieatpOWHveaVsOWImeaYvuekuuWkmumAieaMiemSruayoeacieWImeW9seiXjw0KLCLmr4/kuIDpobnmlbDmja7nmoTlpJrpgInmjInpkq7op6blj5HnmoTkuovku7YoY2hlY2tvYmop6L+U5Zue54K55Lit55qEY2hlY2vmoIfnrb4iDQoqLw0KDQoNCg0KLy/liJvlu7rnsbsNCmZ1bmN0aW9uIERhdGFUYWJsZU9iaigpIHsNCiAgICB0aGlzLlBvc3JVcmxUeHQgPSAiIjsNCiAgICB0aGlzLkdldERhdGFUYWJsZUJ5V2hlcmUgPSAiIjsNCiAgICB0aGlzLkRhdGFUYWJsZURpdklkID0gIiI7DQogICAgdGhpcy5QYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMgPSAwOw0KICAgIHZhciBEYXRhUGFnZUNvdW50ID0gMDsNCiAgICB0aGlzLlBhZ2VTaG93QnV0Q291bnQgPSA3Ow0KICAgIC8v5a6a5LmJ55qE5bGe5oCnDQogICAgdGhpcy5EZWxldGVCdXROYW1lID0gIuWIoOmZpCI7DQogICAgdGhpcy5VcGRhdGVCdXROYW1lID0gIuS/ruaUuSI7DQogICAgdGhpcy5DaGVja0lzVHJ1ZVR4dCA9ICLlj43pgIkiOw0KICAgIHRoaXMuQ2hlY2tJc0ZhbHNlVHh0ID0gIuWFqOmAiSI7DQogICAgdGhpcy5DaGVja0l0ZW1UeHQgPSAiIjsNCiAgICB0aGlzLkRlbGV0ZU9yVXBkYXRlVGl0bGUgPSAi5pON5L2cIjsNCiAgICB0aGlzLkxvZ2luRGl2Q2xhc3NOYW1lID0gIiI7DQogICAgdGhpcy5EZWxldGVTaG93VHh0ID0gIuS9oOehruWumuimgeWIoOmZpOivpemhueaVsOaNruWQl++8nyI7DQogICAgdGhpcy5QYWdlSW5kZXhUb29sID0gZmFsc2U7DQogICAgLy/lrprkuYnnmoTlh73mlbANCiAgICB0aGlzLlVwZGF0ZUJ1dENsaWNrOw0KICAgIHRoaXMuRGVsZXRlSXRlbVN0YXRlOw0KICAgIHRoaXMuUG9zdFN0YXJ0Ow0KICAgIHRoaXMuUG9zdFN0b3A7DQogICAgdGhpcy5DaGVja0FsbENoYW5nZTsNCiAgICB0aGlzLkNoZWNrSXRlbUNoYW5nZTsNCiAgICAvL+Wbnuiwgw0KICAgIHRoaXMuQ2FsbGJhY2s7DQogICAgdmFyIFBvc3RSZXF1ZXN0ID0gZnVuY3Rpb24gKFBvc3RVcmwsIEZvcm1TdHJpbmcpIHsNCiAgICAgICAgLy/lvIDlp4vor7fmsYINCiAgICAgICAgUG9zdFN0YXJ0KCk7DQogICAgICAgIHZhciB4bWxIdHRwOw0KICAgICAgICBpZiAod2luZG93LkFjdGl2ZVhPYmplY3QpIHsNCiAgICAgICAgICAgIHhtbEh0dHAgPSBuZXcgQWN0aXZlWE9iamVjdCgiTWljcm9zb2Z0LlhNTEhUVFAiKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIGlmICh3aW5kb3cuWE1MSHR0cFJlcXVlc3QpIHsNCiAgICAgICAgICAgIHhtbEh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsNCiAgICAgICAgfQ0KICAgICAgICB4bWxIdHRwLm9wZW4oIlBvc3QiLCBQb3N0VXJsLCB0cnVlKTsNCiAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBpZiAoeG1sSHR0cC5yZWFkeVN0YXRlID09IDQgJiYgeG1sSHR0cC5zdGF0dXMgPT0gMjAwKSB7DQogICAgICAgICAgICAgICAgUG9zdFN0b3AoKTsNCiAgICAgICAgICAgICAgICAvL+i/lOWbnuWAvOeahOWIpOaWrQ0KICAgICAgICAgICAgICAgIHZhciBKc29uTW9kZWxEYXRhVGFibGUgPSBldmFsKCIoIiArIHhtbEh0dHAucmVzcG9uc2VUZXh0ICsgIikiKTsNCiAgICAgICAgICAgICAgICAvL+WPluW+l+i/lOWbnuWAvOeahOWxnuaApw0KICAgICAgICAgICAgICAgIGlmIChKc29uTW9kZWxEYXRhVGFibGUgIT0gbnVsbCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgIT0gdW5kZWZpbmVkICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSAhPSBudWxsICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSA9PSAiNDA0Iikgew0KICAgICAgICAgICAgICAgICAgICBDWlNob3dUeHREaXYoIuivt+axguWksei0pe+8gSIpOw0KICAgICAgICAgICAgICAgICAgICAvL+aJp+ihjOWbnuiwg+WHveaVsCjor7fmsYLlpLHotKXvvIEpDQogICAgICAgICAgICAgICAgICAgIGlmIChDYWxsYmFjayAhPSB1bmRlZmluZWQgJiYgQ2FsbGJhY2sgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgQ2FsbGJhY2soIjEiLCBmYWxzZSwgSnNvbk1vZGVsRGF0YVRhYmxlLk1hZyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoSnNvbk1vZGVsRGF0YVRhYmxlICE9IG51bGwgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlICE9IHVuZGVmaW5lZCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgIT0gbnVsbCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgPT0gIjIxMSIpIHsNCiAgICAgICAgICAgICAgICAgICAgLy/miafooYzlm57osIPlh73mlbAo5Yig6Zmk5oiQ5Yqf77yBKQ0KICAgICAgICAgICAgICAgICAgICBpZiAoQ2FsbGJhY2sgIT0gdW5kZWZpbmVkICYmIENhbGxiYWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIENhbGxiYWNrKCIyIiwgdHJ1ZSwgSnNvbk1vZGVsRGF0YVRhYmxlLk1hZyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgLy/liKDpmaTmiJDlip/liLfmlrANCiAgICAgICAgICAgICAgICAgICAgaWYgKERlbGV0ZUl0ZW1TdGF0ZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBEZWxldGVJdGVtU3RhdGUodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgLy8vQ1pTaG93VHh0RGl2KCLmraPlnKjliLfmlrAuLi4iKTsNCiAgICAgICAgICAgICAgICAgICAgLy/liKTmlq3mlbDmja7mnInlpJrlsJHmnaENCiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5nZXRFbGVtZW50c0J5VGFnTmFtZSgidHIiKS5sZW5ndGggPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy/ooajnpLrmsqHmnInmlbDmja7kuoYNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocGFyc2VJbnQoUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzKSAtIDEpID4gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQb3N0UmVxdWVzdChQb3NyVXJsVHh0LCBHZXRQb3N0UGFyYW1ldGVyc1RvR2V0RGF0YShwYXJzZUludChQYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMpIC0gMSwgR2V0RGF0YVRhYmxlQnlXaGVyZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgUG9zdFJlcXVlc3QoUG9zclVybFR4dCwgR2V0UG9zdFBhcmFtZXRlcnNUb0dldERhdGEoUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzLCBHZXREYXRhVGFibGVCeVdoZXJlKSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoSnNvbk1vZGVsRGF0YVRhYmxlICE9IG51bGwgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlICE9IHVuZGVmaW5lZCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgIT0gbnVsbCAmJiBKc29uTW9kZWxEYXRhVGFibGUuU3RhdGUgPT0gIjExMiIpIHsNCiAgICAgICAgICAgICAgICAgICAgLy/miafooYzlm57osIPlh73mlbAo5Yig6Zmk5aSx6LSl77yBKQ0KICAgICAgICAgICAgICAgICAgICBpZiAoQ2FsbGJhY2sgIT0gdW5kZWZpbmVkICYmIENhbGxiYWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIENhbGxiYWNrKCIyIiwgZmFsc2UsIEpzb25Nb2RlbERhdGFUYWJsZS5NYWcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8v5Yig6Zmk5aSx6LSl77yBDQogICAgICAgICAgICAgICAgICAgIGlmIChEZWxldGVJdGVtU3RhdGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgRGVsZXRlSXRlbVN0YXRlKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBTaG93VHh0RGl2KCLmraPlnKjliLfmlrAuLi4iKTsNCiAgICAgICAgICAgICAgICAgICAgUG9zdFJlcXVlc3QoUG9zclVybFR4dCwgR2V0UG9zdFBhcmFtZXRlcnNUb0dldERhdGEoUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzLCBHZXREYXRhVGFibGVCeVdoZXJlKSk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEpzb25Nb2RlbERhdGFUYWJsZSAhPSBudWxsICYmIEpzb25Nb2RlbERhdGFUYWJsZS5TdGF0ZSAhPSB1bmRlZmluZWQgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlICE9IG51bGwgJiYgSnNvbk1vZGVsRGF0YVRhYmxlLlN0YXRlID09ICIyMjIiKSB7DQogICAgICAgICAgICAgICAgICAgIC8v6K+75Y+W5pWw5o2u5oiQ5Yqf77yBDQogICAgICAgICAgICAgICAgICAgIC8v5omn6KGM5Zue6LCD5Ye95pWwKOivu+WPluaIkOWKn++8gSkNCiAgICAgICAgICAgICAgICAgICAgaWYgKENhbGxiYWNrICE9IHVuZGVmaW5lZCAmJiBDYWxsYmFjayAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBDYWxsYmFjaygiMSIsIHRydWUsIEpzb25Nb2RlbERhdGFUYWJsZS5NYWcpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIC8v5oC76aG15pWwDQogICAgICAgICAgICAgICAgICAgIHZhciBkYXRhQ291bnQgPSBKc29uTW9kZWxEYXRhVGFibGUuZGF0YUNvdW50Ow0KICAgICAgICAgICAgICAgICAgICAvL+avj+mhteaYvuekuueahOadoeaVsA0KICAgICAgICAgICAgICAgICAgICB2YXIgUGFnZVNpemUgPSBKc29uTW9kZWxEYXRhVGFibGUuUGFnZVNpemU7DQogICAgICAgICAgICAgICAgICAgIC8v5b2T5YmN6aG155qE57Si5byVDQogICAgICAgICAgICAgICAgICAgIHZhciBQYWdlSW5kZXggPSBKc29uTW9kZWxEYXRhVGFibGUuUGFnZUluZGV4Ow0KICAgICAgICAgICAgICAgICAgICBQYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMgPSBQYWdlSW5kZXg7DQogICAgICAgICAgICAgICAgICAgIC8v6I635Y+W5Yig6Zmk55qEa2V55pa55byPDQogICAgICAgICAgICAgICAgICAgIHZhciBXaGVyZUtleSA9IEpzb25Nb2RlbERhdGFUYWJsZS5XaGVyZUtleTsNCiAgICAgICAgICAgICAgICAgICAgLy/liJflpLTplK7nmoTpm4blkIgNCiAgICAgICAgICAgICAgICAgICAgdmFyIFRhYmxlVGl0bGUgPSBuZXcgQXJyYXkoKTsNCiAgICAgICAgICAgICAgICAgICAgLy/lrZjmlL7liJfnmoTmmL7npLrnirbmgIENCiAgICAgICAgICAgICAgICAgICAgdmFyIFNob3dIaWRMaXN0ID0gbmV3IEFycmF5KCk7DQogICAgICAgICAgICAgICAgICAgIC8v6KGo5pWw5o2u6ZuG5ZCIDQogICAgICAgICAgICAgICAgICAgIHZhciBEYXRhVGFibGVPYmogPSBuZXcgQXJyYXkoKTsNCiAgICAgICAgICAgICAgICAgICAgLy/liJvlu7rnrKzkuIDooYzlrZjmlL7ooajlpLQNCiAgICAgICAgICAgICAgICAgICAgRGF0YVRhYmxlT2JqWzBdID0gbmV3IEFycmF5KCk7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGl0ZW0gaW4gSnNvbk1vZGVsRGF0YVRhYmxlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIEpzb25Nb2RlbERhdGFUYWJsZVtpdGVtXSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+i/lOWbnuWAvOeahOWxnuaAp+WMheWQq+aVsOaNruacieWkmuWwkQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoIumUriIgKyBpdGVtICsgIueahOWAvD0iICsgSnNvbk1vZGVsRGF0YVRhYmxlW2l0ZW1dKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIEpzb25Nb2RlbERhdGFUYWJsZVtpdGVtXSA9PT0gJ29iamVjdCcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgRGF0YUxpc3QgPSBKc29uTW9kZWxEYXRhVGFibGVbaXRlbV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gPT0gInRpdGxlIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WwhuWUr+S4gOmUruaUvuWIsDDliJcNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVUaXRsZVswXSA9IFdoZXJlS2V5Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WIm+W7uuihqOWktA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgVGl0bGVLZXlJbmRleCA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIFRpdGxlT2JqIGluIERhdGFMaXN0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIERhdGFMaXN0W1RpdGxlT2JqXSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WwhuWIl+WktOaJgOe7keWumueahOWAvOaUvuWIsOaVsOe7hO+8jOaWueS+v+WPluaVsOaNrg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRhYmxlVGl0bGVbVGl0bGVLZXlJbmRleF0gPSBEYXRhTGlzdFtUaXRsZU9ial07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/liJ3lp4vljJbmlbTkuKrooajnu5PmnoTvvIjliJfvvIkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhVGFibGVPYmpbMF1bVGl0bGVLZXlJbmRleF0gPSBUaXRsZU9iajsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaXRsZUtleUluZGV4ID0gVGl0bGVLZXlJbmRleCArIDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0gPT0gIlNob3dTdGF0ZSIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lrZjmlL7mmL7npLrnirbmgIHnmoTmlbDnu4QNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd0hpZExpc3QgPSBEYXRhTGlzdDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0gPT0gImRhdGEiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgRGF0YUxpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBJdGVtRGF0YSA9IERhdGFMaXN0W2ldOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/liJvlu7rooYxp5Li66KGM55qE57Si5byV57Si5byV5LuOMeW8gOWni+WboOS4ujDkuLrooajlpLQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGFUYWJsZU9ialtpICsgMV0gPSBuZXcgQXJyYXkoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIEl0ZW1EYXRhT2JqIGluIEl0ZW1EYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/liJcNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIEl0ZW1EYXRhW0l0ZW1EYXRhT2JqXSA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFRhYmxlVGl0bGVbMF0gIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEl0ZW1EYXRhT2JqID09IFRhYmxlVGl0bGVbMF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhVGFibGVPYmpbaSArIDFdWzBdID0gSXRlbURhdGFbSXRlbURhdGFPYmpdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHQgPSAxOyB0IDwgVGFibGVUaXRsZS5sZW5ndGg7IHQrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEl0ZW1EYXRhT2JqID09IFRhYmxlVGl0bGVbdF0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KEl0ZW1EYXRhW0l0ZW1EYXRhT2JqXSArICIgPT0iICsgVGFibGVUaXRsZVt0XSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lkJHooajkuK3mt7vliqDmlbDmja5b6KGMXVvliJddDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YVRhYmxlT2JqW2kgKyAxXVt0XSA9IEl0ZW1EYXRhW0l0ZW1EYXRhT2JqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Yib5bu66KGo57uT5p6EDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENyZWF0ZVRhYmxlSHRtbChEYXRhVGFibGVPYmosIFdoZXJlS2V5LCBTaG93SGlkTGlzdCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Yib5bu65YiG6aG16I+c5Y2VDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENyZWF0ZVRhYmxlUGFnZUh0bWwoUGFnZVNpemUsIGRhdGFDb3VudCwgUGFnZUluZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAvL+WIpOaWreeahOe7k+Wwvg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCiAgICAgICAgeG1sSHR0cC5zZW5kKEZvcm1TdHJpbmcpOw0KICAgIH0NCiAgICAvL+WIm+W7uuihqOe7k+aehCAg5Y+W5YC85Li6W+ihjF1b5YiXXSAgICAg6K+l6aG55pWw5o2u55qE5ZSv5LiA5qCH6K+GDQogICAgdmFyIENyZWF0ZVRhYmxlSHRtbCA9IGZ1bmN0aW9uIChEYXRhTGlzdCwga2V5LCBTaG93SGlkTGlzdCkgew0KICAgICAgICB2YXIgVGFibGVIdG1sID0gIjx0YWJsZSBib3JkZXI9JzAnIGNlbGxzcGFjaW5nPScwJyBjZWxscGFkZGluZz0nMCc+IjsNCiAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBEYXRhTGlzdC5sZW5ndGg7IHkrKykgew0KICAgICAgICAgICAgLy/ooYzlvIDlp4vliJvlu7oNCiAgICAgICAgICAgIGlmICh5ID09IDEpIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0Ym9keT48dHI+IjsNCg0KICAgICAgICAgICAgfSBlbHNlIGlmICh5ID09IDApIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0aGVhZD48dHI+IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHZhciBLZXk7DQogICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IERhdGFMaXN0W3ldLmxlbmd0aDsgeCsrKSB7DQogICAgICAgICAgICAgICAgLy/lj5blvpdLZXnnmoTlrp7pmYXlgLwNCiAgICAgICAgICAgICAgICBLZXkgPSBEYXRhTGlzdFt5XVswXTsNCiAgICAgICAgICAgICAgICAvL+WIlw0KICAgICAgICAgICAgICAgIC8v5byA5aeL5Yib5bu65YiXDQogICAgICAgICAgICAgICAgaWYgKHkgPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAoQ2hlY2tBbGxDaGFuZ2UgIT0gbnVsbCAmJiB4ID09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIFRhYmxlSHRtbCArPSAiPHRoPjxpbnB1dCBvbmNoYW5nZT0nbmV3IERhdGFUYWJsZU9iaigpLkNoZWNrQWxsQ2hhbmdlT2JqVG9EYXRhVGFibGUodGhpcyknIHR5cGU9XCJjaGVja2JveFwiIC8+PHNwYW4+IiArIENoZWNrSXNGYWxzZVR4dCArICI8L3NwYW4+PC90aD48dGg+IiArIERhdGFMaXN0W3ldW3hdICsgIjwvdGg+IjsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeCsifCIrU2hvd0hpZExpc3RbeC0xXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAvL+WIl+WktA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFNob3dIaWRMaXN0W3ggLSAxXSA9PSAiU2hvdyIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0aD4iICsgRGF0YUxpc3RbeV1beF0gKyAiPC90aD4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0aCBzdHlsZT0nZGlzcGxheTpub25lOyc+IiArIERhdGFMaXN0W3ldW3hdICsgIjwvdGg+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChDaGVja0FsbENoYW5nZSAhPSBudWxsICYmIHggPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKENoZWNrSXRlbUNoYW5nZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGQ+PGlucHV0IG5hbWU9J0RhdGFUYWJsZUl0ZW1DaGVjaycgdmFsdWU9JyIgKyBLZXkgKyAiJyBvbmNoYW5nZT1cIm5ldyBEYXRhVGFibGVPYmooKS5DaGVja0l0ZW1DaGFuZ2VPYmpUb0RhdGFUYWJsZSh0aGlzKVwiIHR5cGU9XCJjaGVja2JveFwiIC8+IiArIENoZWNrSXRlbVR4dCArICI8L3RkPjx0ZD4iICsgRGF0YUxpc3RbeV1beF0gKyAiPC90ZD4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0ZD48aW5wdXQgbmFtZT0nRGF0YVRhYmxlSXRlbUNoZWNrJyB2YWx1ZT0nIiArIEtleSArICInIHR5cGU9XCJjaGVja2JveFwiIC8+PC90ZD48dGQ+IiArIERhdGFMaXN0W3ldW3hdICsgIjwvdGQ+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTaG93SGlkTGlzdFt4IC0gMV0gPT0gIlNob3ciKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGQ+IiArIERhdGFMaXN0W3ldW3hdICsgIjwvdGQ+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGQgc3R5bGU9J2Rpc3BsYXk6bm9uZTsnPiIgKyBEYXRhTGlzdFt5XVt4XSArICI8L3RkPiI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy/nu5PmnZ/liJvlu7oNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICh5ICE9IDApIHsNCg0KICAgICAgICAgICAgICAgIC8v5LuO5pWw5o2u5byA5aeL6I635Y+Wa2V5DQogICAgICAgICAgICAgICAgLy/lj5blvpdLZXnnmoTlrp7pmYXlgLwNCiAgICAgICAgICAgICAgICBLZXkgPSBEYXRhTGlzdFt5XVswXTsNCiAgICAgICAgICAgICAgICBpZiAoRGVsZXRlSXRlbVN0YXRlICE9IG51bGwgfHwgVXBkYXRlQnV0Q2xpY2sgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjx0ZCBpZD0nRGF0YVRhYmxlUGFnZV9Vc2VyX0xhblNRXyIgKyBLZXkgKyAiJyA+IjsNCiAgICAgICAgICAgICAgICAgICAgaWYgKERlbGV0ZUl0ZW1TdGF0ZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjxhIGhyZWY9XCJqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5EYXRhVGFibGVEZWxldGVCeUtleSgnIiArIEtleSArICInKVwiPiIgKyBEZWxldGVCdXROYW1lICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChVcGRhdGVCdXRDbGljayAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjxhIGhyZWY9XCJqYXZhc2NyaXB0OlVwZGF0ZUJ1dENsaWNrKCciICsgS2V5ICsgIicsQ2h1TGlUck9iakFycnREYXRhVGFibGVQYWdlKCdEYXRhVGFibGVQYWdlX1VzZXJfTGFuU1FfIiArIEtleSArICInKSlcIj4iICsgVXBkYXRlQnV0TmFtZSArICI8L2E+IjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjwvdGQ+IjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8v5Yib5bu65Yig6Zmk5YiX5aS05oiW5L+u5pS55YiX5aS0DQogICAgICAgICAgICAgICAgaWYgKERlbGV0ZUl0ZW1TdGF0ZSAhPSBudWxsIHx8IFVwZGF0ZUJ1dENsaWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgVGFibGVIdG1sICs9ICI8dGg+IiArIERlbGV0ZU9yVXBkYXRlVGl0bGUgKyAiPC90aD4iOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8v6KGM5byA5aeL5Yib5bu657uT5p2fDQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmICh5ID09IDApIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjwvdHI+PC90aGVhZD4iOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBUYWJsZUh0bWwgKz0gIjwvdHI+IjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIFRhYmxlSHRtbCArPSAiPC90Ym9keT48L3RhYmxlPiI7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5pbm5lckhUTUwgPSBUYWJsZUh0bWw7DQogICAgfQ0KICAgIC8v5Yib5bu65YiG6aG16I+c5Y2VDQogICAgdmFyIENyZWF0ZVRhYmxlUGFnZUh0bWwgPSBmdW5jdGlvbiAoUGFnZVNpemUsIGRhdGFDb3VudCwgUGFnZUluZGV4KSB7DQogICAgICAgIC8v5pi+56S65YiG6aG15oyJ6ZKu55qE5Liq5pWwDQogICAgICAgIHZhciBQYWdlSW5kZXhCdXRDb3VudCA9IFBhZ2VTaG93QnV0Q291bnQ7DQogICAgICAgIC8v5oC76aG15pWwDQogICAgICAgIHZhciBQYWdlQ291bnQgPSAwOw0KICAgICAgICBpZiAoKGRhdGFDb3VudCAlIFBhZ2VTaXplKSA9PSAwKSB7DQogICAgICAgICAgICBQYWdlQ291bnQgPSBwYXJzZUludChkYXRhQ291bnQgLyBQYWdlU2l6ZSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBQYWdlQ291bnQgPSBwYXJzZUludChkYXRhQ291bnQgLyBQYWdlU2l6ZSkgKyAxOw0KICAgICAgICB9DQogICAgICAgIC8v5a2Y5YKo5YWo5bGA5Y+Y6YeP5oC76aG15pWwDQogICAgICAgIERhdGFQYWdlQ291bnQgPSBQYWdlQ291bnQ7DQogICAgICAgIHZhciBTaG93TWFuYWdlclR4dCA9IFBhZ2VDb3VudDsNCiAgICAgICAgaWYgKFBhZ2VDb3VudCA9PSAwKSB7DQogICAgICAgICAgICBTaG93TWFuYWdlclR4dCA9ICLml6DmlbDmja4iOw0KICAgICAgICB9DQogICAgICAgIHZhciBQYWdlVHh0SHRtbCA9ICI8ZGl2PjxzcGFuPuW9k+WJje+8miIgKyAocGFyc2VJbnQoUGFnZUluZGV4KSArIDEpICsgIi8iICsgU2hvd01hbmFnZXJUeHQgKyAiPC9zcGFuPiI7DQogICAgICAgIHZhciBVcEluZGV4ID0gIjxhIGhyZWY9J2phdmFzY3JpcHQ6bmV3IERhdGFUYWJsZU9iaigpLlBhZ2VJbmRleEJ1dCgwLDAsIiArIFBhZ2VDb3VudCArICIpJyA+6aaW6aG1PC9hPiI7DQogICAgICAgIHZhciBEb3dJbmRleCA9ICI8YSBocmVmPSdqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoIiArIChwYXJzZUludChQYWdlQ291bnQpIC0gMSkgKyAiLDAsIiArIFBhZ2VDb3VudCArICIpJyA+5bC+6aG1PC9hPiI7DQogICAgICAgIHZhciBOZXh0UGFnZUluZGV4ID0gIjxsYWJlbD7ot7Povaw8c2VsZWN0IG9uY2hhbmdlPVwibmV3IERhdGFUYWJsZU9iaigpLlBhZ2VJbmRleEJ1dCh0aGlzLnZhbHVlLDAsIiArIFBhZ2VDb3VudCArICIpXCI+IjsNCiAgICAgICAgLy/liKTmlq3mmK/lkKblvIDlkK8NCiAgICAgICAgaWYgKCFQYWdlSW5kZXhUb29sKSB7DQogICAgICAgICAgICBVcEluZGV4ID0gIiI7DQogICAgICAgICAgICBEb3dJbmRleCA9ICIiOw0KICAgICAgICB9DQogICAgICAgIHZhciBQYWdlQnV0SHRtbCA9ICI8ZGl2PiIgKyBVcEluZGV4ICsgIjxhIGhyZWY9J2phdmFzY3JpcHQ6bmV3IERhdGFUYWJsZU9iaigpLlBhZ2VJbmRleEJ1dCgiICsgcGFyc2VJbnQoUGFnZUluZGV4KSArICIsMSwiICsgUGFnZUNvdW50ICsgIiknID7kuIrkuIDpobU8L2E+IjsNCiAgICAgICAgdmFyIENvdW50UGFnZUJ1dCA9IDA7DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgUGFnZUNvdW50OyBpKyspIHsNCiAgICAgICAgICAgIC8v6Lez6L2s6aG1DQogICAgICAgICAgICBpZiAocGFyc2VJbnQoUGFnZUluZGV4KSA9PSBpKSB7DQogICAgICAgICAgICAgICAgTmV4dFBhZ2VJbmRleCArPSAiPG9wdGlvbiBzZWxlY3RlZD0nc2VsZWN0ZWQnIHZhbHVlPVwiIiArIGkgKyAiXCI+IiArIChpICsgMSkgKyAiPC9vcHRpb24+IjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgTmV4dFBhZ2VJbmRleCArPSAiPG9wdGlvbiB2YWx1ZT1cIiIgKyBpICsgIlwiPiIgKyAoaSArIDEpICsgIjwvb3B0aW9uPiI7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBQYWdlQ291bnQ7IGkrKykgew0KICAgICAgICAgICAgLy/liIbpobXnvKnov5vnrpfms5XpobXmlbDlsI/kuo43DQogICAgICAgICAgICBpZiAoUGFnZUNvdW50IDw9IFBhZ2VJbmRleEJ1dENvdW50KSB7DQogICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KFBhZ2VJbmRleCkgPT0gaSkgew0KICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxlbT4iICsgKGkgKyAxKSArICI8L2VtPiI7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIiA8YSBocmVmPSdqYXZhc2NyaXB0Om5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoIiArIGkgKyAiLDAsIiArIFBhZ2VDb3VudCArICIpJyA+IiArIChpICsgMSkgKyAiPC9hPiI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvL+W9k+mhteaVsOWkp+S6jjcNCiAgICAgICAgICAgICAgICAvL2lmIChpIDwgUGFnZUluZGV4QnV0Q291bnQpIHsNCiAgICAgICAgICAgICAgICB2YXIgaXQgPSBwYXJzZUludChwYXJzZUludChQYWdlSW5kZXgpIC8gUGFnZUluZGV4QnV0Q291bnQpOw0KICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChQYWdlSW5kZXgpID4gcGFyc2VJbnQoUGFnZUluZGV4QnV0Q291bnQgLyAyKSkgew0KICAgICAgICAgICAgICAgICAgICAvL+W9k+mAieaLqeeahOmhteaVsOi2hei/h+S4gOWNiueahOaXtuWAmQ0KICAgICAgICAgICAgICAgICAgICBpZiAoaSA+PSBwYXJzZUludChQYWdlSW5kZXggLSAocGFyc2VJbnQoUGFnZUluZGV4QnV0Q291bnQgLyAyKSkpICYmIChQYWdlQ291bnQgLSBwYXJzZUludChQYWdlSW5kZXgpKSA+IHBhcnNlSW50KFBhZ2VJbmRleEJ1dENvdW50IC8gMikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChDb3VudFBhZ2VCdXQgPCBQYWdlSW5kZXhCdXRDb3VudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvdW50UGFnZUJ1dCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChQYWdlSW5kZXgpID09IGkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIiA8ZW0+IiArIChpICsgMSkgKyAiPC9lbT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBhZ2VCdXRIdG1sICs9ICIgPGEgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KCIgKyBpICsgIiwwLCIgKyBQYWdlQ291bnQgKyAiKScgPiIgKyAoaSArIDEpICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5piv5Yiw5pyA5ZCO5LiA57uEDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKFBhZ2VDb3VudCAtIGkpIDwgUGFnZUluZGV4QnV0Q291bnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gKFBhZ2VDb3VudCAtIFBhZ2VJbmRleEJ1dENvdW50KTsgaSA8IFBhZ2VDb3VudDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChQYWdlSW5kZXgpID09IGkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBhZ2VCdXRIdG1sICs9ICIgPGVtPiIgKyAoaSArIDEpICsgIjwvZW0+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBhZ2VCdXRIdG1sICs9ICIgPGEgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KCIgKyBpICsgIiwwLCIgKyBQYWdlQ291bnQgKyAiKScgID4iICsgKGkgKyAxKSArICI8L2E+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPj0gKHBhcnNlSW50KFBhZ2VJbmRleCAtIChwYXJzZUludChQYWdlSW5kZXhCdXRDb3VudCAvIDIpKSkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChDb3VudFBhZ2VCdXQgPCBQYWdlSW5kZXhCdXRDb3VudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ291bnRQYWdlQnV0Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQoUGFnZUluZGV4KSA9PSBpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIiA8ZW0+IiArIChpICsgMSkgKyAiPC9lbT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxhIGhyZWY9J2phdmFzY3JpcHQ6bmV3IERhdGFUYWJsZU9iaigpLlBhZ2VJbmRleEJ1dCgiICsgaSArICIsMCwiICsgUGFnZUNvdW50ICsgIiknID4iICsgKGkgKyAxKSArICI8L2E+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChDb3VudFBhZ2VCdXQgPCBQYWdlSW5kZXhCdXRDb3VudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgQ291bnRQYWdlQnV0Kys7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQoUGFnZUluZGV4KSA9PSBpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFnZUJ1dEh0bWwgKz0gIiA8ZW0+IiArIChpICsgMSkgKyAiPC9lbT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlQnV0SHRtbCArPSAiIDxhIGhyZWY9J2phdmFzY3JpcHQ6bmV3IERhdGFUYWJsZU9iaigpLlBhZ2VJbmRleEJ1dCgiICsgaSArICIsMCwiICsgUGFnZUNvdW50ICsgIiknID4iICsgKGkgKyAxKSArICI8L2E+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvL30NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvL+i3s+i9rOmhtee7k+adnw0KICAgICAgICBOZXh0UGFnZUluZGV4ICs9ICI8L3NlbGVjdD7pobU8L2xhYmVsPiI7DQogICAgICAgIC8v5Yik5pat5piv5ZCm5byA5ZCvDQogICAgICAgIGlmICghUGFnZUluZGV4VG9vbCkgew0KICAgICAgICAgICAgTmV4dFBhZ2VJbmRleCA9ICIiOw0KICAgICAgICB9DQogICAgICAgIFBhZ2VCdXRIdG1sICs9ICI8YSAgaHJlZj0namF2YXNjcmlwdDpuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KCIgKyBwYXJzZUludChQYWdlSW5kZXgpICsgIiwyLCIgKyBQYWdlQ291bnQgKyAiKScgPuS4i+S4gOmhtTwvYT4iICsgRG93SW5kZXggKyAiIiArIE5leHRQYWdlSW5kZXggKyAiPC9kaXY+IjsNCiAgICAgICAgUGFnZVR4dEh0bWwgKz0gUGFnZUJ1dEh0bWwgKyAiIjsNCiAgICAgICAgLy9hbGVydChEYXRhVGFibGVEaXZJZCk7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5pbm5lckhUTUwgKz0gUGFnZVR4dEh0bWw7DQogICAgfQ0KICAgIHRoaXMuUGFnZUluZGV4QnV0ID0gZnVuY3Rpb24gKFBhZ2VJbmRleCwgUGFnZUluZGV4VHlwZSwgUGFnZUNvdW50KSB7DQogICAgICAgIHZhciBpbmRleCA9IDA7DQogICAgICAgIGlmIChQYWdlSW5kZXhUeXBlID09IDApIHsNCiAgICAgICAgICAgIGluZGV4ID0gcGFyc2VJbnQoUGFnZUluZGV4KTsNCiAgICAgICAgfSBlbHNlIGlmIChQYWdlSW5kZXhUeXBlID09IDEpIHsNCiAgICAgICAgICAgIC8v5LiK5LiA6aG1DQogICAgICAgICAgICBpZiAoKFBhZ2VJbmRleCAtIDEpID49IDApIHsNCiAgICAgICAgICAgICAgICBpbmRleCA9IChwYXJzZUludChQYWdlSW5kZXgpIC0gMSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGluZGV4ID0gcGFyc2VJbnQoUGFnZUluZGV4KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIGlmIChQYWdlSW5kZXhUeXBlID09IDIpIHsNCiAgICAgICAgICAgIC8v5LiL5LiA6aG1DQogICAgICAgICAgICBpZiAoKHBhcnNlSW50KFBhZ2VJbmRleCkgKyAxKSA8IFBhZ2VDb3VudCkgew0KICAgICAgICAgICAgICAgIGluZGV4ID0gKHBhcnNlSW50KFBhZ2VJbmRleCkgKyAxKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaW5kZXggPSBwYXJzZUludChQYWdlSW5kZXgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIC8v5L+d5a2Y5b2T5YmN5Lmf55qE57Si5byVDQogICAgICAgIFBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcyA9IGluZGV4Ow0KICAgICAgICBQb3N0UmVxdWVzdChQb3NyVXJsVHh0LCBHZXRQb3N0UGFyYW1ldGVyc1RvR2V0RGF0YShpbmRleCwgR2V0RGF0YVRhYmxlQnlXaGVyZSkpOw0KICAgIH0NCiAgICAvL+afpeivouWPguaVsOeUn+aIkA0KICAgIHZhciBHZXRQb3N0UGFyYW1ldGVyc1RvR2V0RGF0YSA9IGZ1bmN0aW9uIChQYWdlSW5kZXgsIFdoZXJlVHh0KSB7DQogICAgICAgIHJldHVybiAie1wiUGFnZUluZGV4XCI6IiArIFBhZ2VJbmRleCArICIsXCJXaGVyZVR4dFwiOlwiIiArIFdoZXJlVHh0ICsgIlwiLFwiV2hlcmVLZXlcIjpcIlwiLFwiUG9zdFR5cGVGdW5cIjoxfSI7DQogICAgfQ0KICAgIC8v5Yig6Zmk5Y+C5pWw55Sf5oiQDQogICAgdmFyIEdldFBvc3RQYXJhbWV0ZXJzVG9EZWxldGVJdGVtID0gZnVuY3Rpb24gKFdoZXJlS2V5KSB7DQogICAgICAgIHJldHVybiAie1wiUGFnZUluZGV4XCI6MCxcIldoZXJlVHh0XCI6XCJcIixcIldoZXJlS2V5XCI6XCIiICsgV2hlcmVLZXkgKyAiXCIsXCJQb3N0VHlwZUZ1blwiOjB9IjsNCiAgICB9DQogICAgLy/liKDpmaTlh73mlbANCiAgICB0aGlzLkRhdGFUYWJsZURlbGV0ZUJ5S2V5ID0gZnVuY3Rpb24gKEtleSkgew0KICAgICAgICBpZiAoS2V5ID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgYWxlcnQoIuaKseatieS9oOayoeaciee7keWumuivpemhueaVsOaNrueahOWUr+S4gOmUru+8jOezu+e7n+ayoeacieadoeS7tui/m+ihjOWIoOmZpCIpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIGlmIChjb25maXJtKERlbGV0ZVNob3dUeHQpKSB7DQogICAgICAgICAgICBQb3N0UmVxdWVzdChQb3NyVXJsVHh0LCBHZXRQb3N0UGFyYW1ldGVyc1RvRGVsZXRlSXRlbShLZXkpKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICAvL+mUruebmOS6i+S7tg0KICAgIGRvY3VtZW50Lm9ua2V5dXAgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBrZXljb2RlID0gZXZlbnQud2hpY2ggfHwgZXZlbnQua2V5Q29kZTsNCiAgICAgICAgaWYgKGtleWNvZGUgPT0gMzcpIHsNCiAgICAgICAgICAgIC8v5LiK5LiA6aG1DQogICAgICAgICAgICBuZXcgRGF0YVRhYmxlT2JqKCkuUGFnZUluZGV4QnV0KFBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcywgMSwgRGF0YVBhZ2VDb3VudCk7DQogICAgICAgIH0gZWxzZSBpZiAoa2V5Y29kZSA9PSAzOSkgew0KICAgICAgICAgICAgLy/kuIvkuIDpobUNCiAgICAgICAgICAgIG5ldyBEYXRhVGFibGVPYmooKS5QYWdlSW5kZXhCdXQoUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzLCAyLCBEYXRhUGFnZUNvdW50KTsNCiAgICAgICAgfQ0KICAgIH0NCg0KDQogICAgdGhpcy5DaGVja0FsbENoYW5nZU9ialRvRGF0YVRhYmxlID0gZnVuY3Rpb24gKG9iakNoZWNrKSB7DQogICAgICAgIHZhciBWYWxMaXN0S2V5ID0gIiI7DQogICAgICAgIGlmIChvYmpDaGVjay5jaGVja2VkKSB7DQogICAgICAgICAgICAvL+mAieaLqQ0KICAgICAgICAgICAgb2JqQ2hlY2sucGFyZW50Tm9kZS5jaGlsZHJlblsxXS5pbm5lclRleHQgPSBDaGVja0lzVHJ1ZVR4dDsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLmNoZWNrZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgiRGF0YVRhYmxlSXRlbUNoZWNrIilbaV0udmFsdWUgIT0gbnVsbCAmJiBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgiRGF0YVRhYmxlSXRlbUNoZWNrIilbaV0udmFsdWUgIT0gIiIgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICE9ICJvbiIpIHsNCiAgICAgICAgICAgICAgICAgICAgVmFsTGlzdEtleSArPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgiRGF0YVRhYmxlSXRlbUNoZWNrIilbaV0udmFsdWUgKyAiLCI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgiRGF0YVRhYmxlSXRlbUNoZWNrIikubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgiRGF0YVRhYmxlSXRlbUNoZWNrIilbaV0uY2hlY2tlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgiRGF0YVRhYmxlSXRlbUNoZWNrIilbaV0udmFsdWUgIT0gbnVsbCAmJiBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgiRGF0YVRhYmxlSXRlbUNoZWNrIilbaV0udmFsdWUgIT0gIiIgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoIkRhdGFUYWJsZUl0ZW1DaGVjayIpW2ldLnZhbHVlICE9ICJvbiIpIHsNCiAgICAgICAgICAgICAgICAgICAgVmFsTGlzdEtleSArPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgiRGF0YVRhYmxlSXRlbUNoZWNrIilbaV0udmFsdWUgKyAiLCI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgb2JqQ2hlY2sucGFyZW50Tm9kZS5jaGlsZHJlblsxXS5pbm5lclRleHQgPSBDaGVja0lzRmFsc2VUeHQ7DQogICAgICAgIH0NCiAgICAgICAgaWYgKFZhbExpc3RLZXkubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgVmFsTGlzdEtleSA9IFZhbExpc3RLZXkuc3Vic3RyaW5nKDAsIFZhbExpc3RLZXkubGVuZ3RoIC0gMSk7DQogICAgICAgIH0NCiAgICAgICAgb2JqQ2hlY2suc2V0QXR0cmlidXRlKCJ0YWciLCAie1wiY2hlY2tlZFwiOlwiIiArIG9iakNoZWNrLmNoZWNrZWQgKyAiXCIsXCJsaXN0XCI6XCIiICsgVmFsTGlzdEtleSArICJcIn0iKTsNCiAgICAgICAgQ2hlY2tBbGxDaGFuZ2UoIntcImNoZWNrZWRcIjpcIiIgKyBvYmpDaGVjay5jaGVja2VkICsgIlwiLFwibGlzdFwiOlwiIiArIFZhbExpc3RLZXkgKyAiXCJ9Iik7DQogICAgfQ0KICAgIHRoaXMuQ2hlY2tJdGVtQ2hhbmdlT2JqVG9EYXRhVGFibGUgPSBmdW5jdGlvbiAob2JqS2V5KSB7DQogICAgICAgIGlmICghb2JqS2V5LmNoZWNrZWQpIHsNCiAgICAgICAgICAgIG9iaktleS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jaGlsZHJlblswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaW5wdXQiKVswXS5jaGVja2VkID0gZmFsc2U7DQogICAgICAgICAgICBvYmpLZXkucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2hpbGRyZW5bMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInNwYW4iKVswXS5pbm5lclRleHQgPSAi5YWo6YCJIjsNCiAgICAgICAgfQ0KICAgICAgICBDaGVja0l0ZW1DaGFuZ2Uob2JqS2V5KTsNCiAgICB9DQogICAgLy8v6I635Y+W5YWo6YCJ5ZCO5omA6YCJ5oup5pWw5o2u55qE5ZSv5LiA6ZSu5YC855qE5YiX6KGoDQogICAgdGhpcy5HZXRDaGVja0FsbFZhbHVlTGlzdCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIExpc3RLZXkgPSAiIjsNCiAgICAgICAgdmFyIExpc3RDaGVjayA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCJEYXRhVGFibGVJdGVtQ2hlY2siKTsgLy9EYXRhVGFibGVJdGVtQ2hlY2sgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0YWJsZSIpWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJpbnB1dCIpOw0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IExpc3RDaGVjay5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgaWYgKExpc3RDaGVja1tpXS5jaGVja2VkKSB7DQogICAgICAgICAgICAgICAgTGlzdEtleSArPSBMaXN0Q2hlY2tbaV0udmFsdWUgKyAiLCI7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKExpc3RLZXkubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgTGlzdEtleSA9IExpc3RLZXkuc3Vic3RyaW5nKDAsIExpc3RLZXkubGVuZ3RoIC0gMSk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIExpc3RLZXk7IC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGQiKVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaW5wdXQiKVswXS5nZXRBdHRyaWJ1dGUoInRhZyIpOw0KICAgIH0NCg0KICAgIHZhciBQb3N0U3RhcnQgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIC8vYWxlcnQoIuW8gOWni+ivt+axgiIpOw0KICAgICAgICBTaG93VHh0RGl2KCLmraPlnKjor7fmsYIuLi4iKTsNCiAgICB9DQogICAgdmFyIFNob3dUeHREaXYgPSBmdW5jdGlvbiAodHh0KSB7DQogICAgICAgIHZhciBsb2RpbmdkaXZvYmogPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiOTVlNjM4ZmEyNDMzZTY4MDJiNmQyODIwMWUyOGI3M2QiKTsNCiAgICAgICAgaWYgKGxvZGluZ2Rpdm9iaiAhPSB1bmRlZmluZWQgJiYgbG9kaW5nZGl2b2JqICE9IG51bGwpIHsNCiAgICAgICAgICAgIGxvZGluZ2Rpdm9iai5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGxvZGluZ2Rpdm9iaik7DQogICAgICAgIH0NCiAgICAgICAgaWYgKExvZ2luRGl2Q2xhc3NOYW1lICE9ICIiKSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChEYXRhVGFibGVEaXZJZCkuaW5uZXJIVE1MID0gIjxkaXYgaWQ9Jzk1ZTYzOGZhMjQzM2U2ODAyYjZkMjgyMDFlMjhiNzNkJyBjbGFzcz0nIiArIExvZ2luRGl2Q2xhc3NOYW1lICsgIic+IiArIHR4dCArICI8L2Rpdj4iICsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmlubmVySFRNTDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKERhdGFUYWJsZURpdklkKS5pbm5lckhUTUwgPSAiPGRpdiBpZD0nOTVlNjM4ZmEyNDMzZTY4MDJiNmQyODIwMWUyOGI3M2QnIHN0eWxlPSd3aWR0aDo5MHB4O2hlaWdodDozMHB4O29wYWNpdHk6MS4wO2JhY2tncm91bmQtY29sb3I6Izk5OTk5OTtwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjkwMDtib3JkZXI6c29saWQgMXB4ICNGMEMzNkQ7YmFja2dyb3VuZC1jb2xvcjojRjlFREJFO2ZvbnQtc2l6ZToxM3B4O2NvbG9yOiM2NjY7dGV4dC1hbGlnbjpjZW50ZXI7bGluZS1oZWlnaHQ6MzBweDttYXJnaW4tbGVmdDoyNSU7Jz4iICsgdHh0ICsgIjwvZGl2PiIgKyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChEYXRhVGFibGVEaXZJZCkuaW5uZXJIVE1MOw0KICAgICAgICB9DQogICAgfQ0KICAgIHZhciBDWlNob3dUeHREaXYgPSBmdW5jdGlvbiAodHh0KSB7DQogICAgICAgIHZhciBsb2RpbmdkaXZvYmogPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiOTVlNjM4ZmEyNDMzZTY4MDJiNmQyODIwMWUyOGI3M2QiKTsNCiAgICAgICAgaWYgKGxvZGluZ2Rpdm9iaiAhPSB1bmRlZmluZWQgJiYgbG9kaW5nZGl2b2JqICE9IG51bGwpIHsNCiAgICAgICAgICAgIGxvZGluZ2Rpdm9iai5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGxvZGluZ2Rpdm9iaik7DQogICAgICAgIH0NCiAgICAgICAgaWYgKExvZ2luRGl2Q2xhc3NOYW1lICE9ICIiKSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChEYXRhVGFibGVEaXZJZCkuaW5uZXJIVE1MID0gIjxkaXYgaWQ9Jzk1ZTYzOGZhMjQzM2U2ODAyYjZkMjgyMDFlMjhiNzNkJyBjbGFzcz0nIiArIExvZ2luRGl2Q2xhc3NOYW1lICsgIic+IiArIHR4dCArICI8L2Rpdj4iOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRGF0YVRhYmxlRGl2SWQpLmlubmVySFRNTCA9ICI8ZGl2IGlkPSc5NWU2MzhmYTI0MzNlNjgwMmI2ZDI4MjAxZTI4YjczZCcgc3R5bGU9J3dpZHRoOjkwcHg7aGVpZ2h0OjMwcHg7b3BhY2l0eToxLjA7YmFja2dyb3VuZC1jb2xvcjojOTk5OTk5O3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6OTAwO2JvcmRlcjpzb2xpZCAxcHggI0YwQzM2RDtiYWNrZ3JvdW5kLWNvbG9yOiNGOUVEQkU7Zm9udC1zaXplOjEzcHg7Y29sb3I6IzY2Njt0ZXh0LWFsaWduOmNlbnRlcjtsaW5lLWhlaWdodDozMHB4O21hcmdpbi1sZWZ0OjI1JTsnPiIgKyB0eHQgKyAiPC9kaXY+IjsNCiAgICAgICAgfQ0KICAgIH0NCiAgICB2YXIgUG9zdFN0b3AgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIC8vYWxlcnQoIuivt+axguWujOavlSIpOw0KICAgIH0NCiAgICB0aGlzLlVwU3RhdGVSZWZyZXNoID0gZnVuY3Rpb24gKCkgew0KICAgICAgICBQb3N0UmVxdWVzdChQb3NyVXJsVHh0LCBHZXRQb3N0UGFyYW1ldGVyc1RvR2V0RGF0YShQYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMsIEdldERhdGFUYWJsZUJ5V2hlcmUpKTsNCiAgICB9DQogICAgdGhpcy5TZWxlY3REYXRhVGFibGUgPSBmdW5jdGlvbiAoanNvbk1vZGVsLCBfRGVsZXRlSXRlbVN0YXRlLCBfVXBkYXRlQnV0Q2xpY2ssIF9DaGVja0FsbENoYW5nZSwgX0NoZWNrSXRlbUNoYW5nZSwgX0NhbGxiYWNrKSB7DQogICAgICAgIC8vU2hvd0RhdGFUYWJsZURpdklkLCBHZXREYXRhVGFibGVVcmwsIEdldERhdGFUYWJsZUJ5V2hlcmVUeHQsIF9VcGRhdGVCdXRDbGljaywgX0RlbGV0ZUl0ZW1TdGF0ZSwgX0NoZWNrQWxsQ2hhbmdlLCBfQ2hlY2tJdGVtQ2hhbmdlDQoNCiAgICAgICAgRGF0YVRhYmxlRGl2SWQgPSBqc29uTW9kZWwuU2hvd0RhdGFUYWJsZURpdklkOw0KICAgICAgICBQb3NyVXJsVHh0ID0ganNvbk1vZGVsLkdldERhdGFUYWJsZVVybDsNCiAgICAgICAgR2V0RGF0YVRhYmxlQnlXaGVyZSA9IGpzb25Nb2RlbC5HZXREYXRhVGFibGVCeVdoZXJlVHh0Ow0KICAgICAgICBQYWdlSW5kZXhUb0RlbGV0ZVN0YXRlSXNZZXMgPSAwOw0KICAgICAgICAvL0RhdGFQYWdlQ291bnQgPSAwOw0KICAgICAgICBQYWdlU2hvd0J1dENvdW50ID0gNzsNCiAgICAgICAgLy/liJ3lp4vljJblj4LmlbANCiAgICAgICAgRGVsZXRlQnV0TmFtZSA9ICLliKDpmaQiOw0KICAgICAgICBVcGRhdGVCdXROYW1lID0gIuS/ruaUuSI7DQogICAgICAgIENoZWNrSXNUcnVlVHh0ID0gIuWPjemAiSI7DQogICAgICAgIENoZWNrSXNGYWxzZVR4dCA9ICLlhajpgIkiOw0KICAgICAgICBDaGVja0l0ZW1UeHQgPSAiIjsNCiAgICAgICAgRGVsZXRlT3JVcGRhdGVUaXRsZSA9ICLmk43kvZwiOw0KICAgICAgICAvL+WKoOi9veaXtmRpdueahOagt+W8jw0KICAgICAgICBMb2dpbkRpdkNsYXNzTmFtZSA9ICIiOw0KICAgICAgICBEZWxldGVTaG93VHh0ID0gIuS9oOehruWumuimgeWIoOmZpOivpemhueaVsOaNruWQl++8nyI7DQogICAgICAgIFBhZ2VJbmRleFRvb2wgPSBmYWxzZTsNCiAgICAgICAgaWYgKGpzb25Nb2RlbC5QYWdlSW5kZXhUb29sU3RhdGUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBQYWdlSW5kZXhUb29sID0ganNvbk1vZGVsLlBhZ2VJbmRleFRvb2xTdGF0ZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoanNvbk1vZGVsLkRlbGV0ZVNob3dUeHQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBEZWxldGVTaG93VHh0ID0ganNvbk1vZGVsLkRlbGV0ZVNob3dUeHQ7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5TaG93RGF0YVRhYmxlRGl2SWQgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAvL+iOt+WPluaYvuekuueahGRpdmlkDQogICAgICAgICAgICB2YXIgc2NyaXB0TGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2NyaXB0TGlzdC5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIGlmIChzY3JpcHRMaXN0W2ldLmF0dHJpYnV0ZXNbJ2lzRGF0YVRhYmxlUGFnZSddICE9IHVuZGVmaW5lZCAmJiBzY3JpcHRMaXN0W2ldLmF0dHJpYnV0ZXNbJ2lzRGF0YVRhYmxlUGFnZSddICE9IG51bGwgJiYgc2NyaXB0TGlzdFtpXS5hdHRyaWJ1dGVzWydpc0RhdGFUYWJsZVBhZ2UnXS5ub2RlVmFsdWUgIT0gdW5kZWZpbmVkICYmIHNjcmlwdExpc3RbaV0uYXR0cmlidXRlc1snaXNEYXRhVGFibGVQYWdlJ10ubm9kZVZhbHVlICE9IG51bGwgJiYgc2NyaXB0TGlzdFtpXS5hdHRyaWJ1dGVzWydpc0RhdGFUYWJsZVBhZ2UnXS5ub2RlVmFsdWUgPT0gJ2lzRGF0YVRhYmxlUGFnZScpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdE9ialVybCA9IHNjcmlwdExpc3RbaV0uc3JjOw0KICAgICAgICAgICAgICAgICAgICBEYXRhVGFibGVEaXZJZCA9IGdldFF1ZXJ5U3RyaW5nQnlEYXRhVGFibGUoc2NyaXB0T2JqVXJsLCAnZGl2aWQnKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKERhdGFUYWJsZURpdklkID09IHVuZGVmaW5lZCB8fCBEYXRhVGFibGVEaXZJZCA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgYWxlcnQoIuS9oOW/hemhu+aPkOS+m+aYvuekuuaVsOaNrueahGRpdueahElEIik7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuR2V0RGF0YVRhYmxlVXJsID09IHVuZGVmaW5lZCkgey8vZ2V0UG9zdFVybEJ5RGF0YVRhYmxlDQogICAgICAgICAgICB2YXIgc2NyaXB0TGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2NyaXB0TGlzdC5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIGlmIChzY3JpcHRMaXN0W2ldLmF0dHJpYnV0ZXNbJ2lzRGF0YVRhYmxlUGFnZSddICE9IHVuZGVmaW5lZCAmJiBzY3JpcHRMaXN0W2ldLmF0dHJpYnV0ZXNbJ2lzRGF0YVRhYmxlUGFnZSddICE9IG51bGwgJiYgc2NyaXB0TGlzdFtpXS5hdHRyaWJ1dGVzWydpc0RhdGFUYWJsZVBhZ2UnXS5ub2RlVmFsdWUgIT0gdW5kZWZpbmVkICYmIHNjcmlwdExpc3RbaV0uYXR0cmlidXRlc1snaXNEYXRhVGFibGVQYWdlJ10ubm9kZVZhbHVlICE9IG51bGwgJiYgc2NyaXB0TGlzdFtpXS5hdHRyaWJ1dGVzWydpc0RhdGFUYWJsZVBhZ2UnXS5ub2RlVmFsdWUgPT0gJ2lzRGF0YVRhYmxlUGFnZScpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdE9ialVybCA9IHNjcmlwdExpc3RbaV0uc3JjOw0KICAgICAgICAgICAgICAgICAgICBQb3NyVXJsVHh0ID0gZ2V0UG9zdFVybEJ5RGF0YVRhYmxlKHNjcmlwdE9ialVybCk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChQb3NyVXJsVHh0ID09IHVuZGVmaW5lZCB8fCBQb3NyVXJsVHh0ID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICBhbGVydCgi5L2g6YeH55So55qE5piv6Ieq6YCJ5Zyw5Z2A5L2c5Li66K+35rGC5Zyw5Z2A77yM5L2G5piv5Y+v6IO95Zug5Li65YW85a655oCn6Zeu6aKY5peg5rOV6I635Y+W6K+35rGC5Zyw5Z2A77yM6K+35bCGanPlvJXnlKjku6PnoIHmlL7lhaXpobXpnaLmnIDliY3mlrnjgIIiKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5HZXREYXRhVGFibGVCeVdoZXJlVHh0ID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgR2V0RGF0YVRhYmxlQnlXaGVyZSA9ICIiOw0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgUGFnZUluZGV4VG9EZWxldGVTdGF0ZUlzWWVzID0gcGFyc2VJbnQoanNvbk1vZGVsLlBhZ2VJbmRleFRvRGVsZXRlU3RhdGVJc1llcyk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5QYWdlU2hvd0J1dENvdW50ICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgUGFnZVNob3dCdXRDb3VudCA9IHBhcnNlSW50KGpzb25Nb2RlbC5QYWdlU2hvd0J1dENvdW50KTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoanNvbk1vZGVsLkRlbGV0ZUJ1dEh0bWwgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBEZWxldGVCdXROYW1lID0ganNvbk1vZGVsLkRlbGV0ZUJ1dEh0bWw7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5VcGRhdGVCdXRIdG1sICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgVXBkYXRlQnV0TmFtZSA9IGpzb25Nb2RlbC5VcGRhdGVCdXRIdG1sOw0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuQ2hlY2tJc1RydWVUeHQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBDaGVja0lzVHJ1ZVR4dCA9IGpzb25Nb2RlbC5DaGVja0lzVHJ1ZVR4dDsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoanNvbk1vZGVsLkNoZWNrSXNGYWxzZVR4dCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIENoZWNrSXNGYWxzZVR4dCA9IGpzb25Nb2RlbC5DaGVja0lzRmFsc2VUeHQ7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGpzb25Nb2RlbC5DaGVja0l0ZW1UeHQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBDaGVja0l0ZW1UeHQgPSBqc29uTW9kZWwuQ2hlY2tJdGVtVHh0Ow0KICAgICAgICB9DQogICAgICAgIGlmIChqc29uTW9kZWwuRGVsZXRlT3JVcGRhdGVUaXRsZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIERlbGV0ZU9yVXBkYXRlVGl0bGUgPSBqc29uTW9kZWwuRGVsZXRlT3JVcGRhdGVUaXRsZTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoanNvbk1vZGVsLkxvZ2luRGl2Q2xhc3NOYW1lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgTG9naW5EaXZDbGFzc05hbWUgPSBqc29uTW9kZWwuTG9naW5EaXZDbGFzc05hbWU7DQogICAgICAgIH0NCiAgICAgICAgLy/liJ3lp4vljJblj4LmlbANCiAgICAgICAgVXBkYXRlQnV0Q2xpY2sgPSBudWxsOw0KICAgICAgICBEZWxldGVJdGVtU3RhdGUgPSBudWxsOw0KICAgICAgICBDaGVja0FsbENoYW5nZSA9IG51bGw7DQogICAgICAgIENoZWNrSXRlbUNoYW5nZSA9IG51bGw7DQogICAgICAgIENhbGxiYWNrID0gbnVsbDsNCiAgICAgICAgLy/liKTmlq3liJ3lp4vljJblj4LmlbANCiAgICAgICAgaWYgKF9VcGRhdGVCdXRDbGljayAhPSB1bmRlZmluZWQgJiYgX1VwZGF0ZUJ1dENsaWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgIFVwZGF0ZUJ1dENsaWNrID0gX1VwZGF0ZUJ1dENsaWNrOw0KICAgICAgICB9DQogICAgICAgIGlmIChfRGVsZXRlSXRlbVN0YXRlICE9IHVuZGVmaW5lZCAmJiBfRGVsZXRlSXRlbVN0YXRlICE9IG51bGwpIHsNCiAgICAgICAgICAgIERlbGV0ZUl0ZW1TdGF0ZSA9IF9EZWxldGVJdGVtU3RhdGU7DQogICAgICAgIH0NCiAgICAgICAgaWYgKF9DaGVja0FsbENoYW5nZSAhPSB1bmRlZmluZWQgJiYgX0NoZWNrQWxsQ2hhbmdlICE9IG51bGwpIHsNCiAgICAgICAgICAgIENoZWNrQWxsQ2hhbmdlID0gX0NoZWNrQWxsQ2hhbmdlOw0KICAgICAgICB9DQogICAgICAgIGlmIChfQ2hlY2tJdGVtQ2hhbmdlICE9IHVuZGVmaW5lZCAmJiBfQ2hlY2tJdGVtQ2hhbmdlICE9IG51bGwpIHsNCiAgICAgICAgICAgIENoZWNrSXRlbUNoYW5nZSA9IF9DaGVja0l0ZW1DaGFuZ2U7DQogICAgICAgIH0NCiAgICAgICAgaWYgKF9DYWxsYmFjayAhPSB1bmRlZmluZWQgJiYgX0NhbGxiYWNrICE9IG51bGwpIHsNCiAgICAgICAgICAgIENhbGxiYWNrID0gX0NhbGxiYWNrOw0KICAgICAgICB9DQogICAgICAgIC8vYWxlcnQoQ2hlY2tBbGxDaGFuZ2UpOw0KICAgICAgICBQb3N0UmVxdWVzdChQb3NyVXJsVHh0LCBHZXRQb3N0UGFyYW1ldGVyc1RvR2V0RGF0YSgwLCBHZXREYXRhVGFibGVCeVdoZXJlKSk7DQogICAgfQ0KfQ0KLy/ojrflj5Z1cmznmoTlj4LmlbANCmZ1bmN0aW9uIGdldFF1ZXJ5U3RyaW5nQnlEYXRhVGFibGUodXJsLCBuYW1lKSB7DQogICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoIihefCYpIiArIG5hbWUgKyAiPShbXiZdKikoJnwkKSIsICJpIik7DQogICAgaWYgKHVybC5pbmRleE9mKCc/JykgPT0gLTEpIHsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfSBlbHNlIHsNCiAgICAgICAgdXJsID0gdXJsLnN1YnN0cih1cmwuaW5kZXhPZignPycpLCB1cmwubGVuZ3RoKTsNCiAgICAgICAgdmFyIHIgPSB1cmwuc3Vic3RyKDEpLm1hdGNoKHJlZyk7DQogICAgICAgIGlmIChyICE9IG51bGwpIHJldHVybiB1bmVzY2FwZShyWzJdKTsgcmV0dXJuIG51bGw7DQogICAgfQ0KfQ0KLy/ojrflj5bor7fmsYJ1cmwNCmZ1bmN0aW9uIGdldFBvc3RVcmxCeURhdGFUYWJsZSh1cmwpIHsNCiAgICBpZiAodXJsLmluZGV4T2YoJz8nKSA9PSAtMSkgew0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICB9IGVsc2Ugew0KICAgICAgICB1cmwgPSB1cmwuc3Vic3RyKDAsIHVybC5pbmRleE9mKCc/JykpOw0KICAgICAgICByZXR1cm4gdXJsOw0KICAgIH0NCn0NCi8v5aSE55CGdHLlr7nosaENCmZ1bmN0aW9uIENodUxpVHJPYmpBcnJ0RGF0YVRhYmxlUGFnZShpZCkgew0KICAgIHZhciB0ck9iaiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5wYXJlbnROb2RlOw0KICAgIHZhciBpbmRleFFaID0gMDsNCiAgICB2YXIgaW5kZXhRWkogPSB0ck9iai5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGQiKS5sZW5ndGg7DQogICAgaWYgKENoZWNrQWxsQ2hhbmdlID09IG51bGwpIHsNCiAgICAgICAgLy/ku44w5byA5aeL5Y+WDQogICAgICAgIGluZGV4UVogPSAwOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8v5LuOMeW8gOWni+WPlg0KICAgICAgICBpbmRleFFaID0gMTsNCiAgICB9DQogICAgaWYgKChVcGRhdGVCdXRDbGljayA9PSBudWxsIHx8IFVwZGF0ZUJ1dENsaWNrID09IHVuZGVmaW5lZCkgJiYgKERlbGV0ZUl0ZW1TdGF0ZSA9PSBudWxsIHx8IERlbGV0ZUl0ZW1TdGF0ZSA9PSB1bmRlZmluZWQpKSB7DQogICAgICAgIC8v5Y+W5YC85Yiw5pyA5ZCODQogICAgfSBlbHNlIHsNCiAgICAgICAgLy/mnIDlkI7kuIDliJfkuI3lj5YNCiAgICAgICAgaW5kZXhRWkogPSBpbmRleFFaSiAtIDE7DQogICAgfQ0KICAgIHZhciBPYmpUeHQgPSBuZXcgQXJyYXkoKTsNCiAgICBmb3IgKHZhciBpID0gaW5kZXhRWjsgaSA8IGluZGV4UVpKOyBpKyspIHsNCiAgICAgICAgT2JqVHh0LnB1c2godHJPYmouZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRkIilbaV0uaW5uZXJIVE1MKTsNCiAgICB9DQogICAgcmV0dXJuIE9ialR4dDsNCn0=";
        private string helpStr = "兰少奇：2014-3-28<br>参数说明<br>首先添加引用，引用的地址为后台的处理页面例如：&lt;script  src=&quot;Handler.ashx?divid=list&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;<br>使用前创建var pagetool=new DataTableObj()对象<br>调用查询函数pagetool.SelectDataTable({属性参数的json字符},<br>"
            + "\"删除后所回调的函数（state）返回删除的状态true成功false失败\"  有此函数则显示删除按钮没有则影藏<br>"
            + ",\"修改按钮的回调函数（id,arry）返回绑定的id和数据\") 有此函数则显示修改按钮没有则影藏<br>"
            + ",\"全选多选触发事件（keyList）如果全选则返回选中的key列表\" 有此函数则显示多选按钮没有则影藏<br>"
            + ",\"每一项数据的多选按钮触发的事件(checkobj)返回点中的check标签\"<br>,\"请求服务器完毕后回调的函数（请求类型【1表示读取数据2表示删除请求操作】，状态【true成功false失败】，服务器反回的消息）\"<br>"
            + ")<br>"
            + "全局函数请使用pagetool.方法名称来调用<br>"
            + "//获取全选选中的值<br>"
            + "GetCheckAllValueList();返回选中数据的key列表<br>"
            + "//当前位置刷新（当前页数刷新）<br>"
            + "UpStateRefresh();刷新当前页<br>"
            + "属性参数json结构<br>"
            + "{\"属性\":\"值\"}<br>"
            + "以下属性有效（参数配置）：<br>"
            + "ShowDataTableDivId;//必须属性显示数据的div的ID<br>"
            + "GetDataTableUrl;//数据来源的url<br>"
            + "GetDataTableByWhereTxt//查询的条件该值可以自定义将原本的传到后台;<br>"
            + "PageShowButCount;//显示翻页按钮的个数<br>"
            + "DeleteButHtml ;//删除按钮显示的文字<br>"
            + "UpdateButHtml;//修改按钮显示的文字<br>"
            + "CheckIsTrueTxt;//当全选按钮选中时显示的文字<br>"
            + "CheckIsFalseTxt;//当全选按钮没有选中时显示的文字<br>"
            + "CheckItemTxt ;//多选按钮每一项所显示的文字<br>"
            + "DeleteOrUpdateTitle;//删除或修改的列头显示的文字，默认为“操作”<br>"
            + "LoginDivClassName;//每次请求数据时显示Lodin加载的div的样式(设置Class的属性)<br>"
            + "LoginDivHtml;//显示正在加载/处理时候的文字"
            + "DeleteShowTxt;//用户点击删除时弹出的提示文字<br>"
            + "PageIndexToolState;//是否显示复杂的分页工具【包含首页尾页和跳转到某一页】【true或false】"
            + "以下属性有效（方法配置）：<br>"
            + "UpdateButClick;//修改按钮触发（有该方法则显示修改按钮，该属性和形参的方法都设置的话以形参为主）<br>"
            + "DeleteItemState;//删除回调（有该方法则显示删除按钮，该属性和形参的方法都设置的话以形参为主）<br>"
            + "CheckAllChange;//全选时触发（有该方法则显示多选按钮，该属性和形参的方法都设置的话以形参为主）<br>"
            + "CheckItemChange;//点击多选框时触发（该属性和形参的方法都设置的话以形参为主）<br>"
            + "Callback;//请求回调（该属性和形参的方法都设置的话以形参为主）<br>";

    }
}
